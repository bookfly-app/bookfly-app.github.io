import"./Bzak7iHL.js";import{A as oe,O as st,U as Te,b3 as Et,i as Gt,aD as Ht,x as Nt,b4 as At,_ as It,N as Ut,h as jt,T as nt,o as ot,P as Tt,C as Ot,B as zt,F as Dt,p as ue,b as Me,d as v,e as o,r as l,t as V,a as i,g as _e,c as m,f as d,a6 as h,a9 as be,aa as Zt,j as e,ab as j,ac as de,a7 as Wt}from"./DhKu0NfF.js";import{d as lt,a as z,g as it,P as Jt}from"./Dpz-iGdc.js";import{r as Be,i as F,b as vt,p as ct}from"./DZzuPxtn.js";import{H as Kt,n as Oe,y as Qt,I as Xt,u as ye,j as _t,x as Yt,w as $t}from"./D8MsmRYf.js";import{s as A,o as er}from"./DGkc4AeD.js";import{e as we,i as Pe}from"./B8n4LtgD.js";import{a as xe,s as X,b as re}from"./COSmXfxt.js";import{l as tr,d as rr}from"./DGKU-49f.js";import{g as ze}from"./n-HP1uNx.js";import{S as ar,P as sr,a as nr,A as Fe,C as or}from"./D-95MmmW.js";import{B as lr}from"./CeJZSk37.js";import{B as ir,C as dt}from"./DIYIZufq.js";import{R as vr}from"./DkAW1lKB.js";function cr(u,s,r,k,n,g){let w=oe;oe&&st();var D,R,f=null;oe&&Te.nodeType===Et&&(f=Te,st());var ae=oe?Te:u,M;Gt(()=>{const p=s()||null;var L=p==="svg"?At:null;p!==D&&(M&&(p===null?Ot(M,()=>{M=null,R=null}):p===R?zt(M):Dt(M)),p&&p!==R&&(M=Nt(()=>{if(f=oe?f:L?document.createElementNS(L,p):document.createElement(p),It(f,f),k){oe&&tr(p)&&f.append(document.createComment(""));var I=oe?Ut(f):f.appendChild(jt());oe&&(I===null?nt(!1):ot(I)),k(f,I)}Tt.nodes_end=f,ae.before(f)})),D=p,D&&(R=D))},Ht),w&&(nt(!0),ot(ae))}var dr=Me('<svg><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"><path d="M4 19V6.2C4 5.0799 4 4.51984 4.21799 4.09202C4.40973 3.71569 4.71569 3.40973 5.09202 3.21799C5.51984 3 6.0799 3 7.2 3H16.8C17.9201 3 18.4802 3 18.908 3.21799C19.2843 3.40973 19.5903 3.71569 19.782 4.09202C20 4.51984 20 5.0799 20 6.2V17H6C4.89543 17 4 17.8954 4 19ZM4 19C4 20.1046 4.89543 21 6 21H20M9 7H15M9 11H15M19 17V21" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path></g></svg>');function ur(u,s){ue(s,!0);let r=Be(s,["$$slots","$$events","$$legacy"]),k=s.stroke;r={...r},r.stroke=void 0;var n=dr();xe(n,()=>({...r,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"}));var g=v(o(n),2),w=o(g);l(g),l(n),V(()=>X(w,"stroke",k)),i(u,n),_e()}var _r=Me('<svg><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"><path d="M12 7V12L14.5 10.5M21 12C21 16.9706 16.9706 21 12 21C7.02944 21 3 16.9706 3 12C3 7.02944 7.02944 3 12 3C16.9706 3 21 7.02944 21 12Z" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path></g></svg>');function gr(u,s){ue(s,!0);let r=Be(s,["$$slots","$$events","$$legacy"]),k=s.stroke;r={...r},r.stroke=void 0;var n=_r();xe(n,()=>({...r,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"}));var g=v(o(n),2),w=o(g);l(g),l(n),V(()=>X(w,"stroke",k)),i(u,n),_e()}var fr=Me('<svg><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"><path id="primary" d="M21,11H5.41l1.3-1.29A1,1,0,0,0,5.29,8.29l-3,3a1,1,0,0,0,0,1.42l3,3a1,1,0,0,0,1.42,0,1,1,0,0,0,0-1.42L5.41,13H21a1,1,0,0,0,0-2Z"></path></g></svg>');function pr(u,s){ue(s,!0);let r=Be(s,["$$slots","$$events","$$legacy"]),k=s.stroke;r={...r},r.stroke=void 0;var n=fr();xe(n,()=>({...r,fill:k,viewBox:"0 0 24 24",id:"left-arrow","data-name":"Flat Color",xmlns:"http://www.w3.org/2000/svg",class:"icon flat-color"}));var g=v(o(n),2),w=o(g);l(g),l(n),V(()=>re(w,`fill: ${k??""};`)),i(u,n),_e()}var br=Me('<svg><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"><path d="M13 12H21M13 8H21M13 16H21M6 7V17M6 17L3 14M6 17L9 14" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path></g></svg>');function mr(u,s){ue(s,!0);let r=Be(s,["$$slots","$$events","$$legacy"]),k=s.stroke;r={...r},r.stroke=void 0;var n=br();xe(n,()=>({...r,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"}));var g=v(o(n),2),w=o(g);l(g),l(n),V(()=>X(w,"stroke",k)),i(u,n),_e()}var hr=h('<div class="rating svelte-1aw03vq"><span class="name svelte-1aw03vq"> </span> <!> <span class="rating-number svelte-1aw03vq"> </span></div>'),kr=h('<div class="book-info svelte-1aw03vq"><h1 class="svelte-1aw03vq"> </h1> <h2 class="svelte-1aw03vq"> </h2></div> <!> <!>',1);function ut(u,s){ue(s,!0);var r=m(),k=d(r);cr(k,()=>s.onclick?"div":"a",!1,(n,g)=>{var w=()=>{var Z;return(Z=s.onclick)==null?void 0:Z.call(s)};xe(n,()=>({"data-rating":s.rating,id:"outer",href:`/book/${s.book.isbn??""}`,onclick:w,class:""}),void 0,void 0,"svelte-1aw03vq");var D=kr(),R=d(D),f=o(R),ae=o(f,!0);l(f);var M=v(f,2),p=o(M,!0);l(M),l(R);var L=v(R,2);{var I=Z=>{var ge=hr(),Y=o(ge),ie=o(Y);l(Y);var me=v(Y,2);ar(me,{get rating(){return s.rating},size:.6});var qe=v(me,2),he=o(qe);l(qe),l(ge),V(Ce=>{A(ie,`${s.user.displayName??""}'s rating:`),A(he,`${Ce??""} / 10`)},[()=>s.rating===10?s.rating:s.rating.toFixed(1)]),i(Z,ge)};F(L,Z=>{s.rating!==void 0&&Z(I)})}var le=v(L,2);ir(le,{style:"height: 100%; aspect-ratio: 8 / 11;",get book(){return s.book}}),V(Z=>{A(ae,s.book.title),A(p,Z)},[()=>s.book.authors.join(", ")]),i(g,D)}),i(u,r),_e()}function wr(u,s){_t({following:[...new Set([...ye().following,s.id])]})}function yr(u,s){_t({following:ye().following.filter(r=>r!==s.id)})}var xr=h('<div class="banner svelte-e1incq"></div>'),qr=(u,s)=>s.show(),Cr=h('<div class="dot svelte-e1incq"></div> <h2 class="pronouns svelte-e1incq"> </h2>',1),Sr=()=>ze("/profile/edit"),Rr=h('<button class="edit button svelte-e1incq">Edit Profile</button>'),Pr=h('<button class="unfollow button svelte-e1incq">Unfollow</button>'),Fr=h('<button class="follow button svelte-e1incq">Follow</button>'),Mr=h('<a class="svelte-e1incq"><!> <span class="truncate svelte-e1incq"> </span></a>'),Br=h('<a class="svelte-e1incq"><!> <span class="truncate svelte-e1incq"> </span></a>'),Vr=h('<span class="profile-books svelte-e1incq"><!> <!></span>'),Lr=(u,s)=>de(s,"books"),Er=h('<!> <a class="svelte-e1incq"><!> <span> </span></a>',1),Gr=h("<span> </span>"),Hr=(u,s)=>e(s).toggle(u),Nr=h('<button class="svelte-e1incq">Highest Rated</button> <button class="svelte-e1incq">Recently Finished</button>',1),Ar=h('<div class="ratings svelte-e1incq"><div class="rating-options svelte-e1incq"><span class="svelte-e1incq"><label for="show-full-reviews" class="svelte-e1incq">Show full reviews</label> <!></span> <span class="svelte-e1incq"><label for="change-rating-sort" class="svelte-e1incq"> </label> <button id="change-rating-sort" class="svelte-e1incq"><!></button></span> <!></div> <!></div>'),Ir=h('<div class="ratings svelte-e1incq"><!></div>'),Ur=h('<div class="loading svelte-e1incq"><h1 class="svelte-e1incq">Loading posts...</h1> <p class="svelte-e1incq">We promise Wallflower will be faster soon.</p></div>'),jr=h('<section class="svelte-e1incq"><!> <button class="back-arrow svelte-e1incq"><!></button> <div class="profile svelte-e1incq"><!> <div class="profile-line-1 svelte-e1incq"><span class="name svelte-e1incq"><h1 class="svelte-e1incq"> </h1> <h2 class="svelte-e1incq"> </h2> <!> <!></span> <!></div> <!> <div class="profile-line-2 svelte-e1incq"><!></div> <a class="follows svelte-e1incq"><!> <span> </span></a> <div class="views svelte-e1incq"><button class="svelte-e1incq">All</button> <button class="svelte-e1incq">Books</button> <button class="svelte-e1incq">Activity</button> <button class="svelte-e1incq">List</button> <button class="svelte-e1incq">Discussion</button></div></div> <!></section>');function Tr(u,s){ue(s,!0);let r=s.user,k=s.sidebar,n=be(Zt(new URLSearchParams(window.location.search).get("view")??"all")),g=Kt(r),w=Promise.all(r.readingList.map(a=>Oe(a))),D=Qt(r),R=Xt(r),f=j(()=>{var a;return((a=ye())==null?void 0:a.id)===r.id}),ae=r.currentBook?Oe(r.currentBook):Promise.resolve(null),M=R.then(a=>a.filter(t=>t.type==="rating").length),p=be(!1),L=be(null),I=be("best"),le=j(()=>({best:"Highest Rated",recent:"Recently Finished"})[e(I)]),Z=j(async()=>(e(I),R.then(a=>a.filter(t=>t.type==="rating").toSorted({best:(t,c)=>c.rating-t.rating,recent:(t,c)=>c.timestamp-t.timestamp}[e(I)]))));function ge(a){return()=>{de(I,a,!0),e(L).close()}}function Y(a){return function(){ze(`${window.location.origin}${window.location.pathname}?${new URLSearchParams({view:a})}`),de(n,a,!0)}}let ie=be(null);function me(a){const t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(a);return{r:parseInt(t[1],16),g:parseInt(t[2],16),b:parseInt(t[3],16)}}function qe(a,t,c){c=Math.min(Math.max(c,0),1);const y=me(a),x=me(t),b=q=>Math.round(y[q]*(1-c)+x[q]*c);return{r:b("r"),g:b("g"),b:b("b")}}er(()=>{document.addEventListener("scroll",()=>{var a;if((a=e(L))==null||a.close(),e(ie)){const c=e(ie).getBoundingClientRect().top/100,{r:y,g:x,b}=qe(lt("crust"),lt("base"),c);e(ie).style.background=`rgb(${y}, ${x}, ${b})`}},!0)});var he=jr(),Ce=o(he);z(Ce,()=>it(r.banner),null,(a,t)=>{dt(a,{get src(){return e(t)},style:"view-transition-name: profile-banner;",children:(c,y)=>{var x=xr();let b;V(q=>b=re(x,"view-transition-name: profile-banner-image;",b,q),[()=>({"background-image":`url("${e(t)}")`})]),i(c,x)},$$slots:{default:!0}})});var Se=v(Ce,2);Se.__click=[qr,k];var gt=o(Se);pr(gt,{stroke:"#FFFFFF",style:"width: 1.5rem; height: 1.5rem;"}),l(Se);var Ve=v(Se,2),De=o(Ve);z(De,()=>it(r.picture),null,(a,t)=>{{let c=j(()=>`${r.displayName} profile picture`);dt(a,{class:"profile-picture",get src(){return e(t)},get alt(){return e(c)}})}});var Le=v(De,2),Ee=o(Le),Ge=o(Ee),ft=o(Ge,!0);l(Ge);var He=v(Ge,2),pt=o(He);l(He);var Ze=v(He,2);lr(Ze,{get forUser(){return r},size:1});var bt=v(Ze,2);{var mt=a=>{var t=Cr(),c=v(d(t),2),y=o(c,!0);l(c),V(()=>A(y,r.pronouns)),i(a,t)};F(bt,a=>{r.pronouns&&r.showPronounsOnProfile&&a(mt)})}l(Ee);var ht=v(Ee,2);{var kt=a=>{var t=Rr();t.__click=[Sr],i(a,t)},wt=a=>{var t=m(),c=d(t);{var y=x=>{var b=m(),q=d(b);{var W=C=>{var E=Pr();E.__click=[yr,r],i(C,E)},ve=C=>{var E=Fr();E.__click=[wr,r],i(C,E)};F(q,C=>{ye().following.includes(r.id)?C(W):C(ve,!1)})}i(x,b)};F(c,x=>{ye()&&x(y)},!0)}i(a,t)};F(ht,a=>{e(f)?a(kt):a(wt,!1)})}l(Le);var We=v(Le,2);sr(We,{get body(){return r.bio},style:"color: var(--overlay-1); margin-left: 1rem;"});var Ne=v(We,2),yt=o(Ne);z(yt,()=>M,null,(a,t)=>{var c=Er(),y=d(c);{var x=C=>{var E=Vr(),$=o(E);z($,()=>g,null,(J,S)=>{var ee=m(),P=d(ee);{var G=H=>{var _=Mr(),T=o(_);nr(T,{stroke:"var(--overlay-1)",style:"width: 1rem; height: 1rem; flex-shrink: 0;"});var B=v(T,2),U=o(B,!0);l(B),l(_),V(()=>{X(_,"href",`/book/${e(S).isbn}`),X(_,"title",`${r.displayName}'s highest rated book is ${e(S).title}`),A(U,e(S).title)}),i(H,_)};F(P,H=>{e(S)&&H(G)})}i(J,ee)});var se=v($,2);z(se,()=>ae,null,(J,S)=>{var ee=m(),P=d(ee);{var G=H=>{var _=Br(),T=o(_);gr(T,{stroke:"var(--overlay-1)",style:"width: 1rem; height: 1rem; flex-shrink: 0;"});var B=v(T,2),U=o(B,!0);l(B),l(_),V(()=>{X(_,"href",`/book/${e(S).isbn??""}`),X(_,"title",`${r.displayName} is currently reading ${e(S).title}`),A(U,e(S).title)}),i(H,_)};F(P,H=>{e(S)&&H(G)})}i(J,ee)}),l(E),i(C,E)};F(y,C=>{e(t)>0&&C(x)})}var b=v(y,2);b.__click=[Lr,n];var q=o(b);ur(q,{stroke:"var(--overlay-1)",style:"width: 1rem; height: 1rem;"});var W=v(q,2),ve=o(W,!0);l(W),l(b),V(()=>{X(b,"href",`/profile/${r.username??""}?view=books`),X(b,"title",`${r.displayName??""} has read ${e(t)??""} book${e(t)===1?"":"s"}`),A(ve,e(t))}),i(a,c)}),l(Ne);var Re=v(Ne,2),Je=o(Re);z(Je,()=>D,null,(a,t)=>{var c=Gr(),y=o(c);l(c),V(()=>A(y,`${e(t).length??""} Followers`)),i(a,c)});var Ke=v(Je,2),xt=o(Ke);l(Ke),l(Re);var Qe=v(Re,2),Ae=o(Qe),qt=j(()=>Y("all"));Ae.__click=function(...a){var t;(t=e(qt))==null||t.apply(this,a)};let Xe;var Ie=v(Ae,2),Ct=j(()=>Y("books"));Ie.__click=function(...a){var t;(t=e(Ct))==null||t.apply(this,a)};let Ye;var Ue=v(Ie,2),St=j(()=>Y("activity"));Ue.__click=function(...a){var t;(t=e(St))==null||t.apply(this,a)};let $e;var je=v(Ue,2),Rt=j(()=>Y("list"));je.__click=function(...a){var t;(t=e(Rt))==null||t.apply(this,a)};let et;var tt=v(je,2),Pt=j(()=>Y("discussion"));tt.__click=function(...a){var t;(t=e(Pt))==null||t.apply(this,a)};let rt;l(Qe),l(Ve);var Ft=v(Ve,2);z(Ft,()=>R,a=>{var t=Ur();i(a,t)},(a,t)=>{var c=m(),y=d(c);{var x=q=>{var W=m(),ve=d(W);we(ve,17,()=>e(t).filter(C=>C.type==="general"),Pe,(C,E)=>{Fe(C,{get post(){return e(E)}})}),i(q,W)},b=q=>{var W=m(),ve=d(W);{var C=$=>{var se=Ar(),J=o(se),S=o(J);re(S,"",{},{color:"var(--overlay-1)"});var ee=v(o(S),2);vr(ee,{id:"show-full-reviews",size:.5,get value(){return e(p)},set value(N){de(p,N,!0)}}),l(S);var P=v(S,2);re(P,"",{},{color:"var(--overlay-1)"});var G=o(P),H=o(G,!0);l(G);var _=v(G,2);_.__click=[Hr,L];var T=o(_);mr(T,{stroke:"var(--overlay-1)",style:"width: 1.5rem; height: 1.5rem;"}),l(_),l(P);var B=v(P,2);vt(or(B,{children:(N,fe)=>{var O=Nr(),K=d(O),te=j(()=>ge("best"));K.__click=function(...ke){var ce;(ce=e(te))==null||ce.apply(this,ke)};var Q=v(K,2),ne=j(()=>ge("recent"));Q.__click=function(...ke){var ce;(ce=e(ne))==null||ce.apply(this,ke)},i(N,O)},$$slots:{default:!0}}),N=>de(L,N,!0),()=>e(L)),l(J),vt(J,N=>de(ie,N),()=>e(ie));var U=v(J,2);z(U,()=>e(Z),null,(N,fe)=>{var O=m(),K=d(O);we(K,17,()=>e(fe),te=>te.id,(te,Q)=>{var ne=m(),ke=d(ne);{var ce=pe=>{Fe(pe,{get post(){return e(Q)}})},Mt=pe=>{var at=m(),Bt=d(at);z(Bt,()=>Oe(e(Q).books[0]),null,(Vt,Lt)=>{ut(Vt,{get book(){return e(Lt)},get rating(){return e(Q).rating},get user(){return r},onclick:()=>ze(`/post/${e(Q).id}`)})}),i(pe,at)};F(ke,pe=>{e(p)?pe(ce):pe(Mt,!1)})}i(te,ne)}),i(N,O)}),l(se),V(()=>A(H,e(le))),i($,se)},E=$=>{var se=m(),J=d(se);{var S=P=>{var G=m(),H=d(G);we(H,17,()=>e(t).filter(_=>_.type==="update"),Pe,(_,T)=>{Fe(_,{get post(){return e(T)}})}),i(P,G)},ee=P=>{var G=m(),H=d(G);{var _=B=>{var U=Ir(),N=o(U);z(N,()=>w,null,(fe,O)=>{var K=m(),te=d(K);we(te,17,()=>e(O),Pe,(Q,ne)=>{ut(Q,{get book(){return e(ne)},get user(){return r}})}),i(fe,K)}),l(U),i(B,U)},T=B=>{var U=m(),N=d(U);{var fe=O=>{var K=m(),te=d(K);we(te,17,()=>e(t),Pe,(Q,ne)=>{Fe(Q,{get post(){return e(ne)}})}),i(O,K)};F(N,O=>{e(n)==="all"&&O(fe)},!0)}i(B,U)};F(H,B=>{e(n)==="list"?B(_):B(T,!1)},!0)}i(P,G)};F(J,P=>{e(n)==="activity"?P(S):P(ee,!1)},!0)}i($,se)};F(ve,$=>{e(n)==="books"?$(C):$(E,!1)},!0)}i(q,W)};F(y,q=>{e(n)==="discussion"?q(x):q(b,!1)})}i(a,c)}),l(he),V((a,t,c,y,x)=>{A(ft,r.displayName),A(pt,`@${r.username??""}`),X(Re,"href",`/profile/${r.username}/follows`),A(xt,`${r.following.length??""} Following`),Xe=re(Ae,"",Xe,a),Ye=re(Ie,"",Ye,t),$e=re(Ue,"",$e,c),et=re(je,"",et,y),rt=re(tt,"",rt,x)},[()=>({color:e(n)==="all"?"var(--subtext-1)":"var(--overlay-1)","border-bottom":e(n)==="all"?"3px solid var(--lavender)":"3px solid transparent"}),()=>({color:e(n)==="books"?"var(--subtext-1)":"var(--overlay-1)","border-bottom":e(n)==="books"?"3px solid var(--lavender)":"3px solid transparent"}),()=>({color:e(n)==="activity"?"var(--subtext-1)":"var(--overlay-1)","border-bottom":e(n)==="activity"?"3px solid var(--lavender)":"3px solid transparent"}),()=>({color:e(n)==="list"?"var(--subtext-1)":"var(--overlay-1)","border-bottom":e(n)==="list"?"3px solid var(--lavender)":"3px solid transparent"}),()=>({color:e(n)==="discussion"?"var(--subtext-1)":"var(--overlay-1)","border-bottom":e(n)==="discussion"?"3px solid var(--lavender)":"3px solid transparent"})]),i(u,he),_e()}rr(["click"]);var Or=h('<!> <div class="svelte-uf21oc"></div>',1);function sa(u,s){ue(s,!0);let r=ct(s,"userid",3,void 0),k=ct(s,"username",3,void 0),n=j(()=>r()?Yt(r()):$t(k())),g=be(null);Jt(u,{type:"profile",get sidebar(){return e(g)},set sidebar(w){de(g,w,!0)},children:(w,D)=>{var R=Or(),f=d(R);z(f,()=>e(n),null,(ae,M)=>{var p=m(),L=d(p);{var I=le=>{Tr(le,{get sidebar(){return e(g)},get user(){return e(M)}})};F(L,le=>{e(M)&&le(I)})}i(ae,p)}),Wt(2),i(w,R)},$$slots:{default:!0}}),_e()}export{sa as P};
