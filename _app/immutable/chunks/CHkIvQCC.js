import"./Bg9kRutz.js";import{h as le,d as et,g as Ze,b as Pt,E as Lt,e as Gt,l as Ht,F as It,J as tt,k as at,z as Ut,aF as vt,M as At,L as Nt,m as Et,p as ue,s as v,c as n,r as l,t as M,a as ce,f as g,a7 as me,y as e,a8 as z,w as ge,a6 as jt}from"./BaZyK-JQ.js";import{b as qt,a as i,n as He,c as h,t as k}from"./Dd2BwSaU.js";import{e as rt,a as J,s as E,g as st,P as Tt}from"./BBznB-Ys.js";import{r as Ie,i as F,s as j,b as ot,p as nt}from"./DBYv9uc3.js";import{p as he}from"./COAggT6D.js";import{H as zt,n as We,y as Zt,I as Wt,u as ye,j as dt,x as Dt,w as Jt}from"./C5TKFuMC.js";import{e as we,i as Le}from"./CN4MRzID.js";import{s as O,a as xe}from"./D230ZY73.js";import{p as Ot,d as Kt}from"./BuFl6vNe.js";import{o as Qt}from"./cM7fshyi.js";import{g as De}from"./EeCmvtSl.js";import{B as Xt,S as Yt,C as lt,P as $t,a as ea,A as Ge,b as ta}from"./DVR34Jb_.js";import{B as aa}from"./CViJxuWj.js";import{R as ra}from"./CCwCwABi.js";function sa(u,s,t,w,o,f){let c=le;le&&et();var m,V,b=null;le&&Ze.nodeType===1&&(b=Ze,et());var K=le?Ze:u,G;Pt(()=>{const p=s()||null;var q=p==="svg"?vt:null;p!==m&&(G&&(p===null?At(G,()=>{G=null,V=null}):p===V?Nt(G):Et(G)),p&&p!==V&&(G=Gt(()=>{b=le?b:q?document.createElementNS(q,p):document.createElement(p),qt(b,b);{le&&Ot(p)&&b.append(document.createComment(""));var H=le?Ht(b):b.appendChild(It());le&&(H===null?tt(!1):at(H)),w(b,H)}Ut.nodes_end=b,K.before(b)})),m=p,m&&(V=m))},Lt),c&&(tt(!0),at(K))}var oa=He('<svg><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"><path d="M4 19V6.2C4 5.0799 4 4.51984 4.21799 4.09202C4.40973 3.71569 4.71569 3.40973 5.09202 3.21799C5.51984 3 6.0799 3 7.2 3H16.8C17.9201 3 18.4802 3 18.908 3.21799C19.2843 3.40973 19.5903 3.71569 19.782 4.09202C20 4.51984 20 5.0799 20 6.2V17H6C4.89543 17 4 17.8954 4 19ZM4 19C4 20.1046 4.89543 21 6 21H20M9 7H15M9 11H15M19 17V21" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path></g></svg>');function na(u,s){ue(s,!0);let t=Ie(s,["$$slots","$$events","$$legacy"]),w=s.stroke;t={...t},t.stroke=void 0;var o=oa();let f;var c=v(n(o),2),m=n(c);O(m,"stroke",w),l(c),l(o),M(()=>f=xe(o,f,{...t,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},void 0,!0)),i(u,o),ce()}var la=He('<svg><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"><path d="M12 7V12L14.5 10.5M21 12C21 16.9706 16.9706 21 12 21C7.02944 21 3 16.9706 3 12C3 7.02944 7.02944 3 12 3C16.9706 3 21 7.02944 21 12Z" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path></g></svg>');function ia(u,s){ue(s,!0);let t=Ie(s,["$$slots","$$events","$$legacy"]),w=s.stroke;t={...t},t.stroke=void 0;var o=la();let f;var c=v(n(o),2),m=n(c);O(m,"stroke",w),l(c),l(o),M(()=>f=xe(o,f,{...t,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},void 0,!0)),i(u,o),ce()}var va=He('<svg><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"><path id="primary" d="M21,11H5.41l1.3-1.29A1,1,0,0,0,5.29,8.29l-3,3a1,1,0,0,0,0,1.42l3,3a1,1,0,0,0,1.42,0,1,1,0,0,0,0-1.42L5.41,13H21a1,1,0,0,0,0-2Z"></path></g></svg>');function da(u,s){ue(s,!0);let t=Ie(s,["$$slots","$$events","$$legacy"]),w=s.stroke;t={...t},t.stroke=void 0;var o=va();let f;var c=v(n(o),2),m=n(c);O(m,"style",`fill: ${w??""};`),l(c),l(o),M(()=>f=xe(o,f,{...t,fill:w,viewBox:"0 0 24 24",id:"left-arrow","data-name":"Flat Color",xmlns:"http://www.w3.org/2000/svg",class:"icon flat-color"},void 0,!0)),i(u,o),ce()}var ga=He('<svg><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"><path d="M13 12H21M13 8H21M13 16H21M6 7V17M6 17L3 14M6 17L9 14" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path></g></svg>');function ua(u,s){ue(s,!0);let t=Ie(s,["$$slots","$$events","$$legacy"]),w=s.stroke;t={...t},t.stroke=void 0;var o=ga();let f;var c=v(n(o),2),m=n(c);O(m,"stroke",w),l(c),l(o),M(()=>f=xe(o,f,{...t,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},void 0,!0)),i(u,o),ce()}var ca=k('<div class="rating svelte-1aw03vq"><span class="name svelte-1aw03vq"> </span> <!> <span class="rating-number svelte-1aw03vq"> </span></div>'),_a=k('<div class="book-info svelte-1aw03vq"><h1 class="svelte-1aw03vq"> </h1> <h2 class="svelte-1aw03vq"> </h2></div> <!> <!>',1);function it(u,s){ue(s,!0);var t=h(),w=g(t);sa(w,()=>s.onclick?"div":"a",!1,(o,f)=>{var c=()=>{var Z;return(Z=s.onclick)==null?void 0:Z.call(s)};let m;M(()=>m=xe(o,m,{"data-rating":s.rating,id:"outer",href:`/book/${s.book.isbn??""}`,onclick:c},"svelte-1aw03vq",o.namespaceURI===vt,o.nodeName.includes("-")));var V=_a(),b=g(V),K=n(b),G=n(K,!0);l(K);var p=v(K,2),q=n(p,!0);l(p),l(b);var H=v(b,2);{var ie=Z=>{var ee=ca(),te=n(ee),Ce=n(te);l(te);var Se=v(te,2);Yt(Se,{get rating(){return s.rating},size:.6});var _e=v(Se,2),Re=n(_e);l(_e),l(ee),M(fe=>{j(Ce,`${s.user.displayName??""}'s rating:`),j(Re,`${fe??""} / 10`)},[()=>s.rating===10?s.rating:s.rating.toFixed(1)]),i(Z,ee)};F(H,Z=>{s.rating!==void 0&&Z(ie)})}var Ue=v(H,2);Xt(Ue,{style:"height: 100%; aspect-ratio: 8 / 11;",get book(){return s.book}}),M(Z=>{j(G,s.book.title),j(q,Z)},[()=>s.book.authors.join(", ")]),i(f,V)}),i(u,t),ce()}function fa(u,s){dt({following:[...new Set([...ye().following,s.id])]})}function pa(u,s){dt({following:ye().following.filter(t=>t!==s.id)})}var ba=k('<div style="view-transition-name: profile-banner-image;" class="banner svelte-era8g7"></div>'),ma=(u,s)=>s.show(),ha=k('<div class="dot svelte-era8g7"></div> <h2 class="pronouns svelte-era8g7"> </h2>',1),ka=()=>De("/profile/edit"),wa=k('<button class="edit button svelte-era8g7">Edit Profile</button>'),ya=k('<button class="unfollow button svelte-era8g7">Unfollow</button>'),xa=k('<button class="follow button svelte-era8g7">Follow</button>'),Ca=k('<a class="svelte-era8g7"><!> <span class="truncate svelte-era8g7"> </span></a>'),Sa=k('<a class="svelte-era8g7"><!> <span class="truncate svelte-era8g7"> </span></a>'),Ra=k('<span class="profile-books svelte-era8g7"><!> <!></span>'),Fa=(u,s)=>ge(s,"books"),Ma=k('<!> <a class="svelte-era8g7"><!> <span> </span></a>',1),Va=k("<span> </span>"),Ba=(u,s)=>e(s).open(u),Pa=k('<button class="svelte-era8g7">Highest Rated</button> <button class="svelte-era8g7">Recently Finished</button>',1),La=k('<div class="ratings svelte-era8g7"><div class="rating-options svelte-era8g7"><span class="svelte-era8g7"><label for="show-full-reviews" class="svelte-era8g7">Show full reviews</label> <!></span> <span class="svelte-era8g7"><label for="change-rating-sort" class="svelte-era8g7"> </label> <button id="change-rating-sort" class="svelte-era8g7"><!></button></span> <!></div> <!></div>'),Ga=k('<div class="ratings svelte-era8g7"><!></div>'),Ha=k('<div class="loading svelte-era8g7"><h1 class="svelte-era8g7">Loading posts...</h1> <p class="svelte-era8g7">We promise Wallflower will be faster soon.</p></div>'),Ia=k('<section class="svelte-era8g7"><!> <button class="back-arrow svelte-era8g7"><!></button> <div class="profile svelte-era8g7"><!> <div class="profile-line-1 svelte-era8g7"><span class="name svelte-era8g7"><h1 class="svelte-era8g7"> </h1> <h2 class="svelte-era8g7"> </h2> <!> <!></span> <!></div> <!> <div class="profile-line-2 svelte-era8g7"><!></div> <a class="follows svelte-era8g7"><!> <span> </span></a> <div class="views svelte-era8g7"><button class="svelte-era8g7">All</button> <button class="svelte-era8g7">Books</button> <button class="svelte-era8g7">Activity</button> <button class="svelte-era8g7">List</button> <button class="svelte-era8g7">Discussion</button></div></div> <!></section>');function Ua(u,s){ue(s,!0);let t=s.user,w=s.sidebar,o=me(he(new URLSearchParams(window.location.search).get("view")??"all")),f=zt(t),c=Promise.all(t.readingList.map(r=>We(r))),m=Zt(t),V=Wt(t),b=z(()=>{var r;return((r=ye())==null?void 0:r.id)===t.id}),K=t.currentBook?We(t.currentBook):Promise.resolve(null),G=V.then(r=>r.filter(a=>a.type==="rating").length),p=me(!1),q=me(null),H=me("best"),ie=z(()=>({best:"Highest Rated",recent:"Recently Finished"})[e(H)]),Ue=z(async()=>(e(H),V.then(r=>r.filter(a=>a.type==="rating").toSorted({best:(a,d)=>d.rating-a.rating,recent:(a,d)=>d.timestamp-a.timestamp}[e(H)]))));function Z(r){return()=>{ge(H,he(r)),e(q).close()}}function ee(r){return function(){De(`${window.location.origin}${window.location.pathname}?${new URLSearchParams({view:r})}`),ge(o,he(r))}}let te=me(null);function Ce(r){const a=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(r);return{r:parseInt(a[1],16),g:parseInt(a[2],16),b:parseInt(a[3],16)}}function Se(r,a,d){d=Math.min(Math.max(d,0),1);const S=Ce(r),B=Ce(a),y=P=>Math.round(S[P]*(1-d)+B[P]*d);return{r:y("r"),g:y("g"),b:y("b")}}Qt(()=>{document.addEventListener("scroll",()=>{var r;if((r=e(q))==null||r.close(),e(te)){const d=e(te).getBoundingClientRect().top/100,{r:S,g:B,b:y}=Se(rt("crust"),rt("base"),d);e(te).style.background=`rgb(${S}, ${B}, ${y})`}},!0)});var _e=Ia(),Re=n(_e);J(Re,()=>st(t.banner),null,(r,a)=>{lt(r,{get src(){return e(a)},style:"view-transition-name: profile-banner;",children:(d,S)=>{var B=ba();M(()=>E(B,"background-image",`url("${e(a)}")`)),i(d,B)},$$slots:{default:!0}})});var fe=v(Re,2);fe.__click=[ma,w];var gt=n(fe);da(gt,{stroke:"#FFFFFF",style:"width: 1.5rem; height: 1.5rem;"}),l(fe);var Ae=v(fe,2),Je=n(Ae);J(Je,()=>st(t.picture),null,(r,a)=>{const d=z(()=>`${t.displayName} profile picture`);lt(r,{class:"profile-picture",get src(){return e(a)},get alt(){return e(d)}})});var Ne=v(Je,2),Ee=n(Ne),je=n(Ee),ut=n(je,!0);l(je);var qe=v(je,2),ct=n(qe);l(qe);var Oe=v(qe,2);aa(Oe,{forUser:t,size:1});var _t=v(Oe,2);{var ft=r=>{var a=ha(),d=v(g(a),2),S=n(d,!0);l(d),M(()=>j(S,t.pronouns)),i(r,a)};F(_t,r=>{t.pronouns&&r(ft)})}l(Ee);var pt=v(Ee,2);{var bt=r=>{var a=wa();a.__click=[ka],i(r,a)},mt=r=>{var a=h(),d=g(a);{var S=B=>{var y=h(),P=g(y);{var Q=x=>{var I=ya();I.__click=[pa,t],i(x,I)},ve=x=>{var I=xa();I.__click=[fa,t],i(x,I)};F(P,x=>{ye().following.includes(t.id)?x(Q):x(ve,!1)})}i(B,y)};F(d,B=>{ye()&&B(S)},!0)}i(r,a)};F(pt,r=>{e(b)?r(bt):r(mt,!1)})}l(Ne);var Ke=v(Ne,2);$t(Ke,{get body(){return t.bio},style:"color: var(--overlay-1); margin-left: 1rem;"});var Te=v(Ke,2),ht=n(Te);J(ht,()=>G,null,(r,a)=>{var d=Ma(),S=g(d);{var B=x=>{var I=Ra(),ae=n(I);J(ae,()=>f,null,(X,C)=>{var re=h(),R=g(re);{var U=A=>{var _=Ca(),W=n(_);ea(W,{stroke:"var(--overlay-1)",style:"width: 1rem; height: 1rem; flex-shrink: 0;"});var L=v(W,2),T=n(L,!0);l(L),l(_),M(()=>{O(_,"href",`/book/${e(C).isbn}`),O(_,"title",`${t.displayName}'s highest rated book is ${e(C).title}`),j(T,e(C).title)}),i(A,_)};F(R,A=>{e(C)&&A(U)})}i(X,re)});var oe=v(ae,2);J(oe,()=>K,null,(X,C)=>{var re=h(),R=g(re);{var U=A=>{var _=Sa(),W=n(_);ia(W,{stroke:"var(--overlay-1)",style:"width: 1rem; height: 1rem; flex-shrink: 0;"});var L=v(W,2),T=n(L,!0);l(L),l(_),M(()=>{O(_,"href",`/book/${e(C).isbn??""}`),O(_,"title",`${t.displayName} is currently reading ${e(C).title}`),j(T,e(C).title)}),i(A,_)};F(R,A=>{e(C)&&A(U)})}i(X,re)}),l(I),i(x,I)};F(S,x=>{e(a)>0&&x(B)})}var y=v(S,2);y.__click=[Fa,o];var P=n(y);na(P,{stroke:"var(--overlay-1)",style:"width: 1rem; height: 1rem;"});var Q=v(P,2),ve=n(Q,!0);l(Q),l(y),M(()=>{O(y,"href",`/profile/${t.username??""}?view=books`),O(y,"title",`${t.displayName??""} has read ${e(a)??""} book${(e(a)===1?"":"s")??""}`),j(ve,e(a))}),i(r,d)}),l(Te);var Fe=v(Te,2),Qe=n(Fe);J(Qe,()=>m,null,(r,a)=>{var d=Va(),S=n(d);l(d),M(()=>j(S,`${e(a).length??""} Followers`)),i(r,d)});var Xe=v(Qe,2),kt=n(Xe);l(Xe),l(Fe);var Ye=v(Fe,2),Me=n(Ye),wt=z(()=>ee("all"));Me.__click=function(...r){var a;(a=e(wt))==null||a.apply(this,r)};var Ve=v(Me,2),yt=z(()=>ee("books"));Ve.__click=function(...r){var a;(a=e(yt))==null||a.apply(this,r)};var Be=v(Ve,2),xt=z(()=>ee("activity"));Be.__click=function(...r){var a;(a=e(xt))==null||a.apply(this,r)};var Pe=v(Be,2),Ct=z(()=>ee("list"));Pe.__click=function(...r){var a;(a=e(Ct))==null||a.apply(this,r)};var ze=v(Pe,2),St=z(()=>ee("discussion"));ze.__click=function(...r){var a;(a=e(St))==null||a.apply(this,r)},l(Ye),l(Ae);var Rt=v(Ae,2);J(Rt,()=>V,r=>{var a=Ha();i(r,a)},(r,a)=>{var d=h(),S=g(d);{var B=P=>{var Q=h(),ve=g(Q);we(ve,17,()=>e(a).filter(x=>x.type==="general"),Le,(x,I)=>{Ge(x,{get post(){return e(I)}})}),i(P,Q)},y=P=>{var Q=h(),ve=g(Q);{var x=ae=>{var oe=La(),X=n(oe),C=n(X);E(C,"color","var(--overlay-1)");var re=v(n(C),2);ra(re,{id:"show-full-reviews",size:.5,get value(){return e(p)},set value(N){ge(p,he(N))}}),l(C);var R=v(C,2);E(R,"color","var(--overlay-1)");var U=n(R),A=n(U,!0);l(U);var _=v(U,2);_.__click=[Ba,q];var W=n(_);ua(W,{stroke:"var(--overlay-1)",style:"width: 1.5rem; height: 1.5rem;"}),l(_),l(R);var L=v(R,2);ot(ta(L,{children:(N,pe)=>{var D=Pa(),Y=g(D),se=z(()=>Z("best"));Y.__click=function(...ke){var de;(de=e(se))==null||de.apply(this,ke)};var $=v(Y,2),ne=z(()=>Z("recent"));$.__click=function(...ke){var de;(de=e(ne))==null||de.apply(this,ke)},i(N,D)},$$slots:{default:!0}}),N=>ge(q,he(N)),()=>e(q)),l(X),ot(X,N=>ge(te,N),()=>e(te));var T=v(X,2);J(T,()=>e(Ue),null,(N,pe)=>{var D=h(),Y=g(D);we(Y,17,()=>e(pe),se=>se.id,(se,$)=>{var ne=h(),ke=g(ne);{var de=be=>{Ge(be,{get post(){return e($)}})},Ft=be=>{var $e=h(),Mt=g($e);J(Mt,()=>We(e($).books[0]),null,(Vt,Bt)=>{it(Vt,{get book(){return e(Bt)},get rating(){return e($).rating},user:t,onclick:()=>De(`/post/${e($).id}`)})}),i(be,$e)};F(ke,be=>{e(p)?be(de):be(Ft,!1)})}i(se,ne)}),i(N,D)}),l(oe),M(()=>j(A,e(ie))),i(ae,oe)},I=ae=>{var oe=h(),X=g(oe);{var C=R=>{var U=h(),A=g(U);we(A,17,()=>e(a).filter(_=>_.type==="update"),Le,(_,W)=>{Ge(_,{get post(){return e(W)}})}),i(R,U)},re=R=>{var U=h(),A=g(U);{var _=L=>{var T=Ga(),N=n(T);J(N,()=>c,null,(pe,D)=>{var Y=h(),se=g(Y);we(se,17,()=>e(D),Le,($,ne)=>{it($,{get book(){return e(ne)},user:t})}),i(pe,Y)}),l(T),i(L,T)},W=L=>{var T=h(),N=g(T);{var pe=D=>{var Y=h(),se=g(Y);we(se,17,()=>e(a),Le,($,ne)=>{Ge($,{get post(){return e(ne)}})}),i(D,Y)};F(N,D=>{e(o)==="all"&&D(pe)},!0)}i(L,T)};F(A,L=>{e(o)==="list"?L(_):L(W,!1)},!0)}i(R,U)};F(X,R=>{e(o)==="activity"?R(C):R(re,!1)},!0)}i(ae,oe)};F(ve,ae=>{e(o)==="books"?ae(x):ae(I,!1)},!0)}i(P,Q)};F(S,P=>{e(o)==="discussion"?P(B):P(y,!1)})}i(r,d)}),l(_e),M(()=>{j(ut,t.displayName),j(ct,`@${t.username??""}`),O(Fe,"href",`/profile/${t.username}/follows`),j(kt,`${t.following.length??""} Following`),E(Me,"color",e(o)==="all"?"var(--subtext-1)":"var(--overlay-1)"),E(Me,"border-bottom",e(o)==="all"?"3px solid var(--lavender)":"3px solid transparent"),E(Ve,"color",e(o)==="books"?"var(--subtext-1)":"var(--overlay-1)"),E(Ve,"border-bottom",e(o)==="books"?"3px solid var(--lavender)":"3px solid transparent"),E(Be,"color",e(o)==="activity"?"var(--subtext-1)":"var(--overlay-1)"),E(Be,"border-bottom",e(o)==="activity"?"3px solid var(--lavender)":"3px solid transparent"),E(Pe,"color",e(o)==="list"?"var(--subtext-1)":"var(--overlay-1)"),E(Pe,"border-bottom",e(o)==="list"?"3px solid var(--lavender)":"3px solid transparent"),E(ze,"color",e(o)==="discussion"?"var(--subtext-1)":"var(--overlay-1)"),E(ze,"border-bottom",e(o)==="discussion"?"3px solid var(--lavender)":"3px solid transparent")}),i(u,_e),ce()}Kt(["click"]);var Aa=k('<!> <div class="svelte-uf21oc"></div>',1);function $a(u,s){ue(s,!0);let t=nt(s,"userid",3,void 0),w=nt(s,"username",3,void 0),o=z(()=>t()?Dt(t()):Jt(w())),f=me(null);Tt(u,{type:"profile",get sidebar(){return e(f)},set sidebar(c){ge(f,he(c))},children:(c,m)=>{var V=Aa(),b=g(V);J(b,()=>e(o),null,(K,G)=>{var p=h(),q=g(p);{var H=ie=>{Ua(ie,{get sidebar(){return e(f)},get user(){return e(G)}})};F(q,ie=>{e(G)&&ie(H)})}i(K,p)}),jt(2),i(c,V)},$$slots:{default:!0}}),ce()}export{$a as P};
