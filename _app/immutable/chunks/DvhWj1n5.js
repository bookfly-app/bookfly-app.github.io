import"./Bzak7iHL.js";import{A as ne,O as st,U as Te,b3 as Gt,i as Ht,aD as Nt,x as At,b4 as It,_ as Ut,N as jt,h as qt,T as ot,o as nt,P as Tt,C as zt,B as Dt,F as Ot,p as ce,b as Pe,d as v,e as n,r as l,t as L,a as i,g as ue,c as m,f as g,a6 as h,a9 as be,aa as Zt,j as e,ab as q,ac as ge,a7 as Wt}from"./B-4qJ0jo.js";import{d as lt,a as D,g as it,P as Jt}from"./BPZG0wnQ.js";import{r as Ve,i as B,b as vt,p as dt}from"./wXu3LSAe.js";import{H as Kt,n as ze,y as Qt,I as Xt,u as ye,j as ut,x as Yt,w as $t}from"./CSLRLUv4.js";import{s as I,o as er}from"./JskAO5LV.js";import{e as we,i as Me}from"./BYSh6dwO.js";import{a as xe,s as X,b as re}from"./C8LXp0oK.js";import{k as tr,d as rr}from"./s5iYg1w1.js";import{g as De}from"./CfU2nZNv.js";import{B as ar,S as sr,C as gt,P as or,a as nr,A as Be,b as lr}from"./CgT3d-KZ.js";import{B as ir}from"./cz4S-qMi.js";import{R as vr}from"./DpN9WtyM.js";function dr(c,s,r,k,o,_){let w=ne;ne&&st();var O,F,f=null;ne&&Te.nodeType===Gt&&(f=Te,st());var ae=ne?Te:c,P;Ht(()=>{const p=s()||null;var E=p==="svg"?It:null;p!==O&&(P&&(p===null?zt(P,()=>{P=null,F=null}):p===F?Dt(P):Ot(P)),p&&p!==F&&(P=At(()=>{if(f=ne?f:E?document.createElementNS(E,p):document.createElement(p),Ut(f,f),k){ne&&tr(p)&&f.append(document.createComment(""));var U=ne?jt(f):f.appendChild(qt());ne&&(U===null?ot(!1):nt(U)),k(f,U)}Tt.nodes_end=f,ae.before(f)})),O=p,O&&(F=O))},Nt),w&&(ot(!0),nt(ae))}var gr=Pe('<svg><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"><path d="M4 19V6.2C4 5.0799 4 4.51984 4.21799 4.09202C4.40973 3.71569 4.71569 3.40973 5.09202 3.21799C5.51984 3 6.0799 3 7.2 3H16.8C17.9201 3 18.4802 3 18.908 3.21799C19.2843 3.40973 19.5903 3.71569 19.782 4.09202C20 4.51984 20 5.0799 20 6.2V17H6C4.89543 17 4 17.8954 4 19ZM4 19C4 20.1046 4.89543 21 6 21H20M9 7H15M9 11H15M19 17V21" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path></g></svg>');function cr(c,s){ce(s,!0);let r=Ve(s,["$$slots","$$events","$$legacy"]),k=s.stroke;r={...r},r.stroke=void 0;var o=gr();xe(o,()=>({...r,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"}));var _=v(n(o),2),w=n(_);l(_),l(o),L(()=>X(w,"stroke",k)),i(c,o),ue()}var ur=Pe('<svg><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"><path d="M12 7V12L14.5 10.5M21 12C21 16.9706 16.9706 21 12 21C7.02944 21 3 16.9706 3 12C3 7.02944 7.02944 3 12 3C16.9706 3 21 7.02944 21 12Z" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path></g></svg>');function _r(c,s){ce(s,!0);let r=Ve(s,["$$slots","$$events","$$legacy"]),k=s.stroke;r={...r},r.stroke=void 0;var o=ur();xe(o,()=>({...r,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"}));var _=v(n(o),2),w=n(_);l(_),l(o),L(()=>X(w,"stroke",k)),i(c,o),ue()}var fr=Pe('<svg><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"><path id="primary" d="M21,11H5.41l1.3-1.29A1,1,0,0,0,5.29,8.29l-3,3a1,1,0,0,0,0,1.42l3,3a1,1,0,0,0,1.42,0,1,1,0,0,0,0-1.42L5.41,13H21a1,1,0,0,0,0-2Z"></path></g></svg>');function pr(c,s){ce(s,!0);let r=Ve(s,["$$slots","$$events","$$legacy"]),k=s.stroke;r={...r},r.stroke=void 0;var o=fr();xe(o,()=>({...r,fill:k,viewBox:"0 0 24 24",id:"left-arrow","data-name":"Flat Color",xmlns:"http://www.w3.org/2000/svg",class:"icon flat-color"}));var _=v(n(o),2),w=n(_);l(_),l(o),L(()=>re(w,`fill: ${k??""};`)),i(c,o),ue()}var br=Pe('<svg><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"><path d="M13 12H21M13 8H21M13 16H21M6 7V17M6 17L3 14M6 17L9 14" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path></g></svg>');function mr(c,s){ce(s,!0);let r=Ve(s,["$$slots","$$events","$$legacy"]),k=s.stroke;r={...r},r.stroke=void 0;var o=br();xe(o,()=>({...r,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"}));var _=v(n(o),2),w=n(_);l(_),l(o),L(()=>X(w,"stroke",k)),i(c,o),ue()}var hr=h('<div class="rating svelte-1aw03vq"><span class="name svelte-1aw03vq"> </span> <!> <span class="rating-number svelte-1aw03vq"> </span></div>'),kr=h('<div class="book-info svelte-1aw03vq"><h1 class="svelte-1aw03vq"> </h1> <h2 class="svelte-1aw03vq"> </h2></div> <!> <!>',1);function ct(c,s){ce(s,!0);var r=m(),k=g(r);dr(k,()=>s.onclick?"div":"a",!1,(o,_)=>{var w=()=>{var Z;return(Z=s.onclick)==null?void 0:Z.call(s)};xe(o,()=>({"data-rating":s.rating,id:"outer",href:`/book/${s.book.isbn??""}`,onclick:w,class:""}),void 0,void 0,"svelte-1aw03vq");var O=kr(),F=g(O),f=n(F),ae=n(f,!0);l(f);var P=v(f,2),p=n(P,!0);l(P),l(F);var E=v(F,2);{var U=Z=>{var _e=hr(),Y=n(_e),ie=n(Y);l(Y);var me=v(Y,2);sr(me,{get rating(){return s.rating},size:.6});var Ce=v(me,2),he=n(Ce);l(Ce),l(_e),L(Se=>{I(ie,`${s.user.displayName??""}'s rating:`),I(he,`${Se??""} / 10`)},[()=>s.rating===10?s.rating:s.rating.toFixed(1)]),i(Z,_e)};B(E,Z=>{s.rating!==void 0&&Z(U)})}var le=v(E,2);ar(le,{style:"height: 100%; aspect-ratio: 8 / 11;",get book(){return s.book}}),L(Z=>{I(ae,s.book.title),I(p,Z)},[()=>s.book.authors.join(", ")]),i(_,O)}),i(c,r),ue()}function wr(c,s){ut({following:[...new Set([...ye().following,s.id])]})}function yr(c,s){ut({following:ye().following.filter(r=>r!==s.id)})}var xr=h('<div class="banner svelte-era8g7"></div>'),Cr=(c,s)=>s.show(),Sr=h('<div class="dot svelte-era8g7"></div> <h2 class="pronouns svelte-era8g7"> </h2>',1),Rr=()=>De("/profile/edit"),Fr=h('<button class="edit button svelte-era8g7">Edit Profile</button>'),Mr=h('<button class="unfollow button svelte-era8g7">Unfollow</button>'),Br=h('<button class="follow button svelte-era8g7">Follow</button>'),Pr=h('<a class="svelte-era8g7"><!> <span class="truncate svelte-era8g7"> </span></a>'),Vr=h('<a class="svelte-era8g7"><!> <span class="truncate svelte-era8g7"> </span></a>'),Lr=h('<span class="profile-books svelte-era8g7"><!> <!></span>'),Er=(c,s)=>ge(s,"books"),Gr=h('<!> <a class="svelte-era8g7"><!> <span> </span></a>',1),Hr=h("<span> </span>"),Nr=(c,s)=>e(s).open(c),Ar=h('<button class="svelte-era8g7">Highest Rated</button> <button class="svelte-era8g7">Recently Finished</button>',1),Ir=h('<div class="ratings svelte-era8g7"><div class="rating-options svelte-era8g7"><span class="svelte-era8g7"><label for="show-full-reviews" class="svelte-era8g7">Show full reviews</label> <!></span> <span class="svelte-era8g7"><label for="change-rating-sort" class="svelte-era8g7"> </label> <button id="change-rating-sort" class="svelte-era8g7"><!></button></span> <!></div> <!></div>'),Ur=h('<div class="ratings svelte-era8g7"><!></div>'),jr=h('<div class="loading svelte-era8g7"><h1 class="svelte-era8g7">Loading posts...</h1> <p class="svelte-era8g7">We promise Wallflower will be faster soon.</p></div>'),qr=h('<section class="svelte-era8g7"><!> <button class="back-arrow svelte-era8g7"><!></button> <div class="profile svelte-era8g7"><!> <div class="profile-line-1 svelte-era8g7"><span class="name svelte-era8g7"><h1 class="svelte-era8g7"> </h1> <h2 class="svelte-era8g7"> </h2> <!> <!></span> <!></div> <!> <div class="profile-line-2 svelte-era8g7"><!></div> <a class="follows svelte-era8g7"><!> <span> </span></a> <div class="views svelte-era8g7"><button class="svelte-era8g7">All</button> <button class="svelte-era8g7">Books</button> <button class="svelte-era8g7">Activity</button> <button class="svelte-era8g7">List</button> <button class="svelte-era8g7">Discussion</button></div></div> <!></section>');function Tr(c,s){ce(s,!0);let r=s.user,k=s.sidebar,o=be(Zt(new URLSearchParams(window.location.search).get("view")??"all")),_=Kt(r),w=Promise.all(r.readingList.map(a=>ze(a))),O=Qt(r),F=Xt(r),f=q(()=>{var a;return((a=ye())==null?void 0:a.id)===r.id}),ae=r.currentBook?ze(r.currentBook):Promise.resolve(null),P=F.then(a=>a.filter(t=>t.type==="rating").length),p=be(!1),E=be(null),U=be("best"),le=q(()=>({best:"Highest Rated",recent:"Recently Finished"})[e(U)]),Z=q(async()=>(e(U),F.then(a=>a.filter(t=>t.type==="rating").toSorted({best:(t,d)=>d.rating-t.rating,recent:(t,d)=>d.timestamp-t.timestamp}[e(U)]))));function _e(a){return()=>{ge(U,a,!0),e(E).close()}}function Y(a){return function(){De(`${window.location.origin}${window.location.pathname}?${new URLSearchParams({view:a})}`),ge(o,a,!0)}}let ie=be(null);function me(a){const t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(a);return{r:parseInt(t[1],16),g:parseInt(t[2],16),b:parseInt(t[3],16)}}function Ce(a,t,d){d=Math.min(Math.max(d,0),1);const y=me(a),x=me(t),b=C=>Math.round(y[C]*(1-d)+x[C]*d);return{r:b("r"),g:b("g"),b:b("b")}}er(()=>{document.addEventListener("scroll",()=>{var a;if((a=e(E))==null||a.close(),e(ie)){const d=e(ie).getBoundingClientRect().top/100,{r:y,g:x,b}=Ce(lt("crust"),lt("base"),d);e(ie).style.background=`rgb(${y}, ${x}, ${b})`}},!0)});var he=qr(),Se=n(he);D(Se,()=>it(r.banner),null,(a,t)=>{gt(a,{get src(){return e(t)},style:"view-transition-name: profile-banner;",children:(d,y)=>{var x=xr();let b;L(C=>b=re(x,"view-transition-name: profile-banner-image;",b,C),[()=>({"background-image":`url("${e(t)}")`})]),i(d,x)},$$slots:{default:!0}})});var Re=v(Se,2);Re.__click=[Cr,k];var _t=n(Re);pr(_t,{stroke:"#FFFFFF",style:"width: 1.5rem; height: 1.5rem;"}),l(Re);var Le=v(Re,2),Oe=n(Le);D(Oe,()=>it(r.picture),null,(a,t)=>{{let d=q(()=>`${r.displayName} profile picture`);gt(a,{class:"profile-picture",get src(){return e(t)},get alt(){return e(d)}})}});var Ee=v(Oe,2),Ge=n(Ee),He=n(Ge),ft=n(He,!0);l(He);var Ne=v(He,2),pt=n(Ne);l(Ne);var Ze=v(Ne,2);ir(Ze,{get forUser(){return r},size:1});var bt=v(Ze,2);{var mt=a=>{var t=Sr(),d=v(g(t),2),y=n(d,!0);l(d),L(()=>I(y,r.pronouns)),i(a,t)};B(bt,a=>{r.pronouns&&a(mt)})}l(Ge);var ht=v(Ge,2);{var kt=a=>{var t=Fr();t.__click=[Rr],i(a,t)},wt=a=>{var t=m(),d=g(t);{var y=x=>{var b=m(),C=g(b);{var W=S=>{var G=Mr();G.__click=[yr,r],i(S,G)},ve=S=>{var G=Br();G.__click=[wr,r],i(S,G)};B(C,S=>{ye().following.includes(r.id)?S(W):S(ve,!1)})}i(x,b)};B(d,x=>{ye()&&x(y)},!0)}i(a,t)};B(ht,a=>{e(f)?a(kt):a(wt,!1)})}l(Ee);var We=v(Ee,2);or(We,{get body(){return r.bio},style:"color: var(--overlay-1); margin-left: 1rem;"});var Ae=v(We,2),yt=n(Ae);D(yt,()=>P,null,(a,t)=>{var d=Gr(),y=g(d);{var x=S=>{var G=Lr(),$=n(G);D($,()=>_,null,(J,R)=>{var ee=m(),M=g(ee);{var H=N=>{var u=Pr(),T=n(u);nr(T,{stroke:"var(--overlay-1)",style:"width: 1rem; height: 1rem; flex-shrink: 0;"});var V=v(T,2),j=n(V,!0);l(V),l(u),L(()=>{X(u,"href",`/book/${e(R).isbn}`),X(u,"title",`${r.displayName}'s highest rated book is ${e(R).title}`),I(j,e(R).title)}),i(N,u)};B(M,N=>{e(R)&&N(H)})}i(J,ee)});var se=v($,2);D(se,()=>ae,null,(J,R)=>{var ee=m(),M=g(ee);{var H=N=>{var u=Vr(),T=n(u);_r(T,{stroke:"var(--overlay-1)",style:"width: 1rem; height: 1rem; flex-shrink: 0;"});var V=v(T,2),j=n(V,!0);l(V),l(u),L(()=>{X(u,"href",`/book/${e(R).isbn??""}`),X(u,"title",`${r.displayName} is currently reading ${e(R).title}`),I(j,e(R).title)}),i(N,u)};B(M,N=>{e(R)&&N(H)})}i(J,ee)}),l(G),i(S,G)};B(y,S=>{e(t)>0&&S(x)})}var b=v(y,2);b.__click=[Er,o];var C=n(b);cr(C,{stroke:"var(--overlay-1)",style:"width: 1rem; height: 1rem;"});var W=v(C,2),ve=n(W,!0);l(W),l(b),L(()=>{X(b,"href",`/profile/${r.username??""}?view=books`),X(b,"title",`${r.displayName??""} has read ${e(t)??""} book${e(t)===1?"":"s"}`),I(ve,e(t))}),i(a,d)}),l(Ae);var Fe=v(Ae,2),Je=n(Fe);D(Je,()=>O,null,(a,t)=>{var d=Hr(),y=n(d);l(d),L(()=>I(y,`${e(t).length??""} Followers`)),i(a,d)});var Ke=v(Je,2),xt=n(Ke);l(Ke),l(Fe);var Qe=v(Fe,2),Ie=n(Qe),Ct=q(()=>Y("all"));Ie.__click=function(...a){var t;(t=e(Ct))==null||t.apply(this,a)};let Xe;var Ue=v(Ie,2),St=q(()=>Y("books"));Ue.__click=function(...a){var t;(t=e(St))==null||t.apply(this,a)};let Ye;var je=v(Ue,2),Rt=q(()=>Y("activity"));je.__click=function(...a){var t;(t=e(Rt))==null||t.apply(this,a)};let $e;var qe=v(je,2),Ft=q(()=>Y("list"));qe.__click=function(...a){var t;(t=e(Ft))==null||t.apply(this,a)};let et;var tt=v(qe,2),Mt=q(()=>Y("discussion"));tt.__click=function(...a){var t;(t=e(Mt))==null||t.apply(this,a)};let rt;l(Qe),l(Le);var Bt=v(Le,2);D(Bt,()=>F,a=>{var t=jr();i(a,t)},(a,t)=>{var d=m(),y=g(d);{var x=C=>{var W=m(),ve=g(W);we(ve,17,()=>e(t).filter(S=>S.type==="general"),Me,(S,G)=>{Be(S,{get post(){return e(G)}})}),i(C,W)},b=C=>{var W=m(),ve=g(W);{var S=$=>{var se=Ir(),J=n(se),R=n(J);re(R,"",{},{color:"var(--overlay-1)"});var ee=v(n(R),2);vr(ee,{id:"show-full-reviews",size:.5,get value(){return e(p)},set value(A){ge(p,A,!0)}}),l(R);var M=v(R,2);re(M,"",{},{color:"var(--overlay-1)"});var H=n(M),N=n(H,!0);l(H);var u=v(H,2);u.__click=[Nr,E];var T=n(u);mr(T,{stroke:"var(--overlay-1)",style:"width: 1.5rem; height: 1.5rem;"}),l(u),l(M);var V=v(M,2);vt(lr(V,{children:(A,fe)=>{var z=Ar(),K=g(z),te=q(()=>_e("best"));K.__click=function(...ke){var de;(de=e(te))==null||de.apply(this,ke)};var Q=v(K,2),oe=q(()=>_e("recent"));Q.__click=function(...ke){var de;(de=e(oe))==null||de.apply(this,ke)},i(A,z)},$$slots:{default:!0}}),A=>ge(E,A,!0),()=>e(E)),l(J),vt(J,A=>ge(ie,A),()=>e(ie));var j=v(J,2);D(j,()=>e(Z),null,(A,fe)=>{var z=m(),K=g(z);we(K,17,()=>e(fe),te=>te.id,(te,Q)=>{var oe=m(),ke=g(oe);{var de=pe=>{Be(pe,{get post(){return e(Q)}})},Pt=pe=>{var at=m(),Vt=g(at);D(Vt,()=>ze(e(Q).books[0]),null,(Lt,Et)=>{ct(Lt,{get book(){return e(Et)},get rating(){return e(Q).rating},get user(){return r},onclick:()=>De(`/post/${e(Q).id}`)})}),i(pe,at)};B(ke,pe=>{e(p)?pe(de):pe(Pt,!1)})}i(te,oe)}),i(A,z)}),l(se),L(()=>I(N,e(le))),i($,se)},G=$=>{var se=m(),J=g(se);{var R=M=>{var H=m(),N=g(H);we(N,17,()=>e(t).filter(u=>u.type==="update"),Me,(u,T)=>{Be(u,{get post(){return e(T)}})}),i(M,H)},ee=M=>{var H=m(),N=g(H);{var u=V=>{var j=Ur(),A=n(j);D(A,()=>w,null,(fe,z)=>{var K=m(),te=g(K);we(te,17,()=>e(z),Me,(Q,oe)=>{ct(Q,{get book(){return e(oe)},get user(){return r}})}),i(fe,K)}),l(j),i(V,j)},T=V=>{var j=m(),A=g(j);{var fe=z=>{var K=m(),te=g(K);we(te,17,()=>e(t),Me,(Q,oe)=>{Be(Q,{get post(){return e(oe)}})}),i(z,K)};B(A,z=>{e(o)==="all"&&z(fe)},!0)}i(V,j)};B(N,V=>{e(o)==="list"?V(u):V(T,!1)},!0)}i(M,H)};B(J,M=>{e(o)==="activity"?M(R):M(ee,!1)},!0)}i($,se)};B(ve,$=>{e(o)==="books"?$(S):$(G,!1)},!0)}i(C,W)};B(y,C=>{e(o)==="discussion"?C(x):C(b,!1)})}i(a,d)}),l(he),L((a,t,d,y,x)=>{I(ft,r.displayName),I(pt,`@${r.username??""}`),X(Fe,"href",`/profile/${r.username}/follows`),I(xt,`${r.following.length??""} Following`),Xe=re(Ie,"",Xe,a),Ye=re(Ue,"",Ye,t),$e=re(je,"",$e,d),et=re(qe,"",et,y),rt=re(tt,"",rt,x)},[()=>({color:e(o)==="all"?"var(--subtext-1)":"var(--overlay-1)","border-bottom":e(o)==="all"?"3px solid var(--lavender)":"3px solid transparent"}),()=>({color:e(o)==="books"?"var(--subtext-1)":"var(--overlay-1)","border-bottom":e(o)==="books"?"3px solid var(--lavender)":"3px solid transparent"}),()=>({color:e(o)==="activity"?"var(--subtext-1)":"var(--overlay-1)","border-bottom":e(o)==="activity"?"3px solid var(--lavender)":"3px solid transparent"}),()=>({color:e(o)==="list"?"var(--subtext-1)":"var(--overlay-1)","border-bottom":e(o)==="list"?"3px solid var(--lavender)":"3px solid transparent"}),()=>({color:e(o)==="discussion"?"var(--subtext-1)":"var(--overlay-1)","border-bottom":e(o)==="discussion"?"3px solid var(--lavender)":"3px solid transparent"})]),i(c,he),ue()}rr(["click"]);var zr=h('<!> <div class="svelte-uf21oc"></div>',1);function aa(c,s){ce(s,!0);let r=dt(s,"userid",3,void 0),k=dt(s,"username",3,void 0),o=q(()=>r()?Yt(r()):$t(k())),_=be(null);Jt(c,{type:"profile",get sidebar(){return e(_)},set sidebar(w){ge(_,w,!0)},children:(w,O)=>{var F=zr(),f=g(F);D(f,()=>e(o),null,(ae,P)=>{var p=m(),E=g(p);{var U=le=>{Tr(le,{get sidebar(){return e(_)},get user(){return e(P)}})};B(E,le=>{e(P)&&le(U)})}i(ae,p)}),Wt(2),i(w,F)},$$slots:{default:!0}}),ue()}export{aa as P};
