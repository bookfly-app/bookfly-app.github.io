import"./Bg9kRutz.js";import{h as le,z as et,y as Ze,q as Bt,E as Pt,v as Gt,N as Lt,O as At,C as tt,B as at,k as Ht,aF as vt,F as It,D as Nt,x as Ut,p as ue,s as v,c as o,r as l,t as F,a as _e,f as c,a5 as be,j as e,a6 as z,g as ce,a4 as Et}from"./DpL-zfgl.js";import{b as jt,a as i,n as Le,c as k,t as b}from"./DitkTsWA.js";import{e as rt,a as Z,s as U,g as st,P as Tt}from"./4xhgHt_c.js";import{r as Ae,i as R,s as E,b as nt,p as ot}from"./BdjlEak8.js";import{p as me}from"./D9Rqb9Mt.js";import{B as zt,m as De,t as Zt,C as Dt,A as Ot,u as ye,f as dt,r as Wt,q as Jt}from"./CNXCd5Iu.js";import{e as we,i as Pe}from"./BzvN9xHF.js";import{h as Kt}from"./C57OuvGF.js";import{s as J,a as xe}from"./Bh5g2vjz.js";import{p as Qt,d as Xt}from"./DHveY-33.js";import{o as Yt}from"./BKa3V-0I.js";import{g as Oe}from"./Q4kBbe0I.js";import{B as $t,S as ea,C as lt,a as ta,b as aa,A as Ge,c as ra}from"./C_zcqE6L.js";import{R as sa}from"./BTBztaWc.js";function na(u,s,a,y,n,f){let _=le;le&&et();var m,M,p=null;le&&Ze.nodeType===1&&(p=Ze,et());var K=le?Ze:u,G;Bt(()=>{const h=s()||null;var j=h==="svg"?vt:null;h!==m&&(G&&(h===null?It(G,()=>{G=null,M=null}):h===M?Nt(G):Ut(G)),h&&h!==M&&(G=Gt(()=>{p=le?p:j?document.createElementNS(j,h):document.createElement(h),jt(p,p);{le&&Qt(h)&&p.append(document.createComment(""));var L=le?Lt(p):p.appendChild(At());le&&(L===null?tt(!1):at(L)),y(p,L)}Ht.nodes_end=p,K.before(p)})),m=h,m&&(M=m))},Pt),_&&(tt(!0),at(K))}var oa=Le('<svg><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"><path d="M4 19V6.2C4 5.0799 4 4.51984 4.21799 4.09202C4.40973 3.71569 4.71569 3.40973 5.09202 3.21799C5.51984 3 6.0799 3 7.2 3H16.8C17.9201 3 18.4802 3 18.908 3.21799C19.2843 3.40973 19.5903 3.71569 19.782 4.09202C20 4.51984 20 5.0799 20 6.2V17H6C4.89543 17 4 17.8954 4 19ZM4 19C4 20.1046 4.89543 21 6 21H20M9 7H15M9 11H15M19 17V21" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path></g></svg>');function la(u,s){ue(s,!0);let a=Ae(s,["$$slots","$$events","$$legacy"]),y=s.stroke;a={...a},a.stroke=void 0;var n=oa();let f;var _=v(o(n),2),m=o(_);J(m,"stroke",y),l(_),l(n),F(()=>f=xe(n,f,{...a,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},void 0,!0)),i(u,n),_e()}var ia=Le('<svg><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"><path d="M12 7V12L14.5 10.5M21 12C21 16.9706 16.9706 21 12 21C7.02944 21 3 16.9706 3 12C3 7.02944 7.02944 3 12 3C16.9706 3 21 7.02944 21 12Z" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path></g></svg>');function va(u,s){ue(s,!0);let a=Ae(s,["$$slots","$$events","$$legacy"]),y=s.stroke;a={...a},a.stroke=void 0;var n=ia();let f;var _=v(o(n),2),m=o(_);J(m,"stroke",y),l(_),l(n),F(()=>f=xe(n,f,{...a,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},void 0,!0)),i(u,n),_e()}var da=Le('<svg><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"><path id="primary" d="M21,11H5.41l1.3-1.29A1,1,0,0,0,5.29,8.29l-3,3a1,1,0,0,0,0,1.42l3,3a1,1,0,0,0,1.42,0,1,1,0,0,0,0-1.42L5.41,13H21a1,1,0,0,0,0-2Z"></path></g></svg>');function ca(u,s){ue(s,!0);let a=Ae(s,["$$slots","$$events","$$legacy"]),y=s.stroke;a={...a},a.stroke=void 0;var n=da();let f;var _=v(o(n),2),m=o(_);J(m,"style",`fill: ${y??""};`),l(_),l(n),F(()=>f=xe(n,f,{...a,fill:y,viewBox:"0 0 24 24",id:"left-arrow","data-name":"Flat Color",xmlns:"http://www.w3.org/2000/svg",class:"icon flat-color"},void 0,!0)),i(u,n),_e()}var ua=Le('<svg><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"><path d="M13 12H21M13 8H21M13 16H21M6 7V17M6 17L3 14M6 17L9 14" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path></g></svg>');function _a(u,s){ue(s,!0);let a=Ae(s,["$$slots","$$events","$$legacy"]),y=s.stroke;a={...a},a.stroke=void 0;var n=ua();let f;var _=v(o(n),2),m=o(_);J(m,"stroke",y),l(_),l(n),F(()=>f=xe(n,f,{...a,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},void 0,!0)),i(u,n),_e()}var ga=b('<div class="rating svelte-1aw03vq"><span class="name svelte-1aw03vq"> </span> <!> <span class="rating-number svelte-1aw03vq"> </span></div>'),fa=b('<div class="book-info svelte-1aw03vq"><h1 class="svelte-1aw03vq"> </h1> <h2 class="svelte-1aw03vq"> </h2></div> <!> <!>',1);function it(u,s){ue(s,!0);var a=k(),y=c(a);na(y,()=>s.onclick?"div":"a",!1,(n,f)=>{var _=()=>{var D;return(D=s.onclick)==null?void 0:D.call(s)};let m;F(()=>m=xe(n,m,{"data-rating":s.rating,id:"outer",href:`/book/${s.book.isbn??""}`,onclick:_},"svelte-1aw03vq",n.namespaceURI===vt,n.nodeName.includes("-")));var M=fa(),p=c(M),K=o(p),G=o(K,!0);l(K);var h=v(K,2),j=o(h,!0);l(h),l(p);var L=v(p,2);{var ie=D=>{var ee=ga(),te=o(ee),qe=o(te);l(te);var Ce=v(te,2);ea(Ce,{get rating(){return s.rating},size:.6});var ge=v(Ce,2),Se=o(ge);l(ge),l(ee),F(fe=>{E(qe,`${s.user.displayName??""}'s rating:`),E(Se,`${fe??""} / 10`)},[()=>s.rating===10?s.rating:s.rating.toFixed(1)]),i(D,ee)};R(L,D=>{s.rating!==void 0&&D(ie)})}var He=v(L,2);$t(He,{style:"height: 100%; aspect-ratio: 8 / 11;",get book(){return s.book}}),F(D=>{E(G,s.book.title),E(j,D)},[()=>s.book.authors.join(", ")]),i(f,M)}),i(u,a),_e()}function ha(u,s){dt({following:[...new Set([...ye().following,s.id])]})}function pa(u,s){dt({following:ye().following.filter(a=>a!==s.id)})}var ba=b('<div class="banner svelte-2qnh35"></div>'),ma=(u,s)=>s.show(),ka=b('<div class="dot svelte-2qnh35"></div> <h2 class="pronouns svelte-2qnh35"> </h2>',1),wa=()=>Oe("/profile/edit"),ya=b('<button class="edit button svelte-2qnh35">Edit Profile</button>'),xa=b('<button class="unfollow button svelte-2qnh35">Unfollow</button>'),qa=b('<button class="follow button svelte-2qnh35">Follow</button>'),Ca=b('<p class="bio svelte-2qnh35"><!></p>'),Sa=b('<a class="svelte-2qnh35"><!> <span class="truncate svelte-2qnh35"> </span></a>'),Ra=b('<a class="svelte-2qnh35"><!> <span class="truncate svelte-2qnh35"> </span></a>'),Fa=b('<span class="profile-books svelte-2qnh35"><!> <!></span>'),Ma=(u,s)=>ce(s,"books"),Va=b('<!> <a class="svelte-2qnh35"><!> <span> </span></a>',1),Ba=b("<span> </span>"),Pa=(u,s)=>e(s).open(u),Ga=b('<button class="svelte-2qnh35">Highest Rated</button> <button class="svelte-2qnh35">Recently Finished</button>',1),La=b('<div class="ratings svelte-2qnh35"><div class="rating-options svelte-2qnh35"><span class="svelte-2qnh35"><label for="show-full-reviews" class="svelte-2qnh35">Show full reviews</label> <!></span> <span class="svelte-2qnh35"><label for="change-rating-sort" class="svelte-2qnh35"> </label> <button id="change-rating-sort" class="svelte-2qnh35"><!></button></span> <!></div> <!></div>'),Aa=b('<div class="ratings svelte-2qnh35"><!></div>'),Ha=b('<div class="loading svelte-2qnh35"><h1 class="svelte-2qnh35">Loading posts...</h1> <p class="svelte-2qnh35">We promise Wallflower will be faster soon.</p></div>'),Ia=b('<section class="svelte-2qnh35"><!> <button class="back-arrow svelte-2qnh35"><!></button> <div class="profile svelte-2qnh35"><!> <div class="profile-line-1 svelte-2qnh35"><span class="name svelte-2qnh35"><h1 class="svelte-2qnh35"> </h1> <h2 class="svelte-2qnh35"> </h2> <!> <!></span> <!></div> <!> <div class="profile-line-2 svelte-2qnh35"><!></div> <a class="follows svelte-2qnh35"><!> <span> </span></a> <div class="views svelte-2qnh35"><button class="svelte-2qnh35">All</button> <button class="svelte-2qnh35">Books</button> <button class="svelte-2qnh35">Activity</button> <button class="svelte-2qnh35">List</button> <button class="svelte-2qnh35">Discussion</button></div></div> <!></section>');function Na(u,s){ue(s,!0);let a=s.user,y=s.sidebar,n=be(me(new URLSearchParams(window.location.search).get("view")??"all")),f=zt(a),_=Promise.all(a.readingList.map(r=>De(r))),m=Zt(a),M=Dt(a),p=z(()=>{var r;return((r=ye())==null?void 0:r.id)===a.id}),K=a.currentBook?De(a.currentBook):Promise.resolve(null),G=M.then(r=>r.filter(t=>t.type==="rating").length),h=be(!1),j=be(null),L=be("best"),ie=z(()=>({best:"Highest Rated",recent:"Recently Finished"})[e(L)]),He=z(async()=>(e(L),M.then(r=>r.filter(t=>t.type==="rating").toSorted({best:(t,d)=>d.rating-t.rating,recent:(t,d)=>d.timestamp-t.timestamp}[e(L)]))));function D(r){return()=>{ce(L,me(r)),e(j).close()}}function ee(r){return function(){Oe(`${window.location.origin}${window.location.pathname}?${new URLSearchParams({view:r})}`),ce(n,me(r))}}let te=be(null);function qe(r){const t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(r);return{r:parseInt(t[1],16),g:parseInt(t[2],16),b:parseInt(t[3],16)}}function Ce(r,t,d){d=Math.min(Math.max(d,0),1);const w=qe(r),V=qe(t),x=B=>Math.round(w[B]*(1-d)+V[B]*d);return{r:x("r"),g:x("g"),b:x("b")}}Yt(()=>{document.addEventListener("scroll",()=>{var r;if((r=e(j))==null||r.close(),e(te)){const d=e(te).getBoundingClientRect().top/100,{r:w,g:V,b:x}=Ce(rt("crust"),rt("base"),d);e(te).style.background=`rgb(${w}, ${V}, ${x})`}},!0)});var ge=Ia(),Se=o(ge);Z(Se,()=>st(a.banner),null,(r,t)=>{lt(r,{get src(){return e(t)},children:(d,w)=>{var V=ba();F(()=>U(V,"background-image",`url("${e(t)}")`)),i(d,V)},$$slots:{default:!0}})});var fe=v(Se,2);fe.__click=[ma,y];var ct=o(fe);ca(ct,{stroke:"#FFFFFF",style:"width: 1.5rem; height: 1.5rem;"}),l(fe);var Ie=v(fe,2),We=o(Ie);Z(We,()=>st(a.picture),null,(r,t)=>{const d=z(()=>`${a.displayName} profile picture`);lt(r,{class:"profile-picture",get src(){return e(t)},get alt(){return e(d)}})});var Ne=v(We,2),Ue=o(Ne),Ee=o(Ue),ut=o(Ee,!0);l(Ee);var je=v(Ee,2),_t=o(je);l(je);var Je=v(je,2);ta(Je,{forUser:a,size:1});var gt=v(Je,2);{var ft=r=>{var t=ka(),d=v(c(t),2),w=o(d,!0);l(d),F(()=>E(w,a.pronouns)),i(r,t)};R(gt,r=>{a.pronouns&&r(ft)})}l(Ue);var ht=v(Ue,2);{var pt=r=>{var t=ya();t.__click=[wa],i(r,t)},bt=r=>{var t=k(),d=c(t);{var w=V=>{var x=k(),B=c(x);{var Q=q=>{var A=xa();A.__click=[pa,a],i(q,A)},ve=q=>{var A=qa();A.__click=[ha,a],i(q,A)};R(B,q=>{ye().following.includes(a.id)?q(Q):q(ve,!1)})}i(V,x)};R(d,V=>{ye()&&V(w)},!0)}i(r,t)};R(ht,r=>{e(p)?r(pt):r(bt,!1)})}l(Ne);var Ke=v(Ne,2);Z(Ke,()=>Ot(a.bio),null,(r,t)=>{var d=Ca(),w=o(d);Kt(w,()=>e(t),!1,!1),l(d),i(r,d)});var Te=v(Ke,2),mt=o(Te);Z(mt,()=>G,null,(r,t)=>{var d=Va(),w=c(d);{var V=q=>{var A=Fa(),ae=o(A);Z(ae,()=>f,null,(X,C)=>{var re=k(),S=c(re);{var H=I=>{var g=Sa(),O=o(g);aa(O,{stroke:"var(--overlay-1)",style:"width: 1rem; height: 1rem; flex-shrink: 0;"});var P=v(O,2),T=o(P,!0);l(P),l(g),F(()=>{J(g,"href",`/book/${e(C).isbn}`),J(g,"title",`${a.displayName}'s highest rated book is ${e(C).title}`),E(T,e(C).title)}),i(I,g)};R(S,I=>{e(C)&&I(H)})}i(X,re)});var ne=v(ae,2);Z(ne,()=>K,null,(X,C)=>{var re=k(),S=c(re);{var H=I=>{var g=Ra(),O=o(g);va(O,{stroke:"var(--overlay-1)",style:"width: 1rem; height: 1rem; flex-shrink: 0;"});var P=v(O,2),T=o(P,!0);l(P),l(g),F(()=>{J(g,"href",`/book/${e(C).isbn??""}`),J(g,"title",`${a.displayName} is currently reading ${e(C).title}`),E(T,e(C).title)}),i(I,g)};R(S,I=>{e(C)&&I(H)})}i(X,re)}),l(A),i(q,A)};R(w,q=>{e(t)>0&&q(V)})}var x=v(w,2);x.__click=[Ma,n];var B=o(x);la(B,{stroke:"var(--overlay-1)",style:"width: 1rem; height: 1rem;"});var Q=v(B,2),ve=o(Q,!0);l(Q),l(x),F(()=>{J(x,"href",`/profile/${a.username??""}?view=books`),J(x,"title",`${a.displayName??""} has read ${e(t)??""} book${(e(t)===1?"":"s")??""}`),E(ve,e(t))}),i(r,d)}),l(Te);var Re=v(Te,2),Qe=o(Re);Z(Qe,()=>m,null,(r,t)=>{var d=Ba(),w=o(d);l(d),F(()=>E(w,`${e(t).length??""} Followers`)),i(r,d)});var Xe=v(Qe,2),kt=o(Xe);l(Xe),l(Re);var Ye=v(Re,2),Fe=o(Ye),wt=z(()=>ee("all"));Fe.__click=function(...r){var t;(t=e(wt))==null||t.apply(this,r)};var Me=v(Fe,2),yt=z(()=>ee("books"));Me.__click=function(...r){var t;(t=e(yt))==null||t.apply(this,r)};var Ve=v(Me,2),xt=z(()=>ee("activity"));Ve.__click=function(...r){var t;(t=e(xt))==null||t.apply(this,r)};var Be=v(Ve,2),qt=z(()=>ee("list"));Be.__click=function(...r){var t;(t=e(qt))==null||t.apply(this,r)};var ze=v(Be,2),Ct=z(()=>ee("discussion"));ze.__click=function(...r){var t;(t=e(Ct))==null||t.apply(this,r)},l(Ye),l(Ie);var St=v(Ie,2);Z(St,()=>M,r=>{var t=Ha();i(r,t)},(r,t)=>{var d=k(),w=c(d);{var V=B=>{var Q=k(),ve=c(Q);we(ve,17,()=>e(t).filter(q=>q.type==="general"),Pe,(q,A)=>{Ge(q,{get post(){return e(A)}})}),i(B,Q)},x=B=>{var Q=k(),ve=c(Q);{var q=ae=>{var ne=La(),X=o(ne),C=o(X);U(C,"color","var(--overlay-1)");var re=v(o(C),2);sa(re,{id:"show-full-reviews",size:.5,get value(){return e(h)},set value(N){ce(h,me(N))}}),l(C);var S=v(C,2);U(S,"color","var(--overlay-1)");var H=o(S),I=o(H,!0);l(H);var g=v(H,2);g.__click=[Pa,j];var O=o(g);_a(O,{stroke:"var(--overlay-1)",style:"width: 1.5rem; height: 1.5rem;"}),l(g),l(S);var P=v(S,2);nt(ra(P,{children:(N,he)=>{var W=Ga(),Y=c(W),se=z(()=>D("best"));Y.__click=function(...ke){var de;(de=e(se))==null||de.apply(this,ke)};var $=v(Y,2),oe=z(()=>D("recent"));$.__click=function(...ke){var de;(de=e(oe))==null||de.apply(this,ke)},i(N,W)},$$slots:{default:!0}}),N=>ce(j,me(N)),()=>e(j)),l(X),nt(X,N=>ce(te,N),()=>e(te));var T=v(X,2);Z(T,()=>e(He),null,(N,he)=>{var W=k(),Y=c(W);we(Y,17,()=>e(he),se=>se.id,(se,$)=>{var oe=k(),ke=c(oe);{var de=pe=>{Ge(pe,{get post(){return e($)}})},Rt=pe=>{var $e=k(),Ft=c($e);Z(Ft,()=>De(e($).books[0]),null,(Mt,Vt)=>{it(Mt,{get book(){return e(Vt)},get rating(){return e($).rating},user:a,onclick:()=>Oe(`/post/${e($).id}`)})}),i(pe,$e)};R(ke,pe=>{e(h)?pe(de):pe(Rt,!1)})}i(se,oe)}),i(N,W)}),l(ne),F(()=>E(I,e(ie))),i(ae,ne)},A=ae=>{var ne=k(),X=c(ne);{var C=S=>{var H=k(),I=c(H);we(I,17,()=>e(t).filter(g=>g.type==="update"),Pe,(g,O)=>{Ge(g,{get post(){return e(O)}})}),i(S,H)},re=S=>{var H=k(),I=c(H);{var g=P=>{var T=Aa(),N=o(T);Z(N,()=>_,null,(he,W)=>{var Y=k(),se=c(Y);we(se,17,()=>e(W),Pe,($,oe)=>{it($,{get book(){return e(oe)},user:a})}),i(he,Y)}),l(T),i(P,T)},O=P=>{var T=k(),N=c(T);{var he=W=>{var Y=k(),se=c(Y);we(se,17,()=>e(t),Pe,($,oe)=>{Ge($,{get post(){return e(oe)}})}),i(W,Y)};R(N,W=>{e(n)==="all"&&W(he)},!0)}i(P,T)};R(I,P=>{e(n)==="list"?P(g):P(O,!1)},!0)}i(S,H)};R(X,S=>{e(n)==="activity"?S(C):S(re,!1)},!0)}i(ae,ne)};R(ve,ae=>{e(n)==="books"?ae(q):ae(A,!1)},!0)}i(B,Q)};R(w,B=>{e(n)==="discussion"?B(V):B(x,!1)})}i(r,d)}),l(ge),F(()=>{E(ut,a.displayName),E(_t,`@${a.username??""}`),J(Re,"href",`/profile/${a.username}/follows`),E(kt,`${a.following.length??""} Following`),U(Fe,"color",e(n)==="all"?"var(--subtext-1)":"var(--overlay-1)"),U(Fe,"border-bottom",e(n)==="all"?"3px solid var(--lavender)":"3px solid transparent"),U(Me,"color",e(n)==="books"?"var(--subtext-1)":"var(--overlay-1)"),U(Me,"border-bottom",e(n)==="books"?"3px solid var(--lavender)":"3px solid transparent"),U(Ve,"color",e(n)==="activity"?"var(--subtext-1)":"var(--overlay-1)"),U(Ve,"border-bottom",e(n)==="activity"?"3px solid var(--lavender)":"3px solid transparent"),U(Be,"color",e(n)==="list"?"var(--subtext-1)":"var(--overlay-1)"),U(Be,"border-bottom",e(n)==="list"?"3px solid var(--lavender)":"3px solid transparent"),U(ze,"color",e(n)==="discussion"?"var(--subtext-1)":"var(--overlay-1)"),U(ze,"border-bottom",e(n)==="discussion"?"3px solid var(--lavender)":"3px solid transparent")}),i(u,ge),_e()}Xt(["click"]);var Ua=b('<!> <div class="svelte-uf21oc"></div>',1);function tr(u,s){ue(s,!0);let a=ot(s,"userid",3,void 0),y=ot(s,"username",3,void 0),n=z(()=>a()?Wt(a()):Jt(y())),f=be(null);Tt(u,{type:"profile",get sidebar(){return e(f)},set sidebar(_){ce(f,me(_))},children:(_,m)=>{var M=Ua(),p=c(M);Z(p,()=>e(n),null,(K,G)=>{var h=k(),j=c(h);{var L=ie=>{Na(ie,{get sidebar(){return e(f)},get user(){return e(G)}})};R(j,ie=>{e(G)&&ie(L)})}i(K,h)}),Et(2),i(_,M)},$$slots:{default:!0}}),_e()}export{tr as P};
