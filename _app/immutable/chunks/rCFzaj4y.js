import"./Bg9kRutz.js";import{h as le,B as et,y as Ze,q as Pt,E as Gt,v as Ht,T as It,A as Lt,D as tt,z as at,k as At,aF as vt,G as Ut,F as Nt,x as jt,p as ce,s as v,c as n,r as l,t as M,a as ue,f as g,a5 as me,j as e,a6 as z,g as ge,a4 as Et}from"./BSx8zodA.js";import{d as qt,a as i,n as Ie,c as h,t as k}from"./DM033ULQ.js";import{e as rt,a as O,s as j,g as st,P as Tt}from"./eQlv7zvj.js";import{r as Le,i as F,s as E,b as ot,p as nt}from"./3C7nCtCU.js";import{p as he}from"./CvnQNCwn.js";import{H as zt,n as De,y as Zt,I as Dt,u as ye,j as dt,x as Wt,w as Ot}from"./BYr-VyDe.js";import{e as we,i as Ge}from"./DG1UTaEd.js";import{s as J,a as xe}from"./Bj9SeIEW.js";import{p as Jt,d as Kt}from"./KeSscphj.js";import{o as Qt}from"./D_Fr1n_U.js";import{g as We}from"./BJTN91hz.js";import{B as Xt,S as Yt,C as lt,a as $t,P as ea,b as ta,A as He,c as aa}from"./CCX0wbow.js";import{R as ra}from"./CoFH6ZVT.js";function sa(c,s,t,w,o,f){let u=le;le&&et();var m,V,b=null;le&&Ze.nodeType===1&&(b=Ze,et());var K=le?Ze:c,H;Pt(()=>{const p=s()||null;var q=p==="svg"?vt:null;p!==m&&(H&&(p===null?Ut(H,()=>{H=null,V=null}):p===V?Nt(H):jt(H)),p&&p!==V&&(H=Ht(()=>{b=le?b:q?document.createElementNS(q,p):document.createElement(p),qt(b,b);{le&&Jt(p)&&b.append(document.createComment(""));var I=le?It(b):b.appendChild(Lt());le&&(I===null?tt(!1):at(I)),w(b,I)}At.nodes_end=b,K.before(b)})),m=p,m&&(V=m))},Gt),u&&(tt(!0),at(K))}var oa=Ie('<svg><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"><path d="M4 19V6.2C4 5.0799 4 4.51984 4.21799 4.09202C4.40973 3.71569 4.71569 3.40973 5.09202 3.21799C5.51984 3 6.0799 3 7.2 3H16.8C17.9201 3 18.4802 3 18.908 3.21799C19.2843 3.40973 19.5903 3.71569 19.782 4.09202C20 4.51984 20 5.0799 20 6.2V17H6C4.89543 17 4 17.8954 4 19ZM4 19C4 20.1046 4.89543 21 6 21H20M9 7H15M9 11H15M19 17V21" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path></g></svg>');function na(c,s){ce(s,!0);let t=Le(s,["$$slots","$$events","$$legacy"]),w=s.stroke;t={...t},t.stroke=void 0;var o=oa();let f;var u=v(n(o),2),m=n(u);J(m,"stroke",w),l(u),l(o),M(()=>f=xe(o,f,{...t,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},void 0,!0)),i(c,o),ue()}var la=Ie('<svg><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"><path d="M12 7V12L14.5 10.5M21 12C21 16.9706 16.9706 21 12 21C7.02944 21 3 16.9706 3 12C3 7.02944 7.02944 3 12 3C16.9706 3 21 7.02944 21 12Z" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path></g></svg>');function ia(c,s){ce(s,!0);let t=Le(s,["$$slots","$$events","$$legacy"]),w=s.stroke;t={...t},t.stroke=void 0;var o=la();let f;var u=v(n(o),2),m=n(u);J(m,"stroke",w),l(u),l(o),M(()=>f=xe(o,f,{...t,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},void 0,!0)),i(c,o),ue()}var va=Ie('<svg><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"><path id="primary" d="M21,11H5.41l1.3-1.29A1,1,0,0,0,5.29,8.29l-3,3a1,1,0,0,0,0,1.42l3,3a1,1,0,0,0,1.42,0,1,1,0,0,0,0-1.42L5.41,13H21a1,1,0,0,0,0-2Z"></path></g></svg>');function da(c,s){ce(s,!0);let t=Le(s,["$$slots","$$events","$$legacy"]),w=s.stroke;t={...t},t.stroke=void 0;var o=va();let f;var u=v(n(o),2),m=n(u);J(m,"style",`fill: ${w??""};`),l(u),l(o),M(()=>f=xe(o,f,{...t,fill:w,viewBox:"0 0 24 24",id:"left-arrow","data-name":"Flat Color",xmlns:"http://www.w3.org/2000/svg",class:"icon flat-color"},void 0,!0)),i(c,o),ue()}var ga=Ie('<svg><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"><path d="M13 12H21M13 8H21M13 16H21M6 7V17M6 17L3 14M6 17L9 14" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path></g></svg>');function ca(c,s){ce(s,!0);let t=Le(s,["$$slots","$$events","$$legacy"]),w=s.stroke;t={...t},t.stroke=void 0;var o=ga();let f;var u=v(n(o),2),m=n(u);J(m,"stroke",w),l(u),l(o),M(()=>f=xe(o,f,{...t,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},void 0,!0)),i(c,o),ue()}var ua=k('<div class="rating svelte-1aw03vq"><span class="name svelte-1aw03vq"> </span> <!> <span class="rating-number svelte-1aw03vq"> </span></div>'),_a=k('<div class="book-info svelte-1aw03vq"><h1 class="svelte-1aw03vq"> </h1> <h2 class="svelte-1aw03vq"> </h2></div> <!> <!>',1);function it(c,s){ce(s,!0);var t=h(),w=g(t);sa(w,()=>s.onclick?"div":"a",!1,(o,f)=>{var u=()=>{var Z;return(Z=s.onclick)==null?void 0:Z.call(s)};let m;M(()=>m=xe(o,m,{"data-rating":s.rating,id:"outer",href:`/book/${s.book.isbn??""}`,onclick:u},"svelte-1aw03vq",o.namespaceURI===vt,o.nodeName.includes("-")));var V=_a(),b=g(V),K=n(b),H=n(K,!0);l(K);var p=v(K,2),q=n(p,!0);l(p),l(b);var I=v(b,2);{var ie=Z=>{var ee=ua(),te=n(ee),Ce=n(te);l(te);var Se=v(te,2);Yt(Se,{get rating(){return s.rating},size:.6});var _e=v(Se,2),Re=n(_e);l(_e),l(ee),M(fe=>{E(Ce,`${s.user.displayName??""}'s rating:`),E(Re,`${fe??""} / 10`)},[()=>s.rating===10?s.rating:s.rating.toFixed(1)]),i(Z,ee)};F(I,Z=>{s.rating!==void 0&&Z(ie)})}var Ae=v(I,2);Xt(Ae,{style:"height: 100%; aspect-ratio: 8 / 11;",get book(){return s.book}}),M(Z=>{E(H,s.book.title),E(q,Z)},[()=>s.book.authors.join(", ")]),i(f,V)}),i(c,t),ue()}function fa(c,s){dt({following:[...new Set([...ye().following,s.id])]})}function pa(c,s){dt({following:ye().following.filter(t=>t!==s.id)})}var ba=k('<div style="view-transition-name: profile-banner-image;" class="banner svelte-era8g7"></div>'),ma=(c,s)=>s.show(),ha=k('<div class="dot svelte-era8g7"></div> <h2 class="pronouns svelte-era8g7"> </h2>',1),ka=()=>We("/profile/edit"),wa=k('<button class="edit button svelte-era8g7">Edit Profile</button>'),ya=k('<button class="unfollow button svelte-era8g7">Unfollow</button>'),xa=k('<button class="follow button svelte-era8g7">Follow</button>'),Ca=k('<a class="svelte-era8g7"><!> <span class="truncate svelte-era8g7"> </span></a>'),Sa=k('<a class="svelte-era8g7"><!> <span class="truncate svelte-era8g7"> </span></a>'),Ra=k('<span class="profile-books svelte-era8g7"><!> <!></span>'),Fa=(c,s)=>ge(s,"books"),Ma=k('<!> <a class="svelte-era8g7"><!> <span> </span></a>',1),Va=k("<span> </span>"),Ba=(c,s)=>e(s).open(c),Pa=k('<button class="svelte-era8g7">Highest Rated</button> <button class="svelte-era8g7">Recently Finished</button>',1),Ga=k('<div class="ratings svelte-era8g7"><div class="rating-options svelte-era8g7"><span class="svelte-era8g7"><label for="show-full-reviews" class="svelte-era8g7">Show full reviews</label> <!></span> <span class="svelte-era8g7"><label for="change-rating-sort" class="svelte-era8g7"> </label> <button id="change-rating-sort" class="svelte-era8g7"><!></button></span> <!></div> <!></div>'),Ha=k('<div class="ratings svelte-era8g7"><!></div>'),Ia=k('<div class="loading svelte-era8g7"><h1 class="svelte-era8g7">Loading posts...</h1> <p class="svelte-era8g7">We promise Wallflower will be faster soon.</p></div>'),La=k('<section class="svelte-era8g7"><!> <button class="back-arrow svelte-era8g7"><!></button> <div class="profile svelte-era8g7"><!> <div class="profile-line-1 svelte-era8g7"><span class="name svelte-era8g7"><h1 class="svelte-era8g7"> </h1> <h2 class="svelte-era8g7"> </h2> <!> <!></span> <!></div> <!> <div class="profile-line-2 svelte-era8g7"><!></div> <a class="follows svelte-era8g7"><!> <span> </span></a> <div class="views svelte-era8g7"><button class="svelte-era8g7">All</button> <button class="svelte-era8g7">Books</button> <button class="svelte-era8g7">Activity</button> <button class="svelte-era8g7">List</button> <button class="svelte-era8g7">Discussion</button></div></div> <!></section>');function Aa(c,s){ce(s,!0);let t=s.user,w=s.sidebar,o=me(he(new URLSearchParams(window.location.search).get("view")??"all")),f=zt(t),u=Promise.all(t.readingList.map(r=>De(r))),m=Zt(t),V=Dt(t),b=z(()=>{var r;return((r=ye())==null?void 0:r.id)===t.id}),K=t.currentBook?De(t.currentBook):Promise.resolve(null),H=V.then(r=>r.filter(a=>a.type==="rating").length),p=me(!1),q=me(null),I=me("best"),ie=z(()=>({best:"Highest Rated",recent:"Recently Finished"})[e(I)]),Ae=z(async()=>(e(I),V.then(r=>r.filter(a=>a.type==="rating").toSorted({best:(a,d)=>d.rating-a.rating,recent:(a,d)=>d.timestamp-a.timestamp}[e(I)]))));function Z(r){return()=>{ge(I,he(r)),e(q).close()}}function ee(r){return function(){We(`${window.location.origin}${window.location.pathname}?${new URLSearchParams({view:r})}`),ge(o,he(r))}}let te=me(null);function Ce(r){const a=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(r);return{r:parseInt(a[1],16),g:parseInt(a[2],16),b:parseInt(a[3],16)}}function Se(r,a,d){d=Math.min(Math.max(d,0),1);const S=Ce(r),B=Ce(a),y=P=>Math.round(S[P]*(1-d)+B[P]*d);return{r:y("r"),g:y("g"),b:y("b")}}Qt(()=>{document.addEventListener("scroll",()=>{var r;if((r=e(q))==null||r.close(),e(te)){const d=e(te).getBoundingClientRect().top/100,{r:S,g:B,b:y}=Se(rt("crust"),rt("base"),d);e(te).style.background=`rgb(${S}, ${B}, ${y})`}},!0)});var _e=La(),Re=n(_e);O(Re,()=>st(t.banner),null,(r,a)=>{lt(r,{get src(){return e(a)},style:"view-transition-name: profile-banner;",children:(d,S)=>{var B=ba();M(()=>j(B,"background-image",`url("${e(a)}")`)),i(d,B)},$$slots:{default:!0}})});var fe=v(Re,2);fe.__click=[ma,w];var gt=n(fe);da(gt,{stroke:"#FFFFFF",style:"width: 1.5rem; height: 1.5rem;"}),l(fe);var Ue=v(fe,2),Oe=n(Ue);O(Oe,()=>st(t.picture),null,(r,a)=>{const d=z(()=>`${t.displayName} profile picture`);lt(r,{class:"profile-picture",get src(){return e(a)},get alt(){return e(d)}})});var Ne=v(Oe,2),je=n(Ne),Ee=n(je),ct=n(Ee,!0);l(Ee);var qe=v(Ee,2),ut=n(qe);l(qe);var Je=v(qe,2);$t(Je,{forUser:t,size:1});var _t=v(Je,2);{var ft=r=>{var a=ha(),d=v(g(a),2),S=n(d,!0);l(d),M(()=>E(S,t.pronouns)),i(r,a)};F(_t,r=>{t.pronouns&&r(ft)})}l(je);var pt=v(je,2);{var bt=r=>{var a=wa();a.__click=[ka],i(r,a)},mt=r=>{var a=h(),d=g(a);{var S=B=>{var y=h(),P=g(y);{var Q=x=>{var L=ya();L.__click=[pa,t],i(x,L)},ve=x=>{var L=xa();L.__click=[fa,t],i(x,L)};F(P,x=>{ye().following.includes(t.id)?x(Q):x(ve,!1)})}i(B,y)};F(d,B=>{ye()&&B(S)},!0)}i(r,a)};F(pt,r=>{e(b)?r(bt):r(mt,!1)})}l(Ne);var Ke=v(Ne,2);ea(Ke,{get body(){return t.bio},style:"color: var(--overlay-1); margin-left: 1rem;"});var Te=v(Ke,2),ht=n(Te);O(ht,()=>H,null,(r,a)=>{var d=Ma(),S=g(d);{var B=x=>{var L=Ra(),ae=n(L);O(ae,()=>f,null,(X,C)=>{var re=h(),R=g(re);{var A=U=>{var _=Ca(),D=n(_);ta(D,{stroke:"var(--overlay-1)",style:"width: 1rem; height: 1rem; flex-shrink: 0;"});var G=v(D,2),T=n(G,!0);l(G),l(_),M(()=>{J(_,"href",`/book/${e(C).isbn}`),J(_,"title",`${t.displayName}'s highest rated book is ${e(C).title}`),E(T,e(C).title)}),i(U,_)};F(R,U=>{e(C)&&U(A)})}i(X,re)});var oe=v(ae,2);O(oe,()=>K,null,(X,C)=>{var re=h(),R=g(re);{var A=U=>{var _=Sa(),D=n(_);ia(D,{stroke:"var(--overlay-1)",style:"width: 1rem; height: 1rem; flex-shrink: 0;"});var G=v(D,2),T=n(G,!0);l(G),l(_),M(()=>{J(_,"href",`/book/${e(C).isbn??""}`),J(_,"title",`${t.displayName} is currently reading ${e(C).title}`),E(T,e(C).title)}),i(U,_)};F(R,U=>{e(C)&&U(A)})}i(X,re)}),l(L),i(x,L)};F(S,x=>{e(a)>0&&x(B)})}var y=v(S,2);y.__click=[Fa,o];var P=n(y);na(P,{stroke:"var(--overlay-1)",style:"width: 1rem; height: 1rem;"});var Q=v(P,2),ve=n(Q,!0);l(Q),l(y),M(()=>{J(y,"href",`/profile/${t.username??""}?view=books`),J(y,"title",`${t.displayName??""} has read ${e(a)??""} book${(e(a)===1?"":"s")??""}`),E(ve,e(a))}),i(r,d)}),l(Te);var Fe=v(Te,2),Qe=n(Fe);O(Qe,()=>m,null,(r,a)=>{var d=Va(),S=n(d);l(d),M(()=>E(S,`${e(a).length??""} Followers`)),i(r,d)});var Xe=v(Qe,2),kt=n(Xe);l(Xe),l(Fe);var Ye=v(Fe,2),Me=n(Ye),wt=z(()=>ee("all"));Me.__click=function(...r){var a;(a=e(wt))==null||a.apply(this,r)};var Ve=v(Me,2),yt=z(()=>ee("books"));Ve.__click=function(...r){var a;(a=e(yt))==null||a.apply(this,r)};var Be=v(Ve,2),xt=z(()=>ee("activity"));Be.__click=function(...r){var a;(a=e(xt))==null||a.apply(this,r)};var Pe=v(Be,2),Ct=z(()=>ee("list"));Pe.__click=function(...r){var a;(a=e(Ct))==null||a.apply(this,r)};var ze=v(Pe,2),St=z(()=>ee("discussion"));ze.__click=function(...r){var a;(a=e(St))==null||a.apply(this,r)},l(Ye),l(Ue);var Rt=v(Ue,2);O(Rt,()=>V,r=>{var a=Ia();i(r,a)},(r,a)=>{var d=h(),S=g(d);{var B=P=>{var Q=h(),ve=g(Q);we(ve,17,()=>e(a).filter(x=>x.type==="general"),Ge,(x,L)=>{He(x,{get post(){return e(L)}})}),i(P,Q)},y=P=>{var Q=h(),ve=g(Q);{var x=ae=>{var oe=Ga(),X=n(oe),C=n(X);j(C,"color","var(--overlay-1)");var re=v(n(C),2);ra(re,{id:"show-full-reviews",size:.5,get value(){return e(p)},set value(N){ge(p,he(N))}}),l(C);var R=v(C,2);j(R,"color","var(--overlay-1)");var A=n(R),U=n(A,!0);l(A);var _=v(A,2);_.__click=[Ba,q];var D=n(_);ca(D,{stroke:"var(--overlay-1)",style:"width: 1.5rem; height: 1.5rem;"}),l(_),l(R);var G=v(R,2);ot(aa(G,{children:(N,pe)=>{var W=Pa(),Y=g(W),se=z(()=>Z("best"));Y.__click=function(...ke){var de;(de=e(se))==null||de.apply(this,ke)};var $=v(Y,2),ne=z(()=>Z("recent"));$.__click=function(...ke){var de;(de=e(ne))==null||de.apply(this,ke)},i(N,W)},$$slots:{default:!0}}),N=>ge(q,he(N)),()=>e(q)),l(X),ot(X,N=>ge(te,N),()=>e(te));var T=v(X,2);O(T,()=>e(Ae),null,(N,pe)=>{var W=h(),Y=g(W);we(Y,17,()=>e(pe),se=>se.id,(se,$)=>{var ne=h(),ke=g(ne);{var de=be=>{He(be,{get post(){return e($)}})},Ft=be=>{var $e=h(),Mt=g($e);O(Mt,()=>De(e($).books[0]),null,(Vt,Bt)=>{it(Vt,{get book(){return e(Bt)},get rating(){return e($).rating},user:t,onclick:()=>We(`/post/${e($).id}`)})}),i(be,$e)};F(ke,be=>{e(p)?be(de):be(Ft,!1)})}i(se,ne)}),i(N,W)}),l(oe),M(()=>E(U,e(ie))),i(ae,oe)},L=ae=>{var oe=h(),X=g(oe);{var C=R=>{var A=h(),U=g(A);we(U,17,()=>e(a).filter(_=>_.type==="update"),Ge,(_,D)=>{He(_,{get post(){return e(D)}})}),i(R,A)},re=R=>{var A=h(),U=g(A);{var _=G=>{var T=Ha(),N=n(T);O(N,()=>u,null,(pe,W)=>{var Y=h(),se=g(Y);we(se,17,()=>e(W),Ge,($,ne)=>{it($,{get book(){return e(ne)},user:t})}),i(pe,Y)}),l(T),i(G,T)},D=G=>{var T=h(),N=g(T);{var pe=W=>{var Y=h(),se=g(Y);we(se,17,()=>e(a),Ge,($,ne)=>{He($,{get post(){return e(ne)}})}),i(W,Y)};F(N,W=>{e(o)==="all"&&W(pe)},!0)}i(G,T)};F(U,G=>{e(o)==="list"?G(_):G(D,!1)},!0)}i(R,A)};F(X,R=>{e(o)==="activity"?R(C):R(re,!1)},!0)}i(ae,oe)};F(ve,ae=>{e(o)==="books"?ae(x):ae(L,!1)},!0)}i(P,Q)};F(S,P=>{e(o)==="discussion"?P(B):P(y,!1)})}i(r,d)}),l(_e),M(()=>{E(ct,t.displayName),E(ut,`@${t.username??""}`),J(Fe,"href",`/profile/${t.username}/follows`),E(kt,`${t.following.length??""} Following`),j(Me,"color",e(o)==="all"?"var(--subtext-1)":"var(--overlay-1)"),j(Me,"border-bottom",e(o)==="all"?"3px solid var(--lavender)":"3px solid transparent"),j(Ve,"color",e(o)==="books"?"var(--subtext-1)":"var(--overlay-1)"),j(Ve,"border-bottom",e(o)==="books"?"3px solid var(--lavender)":"3px solid transparent"),j(Be,"color",e(o)==="activity"?"var(--subtext-1)":"var(--overlay-1)"),j(Be,"border-bottom",e(o)==="activity"?"3px solid var(--lavender)":"3px solid transparent"),j(Pe,"color",e(o)==="list"?"var(--subtext-1)":"var(--overlay-1)"),j(Pe,"border-bottom",e(o)==="list"?"3px solid var(--lavender)":"3px solid transparent"),j(ze,"color",e(o)==="discussion"?"var(--subtext-1)":"var(--overlay-1)"),j(ze,"border-bottom",e(o)==="discussion"?"3px solid var(--lavender)":"3px solid transparent")}),i(c,_e),ue()}Kt(["click"]);var Ua=k('<!> <div class="svelte-uf21oc"></div>',1);function Ya(c,s){ce(s,!0);let t=nt(s,"userid",3,void 0),w=nt(s,"username",3,void 0),o=z(()=>t()?Wt(t()):Ot(w())),f=me(null);Tt(c,{type:"profile",get sidebar(){return e(f)},set sidebar(u){ge(f,he(u))},children:(u,m)=>{var V=Ua(),b=g(V);O(b,()=>e(o),null,(K,H)=>{var p=h(),q=g(p);{var I=ie=>{Aa(ie,{get sidebar(){return e(f)},get user(){return e(H)}})};F(q,ie=>{e(H)&&ie(I)})}i(K,p)}),Et(2),i(u,V)},$$slots:{default:!0}}),ue()}export{Ya as P};
