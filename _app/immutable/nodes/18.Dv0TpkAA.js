import"../chunks/Bg9kRutz.js";import{s as o,c as i,r as t,t as I,p as fe,g as c,a as he,j as e,a5 as j,f as Z,a6 as le,P as Pe,aB as Ce}from"../chunks/DpL-zfgl.js";import{r as me,p as Ee,b as Re,s as G,i as S}from"../chunks/BdjlEak8.js";import{s as ce,P as Se,a as pe}from"../chunks/4xhgHt_c.js";import{e as _e,i as ke}from"../chunks/BzvN9xHF.js";import{E as Te,h as Le}from"../chunks/C57OuvGF.js";import{a as n,n as Oe,t as _,c as ye}from"../chunks/DitkTsWA.js";import{a as ge,s as ae,r as be}from"../chunks/Bh5g2vjz.js";import{d as xe,r as Ae}from"../chunks/DHveY-33.js";import{b as de}from"../chunks/r0Q9cRdY.js";import{p as te}from"../chunks/D9Rqb9Mt.js";import{g as Ve}from"../chunks/Q4kBbe0I.js";import{z as Ge,A as Ie,w as Me}from"../chunks/CNXCd5Iu.js";import{o as Ne}from"../chunks/BKa3V-0I.js";import{T as ze}from"../chunks/92EA93Rl.js";import{H as He}from"../chunks/DlO143qY.js";const qe=({params:h})=>h,Et=Object.freeze(Object.defineProperty({__proto__:null,load:qe},Symbol.toStringTag,{value:"Module"}));var Ue=Oe('<svg><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"><path d="M10 7L15 12L10 17" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path></g></svg>');function $e(h,v){let P=me(v,["$$slots","$$events","$$legacy","stroke"]);var m=Ue();let s;var M=o(i(m),2),y=i(M);t(M),t(m),I(()=>{s=ge(m,s,{...P,width:"256px",height:"256px",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},void 0,!0),ae(y,"stroke",v.stroke)}),n(h,m)}var De=(h,v)=>c(v,!e(v)),Fe=(h,v,P,m)=>{v(e(P)),c(m,!1)},Je=_('<button class="option svelte-73ogbh"> </button>'),Ke=_('<div><button class="value svelte-73ogbh"> <!></button> <div class="options svelte-73ogbh"></div></div>');function Qe(h,v){fe(v,!0);let P=Ee(v,"value",15),m=me(v,["$$slots","$$events","$$legacy","options","value"]),s=j(!1),M;Ne(()=>{document.addEventListener("click",q=>{q.composedPath().includes(M)||c(s,!1)})});var y=Ke();let T;var N=i(y);N.__click=[De,s];var k=i(N),re=o(k);$e(re,{stroke:"var(--subtext-1)",style:"width: 1rem; height: 1rem;"}),t(N);var H=o(N,2);_e(H,21,()=>v.options,ke,(q,K)=>{var Q=Je();Q.__click=[Fe,P,K,s];var oe=i(Q,!0);t(Q),I(()=>G(oe,e(K))),n(q,Q)}),t(H),t(y),Re(y,q=>M=q,()=>M),I(()=>{T=ge(y,T,{...m,class:"select"},"svelte-73ogbh"),G(k,`${P()??""} `),ce(H,"display",e(s)?"flex":"none")}),n(h,y),he()}xe(["click"]);function We(h,v){h.key==="Enter"&&v()}var Xe=_('<span class="error svelte-iyyvkb"> </span>'),Ye=_('<div class="book search-book svelte-iyyvkb"><img class="svelte-iyyvkb"> <div class="info svelte-iyyvkb"><span class="title svelte-iyyvkb"> </span> <span class="authors svelte-iyyvkb"> </span></div></div>'),Ze=_('<div class="book search-book svelte-iyyvkb"><img alt="Book cover" src="" class="svelte-iyyvkb"> <div class="info svelte-iyyvkb"><span class="title svelte-iyyvkb">Loading Title...</span> <span class="authors svelte-iyyvkb">Loading authors...</span></div></div>'),et=_('<h2 class="svelte-iyyvkb"> </h2> <div class="book-search svelte-iyyvkb"><input id="search" type="text" class="svelte-iyyvkb"> <!></div> <div class="search-results svelte-iyyvkb"></div>',1),tt=_('<div class="book svelte-iyyvkb"><img class="svelte-iyyvkb"> <div class="info svelte-iyyvkb"><span class="title svelte-iyyvkb"> </span> <span class="authors svelte-iyyvkb"> </span></div> <button class="close svelte-iyyvkb"><!></button></div>'),at=_('<div class="books"></div>'),rt=_('<span class="error svelte-iyyvkb"> </span>'),st=_('<!> <h2 class="body-name svelte-iyyvkb">Rating</h2> <div class="stars svelte-iyyvkb"><input id="rating" class="svelte-iyyvkb"> <!></div>',1),ot=_('<h2 class="body-name svelte-iyyvkb">Update Type</h2> <!> <!>',1),it=(h,v)=>c(v,!e(v)),vt=_("<button><!></button>"),nt=_('<div class="preview svelte-iyyvkb"><!></div>'),lt=_('<textarea id="body" class="svelte-iyyvkb"></textarea>'),dt=_("<!> <!>",1),ct=_('<div class="new-post-page svelte-iyyvkb"><!> <!> <!> <div class="body-header svelte-iyyvkb"><h2 class="body-name preview-body svelte-iyyvkb"></h2> <!></div> <!> <!> <button class="post-button svelte-iyyvkb">Post</button></div>');function Rt(h,v){fe(v,!0);const P=(u,g)=>{let L=Pe(()=>Ce(g==null?void 0:g(),"Add a book"));var w=et(),C=Z(w),$=i(C,!0);t(C);var E=o(C,2),B=i(E);be(B),B.__keyup=[We,q];var D=o(B,2);{var F=b=>{var R=Xe(),z=i(R,!0);t(R),I(()=>G(z,e(W))),n(b,R)};S(D,b=>{e(W)&&b(F)})}t(E);var X=o(E,2);_e(X,21,()=>e(re),ke,(b,R)=>{var z=ye(),J=Z(z);pe(J,()=>e(R),O=>{var A=Ze();n(O,A)},(O,A)=>{var Y=Ye(),a=le(()=>we(e(A)));Y.__click=function(...ee){var se;(se=e(a))==null||se.apply(this,ee)};var r=i(Y),d=o(r,2),f=i(d),V=i(f,!0);t(f);var p=o(f,2),l=i(p,!0);t(p),t(d),t(Y),I(ee=>{ae(r,"alt",`${e(A).title??""} cover`),ae(r,"src",e(A).cover),G(V,e(A).title),G(l,ee)},[()=>e(A).authors.join(",")]),n(O,Y)}),n(b,z)}),t(X),I(()=>{G($,e(L)),ce(B,"outline",e(W)?"2px solid var(--red)":"none")}),de(B,()=>e(H),b=>c(H,b)),n(u,w)},m=u=>{var g=at();_e(g,21,()=>e(k),L=>L.isbn,(L,w)=>{var C=tt(),$=i(C),E=o($,2),B=i(E),D=i(B,!0);t(B);var F=o(B,2),X=i(F,!0);t(F),t(E);var b=o(E,2),R=le(()=>Be(e(w)));b.__click=function(...J){var O;(O=e(R))==null||O.apply(this,J)};var z=i(b);ze(z,{stroke:"var(--red)",style:"width: 1.25rem; height: 1.25rem;"}),t(b),t(C),I(J=>{ae($,"alt",`${e(w).title??""} cover`),ae($,"src",e(w).cover),G(D,e(w).title),G(X,J)},[()=>e(w).authors.join(",")]),n(L,C)}),t(g),n(u,g)};let{type:s}=v.data,M={general:"Post Body",rating:"Review (Optional)",update:"Comments (Optional)",reply:null}[s],y=j(""),T=j(null),N=j("start"),k=j(te([])),re=j(te([])),H=j("");async function q(){c(re,te(await Me(e(H))))}let K=j("");function Q(){s==="general"&&e(y).trim().length===0?c(K,"Body cannot be empty"):c(K,"")}function oe(){if(s==="rating"&&ue(),(s==="rating"||s==="update")&&ie(),s==="general"&&Q(),e(U)||e(W)||e(K))return;let u={type:s,body:e(y),books:e(k).map(g=>g.isbn)};e(T)!==null&&(u=Object.assign(u,{rating:Number(e(T))})),s==="update"&&(u=Object.assign(u,{updateType:e(N)})),Ge(u),Ve("/profile")}function we(u){return function(){e(k).push(u),ie()}}function Be(u){return function(){c(k,te(e(k).filter(g=>g.isbn!==u.isbn))),ie()}}let U=j(""),W=j("");function ue(){if(s==="rating"){if(e(T)===null){c(U,"Add a rating value.");return}if(!/^\d(\.\d)?$/.test(e(T))){c(U,"Value must be between 0 and 10, to at most one decimal place.");return}}c(U,"")}function ie(){s==="rating"&&e(k).length===0?c(W,"Choose a book to rate."):c(W,"")}let ve=j(!1);Se(h,{children:(u,g)=>{var L=ct(),w=i(L);He(w,{title:`New ${s??""} Post`});var C=o(w,2);{var $=a=>{var r=st(),d=Z(r);{var f=x=>{P(x,()=>"Choose a book")},V=x=>{m(x)};S(d,x=>{e(k).length===0?x(f):x(V,!1)})}var p=o(d,4),l=i(p);be(l),l.__input=ue;var ee=o(l,2);{var se=x=>{var ne=rt(),je=i(ne,!0);t(ne),I(()=>G(je,e(U))),n(x,ne)};S(ee,x=>{e(U)&&x(se)})}t(p),I(()=>ce(l,"outline",e(U)?"2px solid #f38ba8":"none")),de(l,()=>e(T),x=>c(T,x)),n(a,r)};S(C,a=>{s==="rating"&&a($)})}var E=o(C,2);{var B=a=>{var r=ot(),d=o(Z(r),2);Qe(d,{options:["start","finish","abandon"],style:"margin-bottom: 1rem;",get value(){return e(N)},set value(l){c(N,te(l))}});var f=o(d,2);{var V=l=>{P(l,()=>"Choose a book")},p=l=>{m(l)};S(f,l=>{e(k).length===0?l(V):l(p,!1)})}n(a,r)};S(E,a=>{s==="update"&&a(B)})}var D=o(E,2),F=i(D);F.textContent=M;var X=o(F,2);{var b=a=>{var r=vt();r.__click=[it,ve];var d=i(r);const f=le(()=>e(ve)?"var(--lavender)":"var(--overlay-1)");Te(d,{get stroke(){return e(f)},style:"width: 1rem; height: 1rem;"}),t(r),n(a,r)};S(X,a=>{e(y)&&a(b)})}t(D);var R=o(D,2);{var z=a=>{var r=ye(),d=Z(r);pe(d,()=>Ie(e(y)),null,(f,V)=>{var p=nt(),l=i(p);Le(l,()=>e(V),!1,!1),t(p),n(f,p)}),n(a,r)},J=a=>{var r=lt();Ae(r),de(r,()=>e(y),d=>c(y,d)),n(a,r)};S(R,a=>{e(ve)?a(z):a(J,!1)})}var O=o(R,2);{var A=a=>{var r=dt(),d=Z(r);{var f=p=>{m(p)};S(d,p=>{e(k).length!==0&&p(f)})}var V=o(d,2);P(V,()=>"Add a book"),n(a,r)};S(O,a=>{s!=="rating"&&s!=="update"&&a(A)})}var Y=o(O,2);Y.__click=oe,t(L),n(u,L)},$$slots:{default:!0}}),he()}xe(["keyup","click","input"]);export{Rt as component,Et as universal};
