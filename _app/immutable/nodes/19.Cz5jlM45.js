import"../chunks/Bg9kRutz.js";import{p as ke,a5 as w,a as ge,s as r,j as e,g as _,c as i,f as F,r as s,t as G,a6 as se,V as xe,ac as we}from"../chunks/BSx8zodA.js";import{i as B,s as I}from"../chunks/3C7nCtCU.js";import{P as Be,a as ne,s as le}from"../chunks/eQlv7zvj.js";import{e as de,i as je}from"../chunks/DG1UTaEd.js";import{E as Te,h as Pe}from"../chunks/B-ZSOx7_.js";import{a as n,t as y,c as ce}from"../chunks/DM033ULQ.js";import{r as _e,s as W}from"../chunks/Bj9SeIEW.js";import{d as Ee,r as Oe}from"../chunks/KeSscphj.js";import{b as oe}from"../chunks/BBMkgbst.js";import{p as K}from"../chunks/CvnQNCwn.js";import{g as Se}from"../chunks/BJTN91hz.js";import{r as Ce,t as Re,v as Ae}from"../chunks/BYr-VyDe.js";import{S as Le}from"../chunks/CT8wTdms.js";import{T as Ne}from"../chunks/D2AJjpUl.js";import{H as He}from"../chunks/Dxq0jSea.js";const Ie=({params:V})=>V,ba=Object.freeze(Object.defineProperty({__proto__:null,load:Ie},Symbol.toStringTag,{value:"Module"}));function Ve(V,C){V.key==="Enter"&&C()}var qe=y('<span class="error svelte-iyyvkb"> </span>'),ze=y('<div class="book search-book svelte-iyyvkb"><img class="svelte-iyyvkb"> <div class="info svelte-iyyvkb"><span class="title svelte-iyyvkb"> </span> <span class="authors svelte-iyyvkb"> </span></div></div>'),Me=y('<div class="book search-book svelte-iyyvkb"><img alt="Book cover" src="" class="svelte-iyyvkb"> <div class="info svelte-iyyvkb"><span class="title svelte-iyyvkb">Loading Title...</span> <span class="authors svelte-iyyvkb">Loading authors...</span></div></div>'),Ue=y('<h2 class="svelte-iyyvkb"> </h2> <div class="book-search svelte-iyyvkb"><input id="search" type="text" class="svelte-iyyvkb"> <!></div> <div class="search-results svelte-iyyvkb"></div>',1),De=y('<div class="book svelte-iyyvkb"><img class="svelte-iyyvkb"> <div class="info svelte-iyyvkb"><span class="title svelte-iyyvkb"> </span> <span class="authors svelte-iyyvkb"> </span></div> <button class="close svelte-iyyvkb"><!></button></div>'),Fe=y('<div class="books"></div>'),Ge=y('<span class="error svelte-iyyvkb"> </span>'),Je=y('<!> <h2 class="body-name svelte-iyyvkb">Rating</h2> <div class="stars svelte-iyyvkb"><input id="rating" class="svelte-iyyvkb"> <!></div>',1),Ke=y('<h2 class="body-name svelte-iyyvkb">Update Type</h2> <!> <!>',1),Qe=(V,C)=>_(C,!e(C)),We=y("<button><!></button>"),Xe=y('<div class="preview svelte-iyyvkb"><!></div>'),Ye=y('<textarea id="body" class="svelte-iyyvkb"></textarea>'),Ze=y("<!> <!>",1),$e=y('<div class="new-post-page svelte-iyyvkb"><!> <!> <!> <div class="body-header svelte-iyyvkb"><h2 class="body-name preview-body svelte-iyyvkb"></h2> <!></div> <!> <!> <button class="post-button svelte-iyyvkb">Post</button></div>');function fa(V,C){ke(C,!0);const X=(d,b)=>{let T=xe(()=>we(b==null?void 0:b(),"Add a book"));var m=Ue(),k=F(m),A=i(k,!0);s(k);var g=r(k,2),h=i(g);_e(h),h.__keyup=[Ve,pe];var L=r(h,2);{var N=p=>{var x=qe(),S=i(x,!0);s(x),G(()=>I(S,e(M))),n(p,x)};B(L,p=>{e(M)&&p(N)})}s(g);var U=r(g,2);de(U,21,()=>e(ie),je,(p,x)=>{var S=ce(),H=F(S);ne(H,()=>e(x),P=>{var E=Me();n(P,E)},(P,E)=>{var D=ze(),a=se(()=>fe(e(E)));D.__click=function(...J){var Q;(Q=e(a))==null||Q.apply(this,J)};var t=i(D),v=r(t,2),u=i(v),O=i(u,!0);s(u);var c=r(u,2),o=i(c,!0);s(c),s(v),s(D),G(J=>{W(t,"alt",`${e(E).title??""} cover`),W(t,"src",e(E).cover),I(O,e(E).title),I(o,J)},[()=>e(E).authors.join(",")]),n(P,D)}),n(p,S)}),s(U),G(()=>{I(A,e(T)),le(h,"outline",e(M)?"2px solid var(--red)":"none")}),oe(h,()=>e($),p=>_($,p)),n(d,m)},Y=d=>{var b=Fe();de(b,21,()=>e(j),T=>T.isbn,(T,m)=>{var k=De(),A=i(k),g=r(A,2),h=i(g),L=i(h,!0);s(h);var N=r(h,2),U=i(N,!0);s(N),s(g);var p=r(g,2),x=se(()=>me(e(m)));p.__click=function(...H){var P;(P=e(x))==null||P.apply(this,H)};var S=i(p);Ne(S,{stroke:"var(--red)",style:"width: 1.25rem; height: 1.25rem;"}),s(p),s(k),G(H=>{W(A,"alt",`${e(m).title??""} cover`),W(A,"src",e(m).cover),I(L,e(m).title),I(U,H)},[()=>e(m).authors.join(",")]),n(T,k)}),s(b),n(d,b)};let{type:l}=C.data,ye={general:"Post Body",rating:"Review (Optional)",update:"Comments (Optional)",reply:null}[l],q=w(""),z=w(null),Z=w("start"),j=w(K([])),ie=w(K([])),$=w("");async function pe(){_(ie,K(await Ae(e($))))}let ee=w("");function ue(){l==="general"&&e(q).trim().length===0?_(ee,"Body cannot be empty"):_(ee,"")}function be(){if(l==="rating"&&ve(),(l==="rating"||l==="update")&&ae(),l==="general"&&ue(),e(R)||e(M)||e(ee))return;let d={type:l,body:e(q),books:e(j).map(b=>b.isbn)};e(z)!==null&&(d=Object.assign(d,{rating:Number(e(z))})),l==="update"&&(d=Object.assign(d,{updateType:e(Z)})),Ce(d),Se("/profile")}function fe(d){return function(){e(j).push(d),ae()}}function me(d){return function(){_(j,K(e(j).filter(b=>b.isbn!==d.isbn))),ae()}}let R=w(""),M=w("");function ve(){if(l==="rating"){if(e(z)===null){_(R,"Add a rating value.");return}if(!/^\d(\.\d)?$/.test(e(z))){_(R,"Value must be between 0 and 10, to at most one decimal place.");return}}_(R,"")}function ae(){l==="rating"&&e(j).length===0?_(M,"Choose a book to rate."):_(M,"")}let te=w(!1);Be(V,{children:(d,b)=>{var T=$e(),m=i(T);He(m,{title:`New ${l??""} Post`});var k=r(m,2);{var A=a=>{var t=Je(),v=F(t);{var u=f=>{X(f,()=>"Choose a book")},O=f=>{Y(f)};B(v,f=>{e(j).length===0?f(u):f(O,!1)})}var c=r(v,4),o=i(c);_e(o),o.__input=ve;var J=r(o,2);{var Q=f=>{var re=Ge(),he=i(re,!0);s(re),G(()=>I(he,e(R))),n(f,re)};B(J,f=>{e(R)&&f(Q)})}s(c),G(()=>le(o,"outline",e(R)?"2px solid #f38ba8":"none")),oe(o,()=>e(z),f=>_(z,f)),n(a,t)};B(k,a=>{l==="rating"&&a(A)})}var g=r(k,2);{var h=a=>{var t=Ke(),v=r(F(t),2);Le(v,{options:["start","finish","abandon"],style:"margin-bottom: 1rem;",get value(){return e(Z)},set value(o){_(Z,K(o))}});var u=r(v,2);{var O=o=>{X(o,()=>"Choose a book")},c=o=>{Y(o)};B(u,o=>{e(j).length===0?o(O):o(c,!1)})}n(a,t)};B(g,a=>{l==="update"&&a(h)})}var L=r(g,2),N=i(L);N.textContent=ye;var U=r(N,2);{var p=a=>{var t=We();t.__click=[Qe,te];var v=i(t);const u=se(()=>e(te)?"var(--lavender)":"var(--overlay-1)");Te(v,{get stroke(){return e(u)},style:"width: 1rem; height: 1rem;"}),s(t),n(a,t)};B(U,a=>{e(q)&&a(p)})}s(L);var x=r(L,2);{var S=a=>{var t=ce(),v=F(t);ne(v,()=>Re(e(q)),null,(u,O)=>{var c=Xe(),o=i(c);Pe(o,()=>e(O),!1,!1),s(c),n(u,c)}),n(a,t)},H=a=>{var t=Ye();Oe(t),oe(t,()=>e(q),v=>_(q,v)),n(a,t)};B(x,a=>{e(te)?a(S):a(H,!1)})}var P=r(x,2);{var E=a=>{var t=Ze(),v=F(t);{var u=c=>{Y(c)};B(v,c=>{e(j).length!==0&&c(u)})}var O=r(v,2);X(O,()=>"Add a book"),n(a,t)};B(P,a=>{l!=="rating"&&l!=="update"&&a(E)})}var D=r(P,2);D.__click=be,s(T),n(d,T)},$$slots:{default:!0}}),ge()}Ee(["keyup","click","input"]);export{fa as component,ba as universal};
