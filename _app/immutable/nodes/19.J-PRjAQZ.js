import"../chunks/Bg9kRutz.js";import{p as ke,a7 as w,a as ge,s as r,y as e,w as y,c as i,f as D,r as s,t as F,a8 as se,Y as xe,ac as we}from"../chunks/BaZyK-JQ.js";import{i as B,s as I}from"../chunks/DBYv9uc3.js";import{P as Be,a as ne,s as le}from"../chunks/CmIO_luA.js";import{e as de,i as Te}from"../chunks/CN4MRzID.js";import{h as je}from"../chunks/BrYFX6Dx.js";import{a as n,t as _,c as ce}from"../chunks/Dd2BwSaU.js";import{r as ye,s as Q}from"../chunks/D230ZY73.js";import{d as Pe,r as Ee}from"../chunks/BuFl6vNe.js";import{b as oe}from"../chunks/2_PfXxFa.js";import{p as J}from"../chunks/COAggT6D.js";import{g as Oe}from"../chunks/-gHEQhdm.js";import{r as Se,t as Ce,v as Re}from"../chunks/aGIjvC-0.js";import{S as Ae}from"../chunks/CCtENb_p.js";import{E as Le,T as Ne}from"../chunks/KFNUWUS5.js";import{H as He}from"../chunks/BTwKW20K.js";const Ie=({params:q})=>q,ba=Object.freeze(Object.defineProperty({__proto__:null,load:Ie},Symbol.toStringTag,{value:"Module"}));function qe(q,C){q.key==="Enter"&&C()}var ze=_('<span class="error svelte-iyyvkb"> </span>'),Me=_('<div class="book search-book svelte-iyyvkb"><img class="svelte-iyyvkb"> <div class="info svelte-iyyvkb"><span class="title svelte-iyyvkb"> </span> <span class="authors svelte-iyyvkb"> </span></div></div>'),Ue=_('<div class="book search-book svelte-iyyvkb"><img alt="Book cover" src="" class="svelte-iyyvkb"> <div class="info svelte-iyyvkb"><span class="title svelte-iyyvkb">Loading Title...</span> <span class="authors svelte-iyyvkb">Loading authors...</span></div></div>'),Ve=_('<h2 class="svelte-iyyvkb"> </h2> <div class="book-search svelte-iyyvkb"><input id="search" type="text" class="svelte-iyyvkb"> <!></div> <div class="search-results svelte-iyyvkb"></div>',1),Ye=_('<div class="book svelte-iyyvkb"><img class="svelte-iyyvkb"> <div class="info svelte-iyyvkb"><span class="title svelte-iyyvkb"> </span> <span class="authors svelte-iyyvkb"> </span></div> <button class="close svelte-iyyvkb"><!></button></div>'),De=_('<div class="books"></div>'),Fe=_('<span class="error svelte-iyyvkb"> </span>'),Ge=_('<!> <h2 class="body-name svelte-iyyvkb">Rating</h2> <div class="stars svelte-iyyvkb"><input id="rating" class="svelte-iyyvkb"> <!></div>',1),Je=_('<h2 class="body-name svelte-iyyvkb">Update Type</h2> <!> <!>',1),Ke=(q,C)=>y(C,!e(C)),Qe=_("<button><!></button>"),We=_('<div class="preview svelte-iyyvkb"><!></div>'),Xe=_('<textarea id="body" class="svelte-iyyvkb"></textarea>'),Ze=_("<!> <!>",1),$e=_('<div class="new-post-page svelte-iyyvkb"><!> <!> <!> <div class="body-header svelte-iyyvkb"><h2 class="body-name preview-body svelte-iyyvkb"></h2> <!></div> <!> <!> <button class="post-button svelte-iyyvkb">Post</button></div>');function fa(q,C){ke(C,!0);const W=(d,b)=>{let j=xe(()=>we(b==null?void 0:b(),"Add a book"));var m=Ve(),k=D(m),A=i(k,!0);s(k);var g=r(k,2),h=i(g);ye(h),h.__keyup=[qe,pe];var L=r(h,2);{var N=p=>{var x=ze(),S=i(x,!0);s(x),F(()=>I(S,e(U))),n(p,x)};B(L,p=>{e(U)&&p(N)})}s(g);var V=r(g,2);de(V,21,()=>e(ie),Te,(p,x)=>{var S=ce(),H=D(S);ne(H,()=>e(x),P=>{var E=Ue();n(P,E)},(P,E)=>{var Y=Me(),a=se(()=>fe(e(E)));Y.__click=function(...G){var K;(K=e(a))==null||K.apply(this,G)};var t=i(Y),v=r(t,2),u=i(v),O=i(u,!0);s(u);var c=r(u,2),o=i(c,!0);s(c),s(v),s(Y),F(G=>{Q(t,"alt",`${e(E).title??""} cover`),Q(t,"src",e(E).cover),I(O,e(E).title),I(o,G)},[()=>e(E).authors.join(",")]),n(P,Y)}),n(p,S)}),s(V),F(()=>{I(A,e(j)),le(h,"outline",e(U)?"2px solid var(--red)":"none")}),oe(h,()=>e($),p=>y($,p)),n(d,m)},X=d=>{var b=De();de(b,21,()=>e(T),j=>j.isbn,(j,m)=>{var k=Ye(),A=i(k),g=r(A,2),h=i(g),L=i(h,!0);s(h);var N=r(h,2),V=i(N,!0);s(N),s(g);var p=r(g,2),x=se(()=>me(e(m)));p.__click=function(...H){var P;(P=e(x))==null||P.apply(this,H)};var S=i(p);Ne(S,{stroke:"var(--red)",style:"width: 1.25rem; height: 1.25rem;"}),s(p),s(k),F(H=>{Q(A,"alt",`${e(m).title??""} cover`),Q(A,"src",e(m).cover),I(L,e(m).title),I(V,H)},[()=>e(m).authors.join(",")]),n(j,k)}),s(b),n(d,b)};let{type:l}=C.data,_e={general:"Post Body",rating:"Review (Optional)",update:"Comments (Optional)",reply:null}[l],z=w(""),M=w(null),Z=w("start"),T=w(J([])),ie=w(J([])),$=w("");async function pe(){y(ie,J(await Re(e($))))}let ee=w("");function ue(){l==="general"&&e(z).trim().length===0?y(ee,"Body cannot be empty"):y(ee,"")}function be(){if(l==="rating"&&ve(),(l==="rating"||l==="update")&&ae(),l==="general"&&ue(),e(R)||e(U)||e(ee))return;let d={type:l,body:e(z),books:e(T).map(b=>b.isbn)};e(M)!==null&&(d=Object.assign(d,{rating:Number(e(M))})),l==="update"&&(d=Object.assign(d,{updateType:e(Z)})),Se(d),Oe("/profile")}function fe(d){return function(){e(T).push(d),ae()}}function me(d){return function(){y(T,J(e(T).filter(b=>b.isbn!==d.isbn))),ae()}}let R=w(""),U=w("");function ve(){if(l==="rating"){if(e(M)===null){y(R,"Add a rating value.");return}if(!/^\d(\.\d)?$/.test(e(M))){y(R,"Value must be between 0 and 10, to at most one decimal place.");return}}y(R,"")}function ae(){l==="rating"&&e(T).length===0?y(U,"Choose a book to rate."):y(U,"")}let te=w(!1);Be(q,{children:(d,b)=>{var j=$e(),m=i(j);He(m,{title:`New ${l??""} Post`});var k=r(m,2);{var A=a=>{var t=Ge(),v=D(t);{var u=f=>{W(f,()=>"Choose a book")},O=f=>{X(f)};B(v,f=>{e(T).length===0?f(u):f(O,!1)})}var c=r(v,4),o=i(c);ye(o),o.__input=ve;var G=r(o,2);{var K=f=>{var re=Fe(),he=i(re,!0);s(re),F(()=>I(he,e(R))),n(f,re)};B(G,f=>{e(R)&&f(K)})}s(c),F(()=>le(o,"outline",e(R)?"2px solid #f38ba8":"none")),oe(o,()=>e(M),f=>y(M,f)),n(a,t)};B(k,a=>{l==="rating"&&a(A)})}var g=r(k,2);{var h=a=>{var t=Je(),v=r(D(t),2);Ae(v,{options:["start","finish","abandon"],style:"margin-bottom: 1rem;",get value(){return e(Z)},set value(o){y(Z,J(o))}});var u=r(v,2);{var O=o=>{W(o,()=>"Choose a book")},c=o=>{X(o)};B(u,o=>{e(T).length===0?o(O):o(c,!1)})}n(a,t)};B(g,a=>{l==="update"&&a(h)})}var L=r(g,2),N=i(L);N.textContent=_e;var V=r(N,2);{var p=a=>{var t=Qe();t.__click=[Ke,te];var v=i(t);const u=se(()=>e(te)?"var(--lavender)":"var(--overlay-1)");Le(v,{get stroke(){return e(u)},style:"width: 1rem; height: 1rem;"}),s(t),n(a,t)};B(V,a=>{e(z)&&a(p)})}s(L);var x=r(L,2);{var S=a=>{var t=ce(),v=D(t);ne(v,()=>Ce(e(z)),null,(u,O)=>{var c=We(),o=i(c);je(o,()=>e(O),!1,!1),s(c),n(u,c)}),n(a,t)},H=a=>{var t=Xe();Ee(t),oe(t,()=>e(z),v=>y(z,v)),n(a,t)};B(x,a=>{e(te)?a(S):a(H,!1)})}var P=r(x,2);{var E=a=>{var t=Ze(),v=D(t);{var u=c=>{X(c)};B(v,c=>{e(T).length!==0&&c(u)})}var O=r(v,2);W(O,()=>"Add a book"),n(a,t)};B(P,a=>{l!=="rating"&&l!=="update"&&a(E)})}var Y=r(P,2);Y.__click=be,s(j),n(d,j)},$$slots:{default:!0}}),ge()}Pe(["keyup","click","input"]);export{fa as component,ba as universal};
