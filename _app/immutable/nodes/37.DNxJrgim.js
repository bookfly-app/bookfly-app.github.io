import"../chunks/Bzak7iHL.js";import{o as Ne,s as pe}from"../chunks/JskAO5LV.js";import{a6 as o,e as b,r as h,a as s,p as Be,a9 as M,aa as G,g as Ae,f as c,d as u,j as e,ab as J,t as _e,ac as y,c as g}from"../chunks/B-4qJ0jo.js";import{P as Me,a as K}from"../chunks/DysX6KL5.js";import{i as m}from"../chunks/wXu3LSAe.js";import{e as oe,i as re}from"../chunks/BYSh6dwO.js";import{r as Re,s as fe,c as O,d as Q}from"../chunks/C8LXp0oK.js";import{d as Te,e as je}from"../chunks/s5iYg1w1.js";import{b as He}from"../chunks/GqlYdfv6.js";import{g as he}from"../chunks/BYxnAq2c.js";import{z as ze,v as Ce,A as Ie}from"../chunks/CSLRLUv4.js";import"../chunks/69_IOA4Y.js";import{W as Ve}from"../chunks/Df9Lh074.js";import{A as qe,B as De}from"../chunks/DGWPqjQL.js";import{U as Fe}from"../chunks/CaHYWbrZ.js";import{H as Ge}from"../chunks/DBMgkzyq.js";var Je=o('<div class="svelte-162e39x"><!></div>');function me(z){var w=Je(),P=b(w);Ve(P,{stroke:"var(--surface-2)",style:"width: 2rem; height: 2rem;"}),h(w),s(z,w)}function Ke(z,w,P){z.key==="Enter"?w():(e(P)&&clearTimeout(e(P)),y(P,setTimeout(w,3e3),!0))}var Oe=o('<div class="loading svelte-ok325s"><h1 class="svelte-ok325s">Search for a post</h1> <p class="svelte-ok325s">Enter your search term to find relevant posts.</p></div>'),Qe=o('<div class="loading svelte-ok325s"><h1 class="svelte-ok325s">No posts found</h1> <p class="svelte-ok325s">No posts were found relating to your search term. Make sure you spelled everything right!</p></div>'),Xe=o("<!> <!>",1),Ye=o('<div class="loading svelte-ok325s"><h1 class="svelte-ok325s">Loading posts...</h1> <p class="svelte-ok325s">We promise Wallflower will be faster soon.</p> <!></div>'),Ze=o('<div class="loading svelte-ok325s"><h1 class="svelte-ok325s">Search for a book</h1> <p class="svelte-ok325s">Enter your search term to find relevant books.</p></div>'),$e=o('<div class="loading svelte-ok325s"><h1 class="svelte-ok325s">No books found</h1> <p class="svelte-ok325s">No books were found relating to your search term. Make sure you spelled everything right!</p></div>'),es=o('<div class="loading-cover svelte-ok325s"></div>'),ss=o('<a class="book svelte-ok325s"><div class="book-info svelte-ok325s"><h1 class="svelte-ok325s"> </h1> <h2 class="svelte-ok325s"> </h2></div> <!></a>'),as=o('<div class="book svelte-ok325s"><div class="book-info svelte-ok325s"><div class="loading-title svelte-ok325s"></div> <div class="loading-authors svelte-ok325s"></div></div> <div class="loading-cover svelte-ok325s"></div></div>'),os=o('<!> <div class="books svelte-ok325s"></div>',1),rs=o('<div class="loading svelte-ok325s"><h1 class="svelte-ok325s">Loading books...</h1> <p class="svelte-ok325s">We promise Wallflower will be faster soon.</p> <!></div>'),ts=o('<div class="loading svelte-ok325s"><h1 class="svelte-ok325s">Search for a user</h1> <p class="svelte-ok325s">Enter your search term to find relevant users.</p></div>'),vs=o('<div class="loading svelte-ok325s"><h1 class="svelte-ok325s">No users found</h1> <p class="svelte-ok325s">No users were found relating to your search term. Make sure you spelled everything right!</p></div>'),ls=o('<!> <div class="people"></div>',1),is=o('<div class="loading svelte-ok325s"><h1 class="svelte-ok325s">Loading accounts...</h1> <p class="svelte-ok325s">We promise Wallflower will be faster soon.</p></div>'),ns=o('<!> <section class="svelte-ok325s"><input type="text" enterkeyhint="search" class="svelte-ok325s"/> <div class="views svelte-ok325s"><button>Posts</button> <button>Books</button> <button>Authors</button> <button>Users</button></div></section> <!>',1);function Es(z,w){Be(w,!0);let P=M(null),n=M(G(new URLSearchParams(window.location.search).get("view")??"posts")),i=M("");async function q(){e(D)&&clearTimeout(e(D)),y(D,null),y(i,e(i).trim(),!0);const x=new URLSearchParams({term:e(i),view:e(n)});he(`/search?${x}`),e(n)==="posts"?y(te,ze(e(i)),!0):e(n)==="books"?y(ve,Ce(e(i)),!0):e(n)==="people"&&y(le,Ie(e(i)),!0)}Ne(()=>{e(i)&&q()});let D=M(null),te=M(G(Promise.resolve([]))),ve=M(G(Promise.resolve([]))),le=M(G(Promise.resolve([])));function F(x){return function(){const X=new URLSearchParams({view:x});e(i)&&X.set("term",e(i)),he(`/search?${X}`),y(n,x,!0),q()}}Me(z,{type:"search",get sidebar(){return e(P)},set sidebar(x){y(P,x,!0)},children:(x,X)=>{var ie=ns(),ne=c(ie);Ge(ne,{title:"Search"});var Y=u(ne,2),R=b(Y);Re(R),R.__keyup=[Ke,q,D];var de=u(R,2),Z=b(de),ke=J(()=>F("posts"));Z.__click=function(...r){var a;(a=e(ke))==null||a.apply(this,r)};var $=u(Z,2),ge=J(()=>F("books"));$.__click=function(...r){var a;(a=e(ge))==null||a.apply(this,r)};var ee=u($,2),be=J(()=>F("authors"));ee.__click=function(...r){var a;(a=e(be))==null||a.apply(this,r)};var ce=u(ee,2),ye=J(()=>F("people"));ce.__click=function(...r){var a;(a=e(ye))==null||a.apply(this,r)},h(de),h(Y);var we=u(Y,2);{var Pe=r=>{var a=g(),se=c(a);K(se,()=>e(te),C=>{var S=Ye(),_=u(b(S),4);me(_),h(S),s(C,S)},(C,S)=>{var _=Xe(),E=c(_);{var I=t=>{var f=Oe();s(t,f)},N=t=>{var f=g(),B=c(f);{var L=k=>{var d=Qe();s(k,d)};m(B,k=>{e(S).length===0&&k(L)},!0)}s(t,f)};m(E,t=>{e(i)==""?t(I):t(N,!1)})}var p=u(E,2);oe(p,17,()=>e(S),re,(t,f)=>{qe(t,{get post(){return e(f)}})}),s(C,_)}),s(r,a)},xe=r=>{var a=g(),se=c(a);{var C=_=>{var E=g(),I=c(E);K(I,()=>e(ve),N=>{var p=rs(),t=u(b(p),4);me(t),h(p),s(N,p)},(N,p)=>{var t=os(),f=c(t);{var B=d=>{var W=Ze();s(d,W)},L=d=>{var W=g(),T=c(W);{var j=v=>{var l=$e();s(v,l)};m(T,v=>{e(p).length===0&&v(j)},!0)}s(d,W)};m(f,d=>{e(i)==""?d(B):d(L,!1)})}var k=u(f,2);oe(k,21,()=>e(p),re,(d,W)=>{var T=g(),j=c(T);K(j,()=>e(W),v=>{var l=as();s(v,l)},(v,l)=>{var H=ss(),V=b(H),A=b(V),ae=b(A,!0);h(A);var ue=u(A,2),Se=b(ue,!0);h(ue),h(V);var Ee=u(V,2);{var Le=U=>{De(U,{get book(){return e(l)},style:"width: 3.5rem; margin-left: auto;"})},We=U=>{var Ue=es();s(U,Ue)};m(Ee,U=>{e(l).cover?U(Le):U(We,!1)})}h(H),_e(U=>{fe(H,"href",`/book/${e(l).isbn}`),pe(ae,e(l).title),pe(Se,U)},[()=>e(l).authors.join(", ")]),s(v,H)}),s(d,T)}),h(k),s(N,t)}),s(_,E)},S=_=>{var E=g(),I=c(E);{var N=p=>{var t=g(),f=c(t);K(f,()=>e(le),B=>{var L=is();s(B,L)},(B,L)=>{var k=ls(),d=c(k);{var W=v=>{var l=ts();s(v,l)},T=v=>{var l=g(),H=c(l);{var V=A=>{var ae=vs();s(A,ae)};m(H,A=>{e(L).length===0&&A(V)},!0)}s(v,l)};m(d,v=>{e(i)==""?v(W):v(T,!1)})}var j=u(d,2);oe(j,21,()=>e(L),re,(v,l)=>{Fe(v,{get user(){return e(l)}})}),h(j),s(B,k)}),s(p,t)};m(I,p=>{e(n)==="people"&&p(N)},!0)}s(_,E)};m(se,_=>{e(n)==="books"?_(C):_(S,!1)},!0)}s(r,a)};m(we,r=>{e(n)==="posts"?r(Pe):r(xe,!1)})}_e(()=>{fe(R,"placeholder",{books:"Enter a title or ISBN",posts:"Enter some keywords",authors:"Enter an author's name",people:"Enter a username"}[e(n)]),O(Z,1,Q(e(n)==="posts"?"selected":""),"svelte-ok325s"),O($,1,Q(e(n)==="books"?"selected":""),"svelte-ok325s"),O(ee,1,Q(e(n)==="authors"?"selected":""),"svelte-ok325s"),O(ce,1,Q(e(n)==="people"?"selected":""),"svelte-ok325s")}),je("blur",R,q),He(R,()=>e(i),r=>y(i,r)),s(x,ie)},$$slots:{default:!0}}),Ae()}Te(["keyup","click"]);export{Es as component};
