import"./Bg9kRutz.js";import{F as ae,H as ot,G as Oe,A as Lt,E as Nt,B as At,W as Ut,X as It,L as st,K as lt,w as Et,aH as dt,O as jt,N as Tt,D as zt,p as ve,s as c,c as i,r as v,t as B,a as ce,f as d,ab as ke,g as e,q as ie,k as W,aa as Dt}from"./RV0lYC__.js";import{b as qt,a as n,n as Ne,c as x,t as b}from"./DPalutH2.js";import{s as w,e as nt,a as j,g as it,P as Wt}from"./Cnx23qS_.js";import{r as Ae,i as V,s as U,b as vt,p as ct}from"./Xy_1ng5V.js";import{p as be}from"./DyOO7CRH.js";import{A as Zt,j as Ke,q as Ot,B as Kt,z as Xt,u as he,d as _t,o as Jt,n as Qt}from"./Dni00B-4.js";import{N as Yt}from"./qgIPkGct.js";import{e as Ce,i as He}from"./Dyzu_CEI.js";import{h as $t}from"./bd5DCr_W.js";import{s as I,a as Se}from"./DuaAZeCU.js";import{q as ea,d as ta}from"./B8Jl9l9K.js";import{o as aa}from"./9pAqFiF3.js";import{g as Xe}from"./CBSqThqY.js";import{S as ra,B as oa,a as sa,A as Le,C as la}from"./ChgFrr65.js";import{t as Re}from"./w5pHyre2.js";import{B as na}from"./CcjPZEGA.js";import{R as ia}from"./BF3audWm.js";function va(_,o,r,C,s,m){let g=ae;ae&&ot();var y,P,h=null;ae&&Oe.nodeType===1&&(h=Oe,ot());var T=ae?Oe:_,G;Lt(()=>{const f=o()||null;var E=f==="svg"?dt:null;f!==y&&(G&&(f===null?jt(G,()=>{G=null,P=null}):f===P?Tt(G):zt(G)),f&&f!==P&&(G=At(()=>{h=ae?h:E?document.createElementNS(E,f):document.createElement(f),qt(h,h);{ae&&ea(f)&&h.append(document.createComment(""));var L=ae?Ut(h):h.appendChild(It());ae&&(L===null?st(!1):lt(L)),C(h,L)}Et.nodes_end=h,T.before(h)})),y=f,y&&(P=y))},Nt),g&&(st(!0),lt(T))}var ca=Ne('<svg><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"><path d="M4 19V6.2C4 5.0799 4 4.51984 4.21799 4.09202C4.40973 3.71569 4.71569 3.40973 5.09202 3.21799C5.51984 3 6.0799 3 7.2 3H16.8C17.9201 3 18.4802 3 18.908 3.21799C19.2843 3.40973 19.5903 3.71569 19.782 4.09202C20 4.51984 20 5.0799 20 6.2V17H6C4.89543 17 4 17.8954 4 19ZM4 19C4 20.1046 4.89543 21 6 21H20M9 7H15M9 11H15M19 17V21" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path></g></svg>');function ua(_,o){ve(o,!0);let r=Ae(o,["$$slots","$$events","$$legacy"]),C=o.stroke;r={...r},r.stroke=void 0;var s=ca();let m;var g=c(i(s),2),y=i(g);I(y,"stroke",C),v(g),v(s),B(()=>m=Se(s,m,{...r,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},void 0,!0)),n(_,s),ce()}var da=Ne('<svg><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"><path d="M12 7V12L14.5 10.5M21 12C21 16.9706 16.9706 21 12 21C7.02944 21 3 16.9706 3 12C3 7.02944 7.02944 3 12 3C16.9706 3 21 7.02944 21 12Z" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path></g></svg>');function _a(_,o){ve(o,!0);let r=Ae(o,["$$slots","$$events","$$legacy"]),C=o.stroke;r={...r},r.stroke=void 0;var s=da();let m;var g=c(i(s),2),y=i(g);I(y,"stroke",C),v(g),v(s),B(()=>m=Se(s,m,{...r,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},void 0,!0)),n(_,s),ce()}var ga=Ne('<svg><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"><path id="primary" d="M21,11H5.41l1.3-1.29A1,1,0,0,0,5.29,8.29l-3,3a1,1,0,0,0,0,1.42l3,3a1,1,0,0,0,1.42,0,1,1,0,0,0,0-1.42L5.41,13H21a1,1,0,0,0,0-2Z"></path></g></svg>');function fa(_,o){ve(o,!0);let r=Ae(o,["$$slots","$$events","$$legacy"]),C=o.stroke;r={...r},r.stroke=void 0;var s=ga();let m;var g=c(i(s),2),y=i(g);I(y,"style",`fill: ${C??""};`),v(g),v(s),B(()=>m=Se(s,m,{...r,fill:C,viewBox:"0 0 24 24",id:"left-arrow","data-name":"Flat Color",xmlns:"http://www.w3.org/2000/svg",class:"icon flat-color"},void 0,!0)),n(_,s),ce()}var ma=Ne('<svg><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"><path d="M13 12H21M13 8H21M13 16H21M6 7V17M6 17L3 14M6 17L9 14" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path></g></svg>');function pa(_,o){ve(o,!0);let r=Ae(o,["$$slots","$$events","$$legacy"]),C=o.stroke;r={...r},r.stroke=void 0;var s=ma();let m;var g=c(i(s),2),y=i(g);I(y,"stroke",C),v(g),v(s),B(()=>m=Se(s,m,{...r,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},void 0,!0)),n(_,s),ce()}var ka=b('<div class="rating svelte-153hpy1"><span> </span> <!> <span> </span></div>'),ba=b('<div class="book-info svelte-153hpy1"><h1 class="svelte-153hpy1"> </h1> <h2 class="svelte-153hpy1"> </h2></div> <!> <!>',1);function ut(_,o){ve(o,!0);var r=x(),C=d(r);va(C,()=>o.onclick?"div":"a",!1,(s,m)=>{var g=()=>{var R;return(R=o.onclick)==null?void 0:R.call(o)};let y;B((R,M)=>{y=Se(s,y,{"data-rating":o.rating,id:"outer",href:`/book/${o.book.isbn??""}`,onclick:g},"svelte-153hpy1",s.namespaceURI===dt,s.nodeName.includes("-")),w(s,"border-color",R),w(s,"background",M)},[()=>Re().textDark,()=>Re().background]);var P=ba(),h=d(P),T=i(h),G=i(T,!0);v(T);var f=c(T,2),E=i(f,!0);v(f),v(h);var L=c(h,2);{var re=R=>{var M=ka(),H=i(M),Y=i(H);v(H);var oe=c(H,2);ra(oe,{get rating(){return o.rating},size:.6});var se=c(oe,2),Fe=i(se);v(se),v(M),B((le,Ue)=>{w(H,"color",le),U(Y,`${o.user.displayName??""}'s rating:`),w(se,"color",le),U(Fe,`${Ue??""} / 10`)},[()=>Re().text,()=>o.rating===10?o.rating:o.rating.toFixed(1)]),n(R,M)};V(L,R=>{o.rating!==void 0&&R(re)})}var ue=c(L,2);na(ue,{style:"height: 100%; aspect-ratio: 8 / 11;",get book(){return o.book}}),B((R,M,H)=>{w(T,"color",R),U(G,o.book.title),w(f,"color",M),U(E,H)},[()=>Re().text,()=>Re().textDull,()=>o.book.authors.join(", ")]),n(m,P)}),n(_,r),ce()}function ha(_,o){_t({following:[...new Set([...he().following,o.id])]})}function wa(_,o){_t({following:he().following.filter(r=>r!==o.id)})}var ya=b('<div class="banner svelte-1aukclm"></div>'),xa=(_,o)=>o.show(),Ca=b('<img class="profile-picture svelte-1aukclm">'),Ra=b('<div class="dot svelte-1aukclm"></div> <h2 class="pronouns svelte-1aukclm"> </h2>',1),Sa=()=>Xe("/profile/edit"),Fa=b('<button class="edit button svelte-1aukclm">Edit Profile</button>'),Ba=b('<button class="unfollow button svelte-1aukclm">Unfollow</button>'),Ma=b('<button class="follow button svelte-1aukclm">Follow</button>'),Va=b('<p class="bio svelte-1aukclm"><!></p>'),Pa=b('<a class="svelte-1aukclm"><!> <span class="truncate svelte-1aukclm"> </span></a>'),Ga=b('<a class="svelte-1aukclm"><!> <span class="truncate svelte-1aukclm"> </span></a>'),Ha=(_,o)=>ie(o,"books"),La=b('<a class="svelte-1aukclm"><!> <span> </span></a>'),Na=b("<span> </span>"),Aa=(_,o)=>e(o).open(_),Ua=b('<button class="svelte-1aukclm">Highest Rated</button> <button class="svelte-1aukclm">Recently Finished</button>',1),Ia=b('<div class="ratings svelte-1aukclm"><div class="rating-options svelte-1aukclm"><span class="svelte-1aukclm"><label for="show-full-reviews" class="svelte-1aukclm">Show full reviews</label> <!></span> <span class="svelte-1aukclm"><label for="change-rating-sort" class="svelte-1aukclm"> </label> <button id="change-rating-sort" class="svelte-1aukclm"><!></button></span> <!></div> <!></div>'),Ea=b('<div class="ratings svelte-1aukclm"><!></div>'),ja=b('<div class="loading svelte-1aukclm"><h1 class="svelte-1aukclm">Loading posts...</h1> <p class="svelte-1aukclm">We promise Wallflower will be faster soon.</p></div>'),Ta=b('<section class="svelte-1aukclm"><!> <button class="back-arrow svelte-1aukclm"><!></button> <div class="profile svelte-1aukclm"><!> <div class="profile-line-1 svelte-1aukclm"><span class="name svelte-1aukclm"><h1 class="svelte-1aukclm"> </h1> <h2 class="svelte-1aukclm"> </h2> <!> <!></span> <!></div> <!> <div class="profile-line-2 svelte-1aukclm"><span class="profile-books svelte-1aukclm"><!> <!></span> <!></div> <a class="follows svelte-1aukclm"><!> <span> </span></a> <div class="views svelte-1aukclm"><button class="svelte-1aukclm">All</button> <button class="svelte-1aukclm">Books</button> <button class="svelte-1aukclm">Activity</button> <button class="svelte-1aukclm">List</button> <button class="svelte-1aukclm">Discussion</button></div></div> <!></section>');function za(_,o){ve(o,!0);let r=o.user,C=o.sidebar,s=ke(be(new URLSearchParams(window.location.search).get("view")??"all")),m=Zt(r),g=Promise.all(r.readingList.map(a=>Ke(a))),y=Ot(r),P=Kt(r),h=W(()=>{var a;return((a=he())==null?void 0:a.id)===r.id}),T=r.currentBook?Ke(r.currentBook):Promise.resolve(null),G=P.then(a=>a.filter(t=>t.type==="rating").length),f=ke(!1),E=ke(null),L=ke("best"),re=W(()=>({best:"Highest Rated",recent:"Recently Finished"})[e(L)]),ue=W(async()=>(e(L),P.then(a=>a.filter(t=>t.type==="rating").toSorted({best:(t,l)=>l.rating-t.rating,recent:(t,l)=>l.timestamp-t.timestamp}[e(L)]))));function R(a){return()=>{ie(L,be(a)),e(E).close()}}function M(a){return function(){Xe(`${window.location.origin}${window.location.pathname}?${new URLSearchParams({view:a})}`),ie(s,be(a))}}let H=ke(null);function Y(a){const t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(a);return{r:parseInt(t[1],16),g:parseInt(t[2],16),b:parseInt(t[3],16)}}function oe(a,t,l){l=Math.min(Math.max(l,0),1);const p=Y(a),S=Y(t),k=u=>Math.round(p[u]*(1-l)+S[u]*l);return{r:k("r"),g:k("g"),b:k("b")}}aa(()=>{document.addEventListener("scroll",()=>{var a;if((a=e(E))==null||a.close(),e(H)){const l=e(H).getBoundingClientRect().top/100,{r:p,g:S,b:k}=oe(nt("crust"),nt("base"),l);e(H).style.background=`rgb(${p}, ${S}, ${k})`}},!0)});var se=Ta(),Fe=i(se);j(Fe,()=>it(r.banner),null,(a,t)=>{var l=ya();B(()=>w(l,"background-image",`url("${e(t)}")`)),n(a,l)});var le=c(Fe,2);le.__click=[xa,C];var Ue=i(le);fa(Ue,{stroke:"#FFFFFF",style:"width: 1.5rem; height: 1.5rem;"}),v(le);var Ie=c(le,2),Je=i(Ie);j(Je,()=>it(r.picture),null,(a,t)=>{var l=Ca();B(()=>{I(l,"src",e(t)),I(l,"alt",`${r.displayName} profile picture`)}),n(a,l)});var Ee=c(Je,2),je=i(Ee),Te=i(je),gt=i(Te,!0);v(Te);var ze=c(Te,2),ft=i(ze);v(ze);var Qe=c(ze,2);oa(Qe,{forUser:r,size:1});var mt=c(Qe,2);{var pt=a=>{var t=Ra(),l=c(d(t),2),p=i(l,!0);v(l),B(()=>U(p,r.pronouns)),n(a,t)};V(mt,a=>{r.pronouns&&a(pt)})}v(je);var kt=c(je,2);{var bt=a=>{var t=Fa();t.__click=[Sa],n(a,t)},ht=a=>{var t=x(),l=d(t);{var p=S=>{var k=x(),u=d(k);{var N=F=>{var K=Ba();K.__click=[wa,r],n(F,K)},z=F=>{var K=Ma();K.__click=[ha,r],n(F,K)};V(u,F=>{he().following.includes(r.id)?F(N):F(z,!1)})}n(S,k)};V(l,S=>{he()&&S(p)},!0)}n(a,t)};V(kt,a=>{e(h)?a(bt):a(ht,!1)})}v(Ee);var Ye=c(Ee,2);j(Ye,()=>Xt(r.bio),null,(a,t)=>{var l=Va(),p=i(l);$t(p,()=>e(t),!1,!1),v(l),n(a,l)});var De=c(Ye,2),qe=i(De),$e=i(qe);j($e,()=>m,null,(a,t)=>{var l=x(),p=d(l);{var S=k=>{var u=Pa(),N=i(u);sa(N,{stroke:"var(--overlay-1)",style:"width: 1rem; height: 1rem; flex-shrink: 0;"});var z=c(N,2),F=i(z,!0);v(z),v(u),B(()=>{I(u,"href",`/book/${e(t).isbn}`),I(u,"title",`${r.displayName}'s highest rated book is ${e(t).title}`),U(F,e(t).title)}),n(k,u)};V(p,k=>{e(t)&&k(S)})}n(a,l)});var wt=c($e,2);j(wt,()=>T,null,(a,t)=>{var l=x(),p=d(l);{var S=k=>{var u=Ga(),N=i(u);_a(N,{stroke:"var(--overlay-1)",style:"width: 1rem; height: 1rem; flex-shrink: 0;"});var z=c(N,2),F=i(z,!0);v(z),v(u),B(()=>{I(u,"href",`/book/${e(t).isbn??""}`),I(u,"title",`${r.displayName} is currently reading ${e(t).title}`),U(F,e(t).title)}),n(k,u)};V(p,k=>{e(t)&&k(S)})}n(a,l)}),v(qe);var yt=c(qe,2);j(yt,()=>G,null,(a,t)=>{var l=La();l.__click=[Ha,s];var p=i(l);ua(p,{stroke:"var(--overlay-1)",style:"width: 1rem; height: 1rem;"});var S=c(p,2),k=i(S,!0);v(S),v(l),B(()=>{I(l,"href",`/profile/${r.username??""}?view=books`),I(l,"title",`${r.displayName??""} has read ${e(t)??""} book${(e(t)===1?"":"s")??""}`),U(k,e(t))}),n(a,l)}),v(De);var Be=c(De,2),et=i(Be);j(et,()=>y,null,(a,t)=>{var l=Na(),p=i(l);v(l),B(()=>U(p,`${e(t).length??""} Followers`)),n(a,l)});var tt=c(et,2),xt=i(tt);v(tt),v(Be);var at=c(Be,2),Me=i(at),Ct=W(()=>M("all"));Me.__click=function(...a){var t;(t=e(Ct))==null||t.apply(this,a)};var Ve=c(Me,2),Rt=W(()=>M("books"));Ve.__click=function(...a){var t;(t=e(Rt))==null||t.apply(this,a)};var Pe=c(Ve,2),St=W(()=>M("activity"));Pe.__click=function(...a){var t;(t=e(St))==null||t.apply(this,a)};var Ge=c(Pe,2),Ft=W(()=>M("list"));Ge.__click=function(...a){var t;(t=e(Ft))==null||t.apply(this,a)};var We=c(Ge,2),Bt=W(()=>M("discussion"));We.__click=function(...a){var t;(t=e(Bt))==null||t.apply(this,a)},v(at),v(Ie);var Mt=c(Ie,2);j(Mt,()=>P,a=>{var t=ja();n(a,t)},(a,t)=>{var l=x(),p=d(l);{var S=u=>{var N=x(),z=d(N);Ce(z,17,()=>e(t).filter(F=>F.type==="general"),He,(F,K)=>{Le(F,{get post(){return e(K)}})}),n(u,N)},k=u=>{var N=x(),z=d(N);{var F=de=>{var _e=Ia(),ge=i(_e),fe=i(ge);w(fe,"color","var(--overlay-1)");var Ze=c(i(fe),2);ia(Ze,{id:"show-full-reviews",size:.5,get value(){return e(f)},set value(A){ie(f,be(A))}}),v(fe);var D=c(fe,2);w(D,"color","var(--overlay-1)");var X=i(D),we=i(X,!0);v(X);var J=c(X,2);J.__click=[Aa,E];var ye=i(J);pa(ye,{stroke:"var(--overlay-1)",style:"width: 1.5rem; height: 1.5rem;"}),v(J),v(D);var $=c(D,2);vt(la($,{children:(A,me)=>{var q=Ua(),Z=d(q),Q=W(()=>R("best"));Z.__click=function(...xe){var ne;(ne=e(Q))==null||ne.apply(this,xe)};var O=c(Z,2),te=W(()=>R("recent"));O.__click=function(...xe){var ne;(ne=e(te))==null||ne.apply(this,xe)},n(A,q)},$$slots:{default:!0}}),A=>ie(E,be(A)),()=>e(E)),v(ge),vt(ge,A=>ie(H,A),()=>e(H));var ee=c(ge,2);j(ee,()=>e(ue),null,(A,me)=>{var q=x(),Z=d(q);Ce(Z,17,()=>e(me),Q=>Q.id,(Q,O)=>{var te=x(),xe=d(te);{var ne=pe=>{Le(pe,{get post(){return e(O)}})},Vt=pe=>{var rt=x(),Pt=d(rt);j(Pt,()=>Ke(e(O).books[0]),null,(Gt,Ht)=>{ut(Gt,{get book(){return e(Ht)},get rating(){return e(O).rating},user:r,onclick:()=>Xe(`/post/${e(O).id}`)})}),n(pe,rt)};V(xe,pe=>{e(f)?pe(ne):pe(Vt,!1)})}n(Q,te)}),n(A,q)}),v(_e),B(()=>U(we,e(re))),n(de,_e)},K=de=>{var _e=x(),ge=d(_e);{var fe=D=>{var X=x(),we=d(X);Ce(we,17,()=>e(t).filter(J=>J.type==="update"),He,(J,ye)=>{Le(J,{get post(){return e(ye)}})}),n(D,X)},Ze=D=>{var X=x(),we=d(X);{var J=$=>{var ee=Ea(),A=i(ee);j(A,()=>g,null,(me,q)=>{var Z=x(),Q=d(Z);Ce(Q,17,()=>e(q),He,(O,te)=>{ut(O,{get book(){return e(te)},user:r})}),n(me,Z)}),v(ee),n($,ee)},ye=$=>{var ee=x(),A=d(ee);{var me=q=>{var Z=x(),Q=d(Z);Ce(Q,17,()=>e(t),He,(O,te)=>{Le(O,{get post(){return e(te)}})}),n(q,Z)};V(A,q=>{e(s)==="all"&&q(me)},!0)}n($,ee)};V(we,$=>{e(s)==="list"?$(J):$(ye,!1)},!0)}n(D,X)};V(ge,D=>{e(s)==="activity"?D(fe):D(Ze,!1)},!0)}n(de,_e)};V(z,de=>{e(s)==="books"?de(F):de(K,!1)},!0)}n(u,N)};V(p,u=>{e(s)==="discussion"?u(S):u(k,!1)})}n(a,l)}),v(se),B(()=>{U(gt,r.displayName),U(ft,`@${r.username??""}`),I(Be,"href",`/profile/${r.username}/follows`),U(xt,`${r.following.length??""} Following`),w(Me,"color",e(s)==="all"?"var(--subtext-1)":"var(--overlay-1)"),w(Me,"border-bottom",e(s)==="all"?"3px solid var(--lavender)":"3px solid transparent"),w(Ve,"color",e(s)==="books"?"var(--subtext-1)":"var(--overlay-1)"),w(Ve,"border-bottom",e(s)==="books"?"3px solid var(--lavender)":"3px solid transparent"),w(Pe,"color",e(s)==="activity"?"var(--subtext-1)":"var(--overlay-1)"),w(Pe,"border-bottom",e(s)==="activity"?"3px solid var(--lavender)":"3px solid transparent"),w(Ge,"color",e(s)==="list"?"var(--subtext-1)":"var(--overlay-1)"),w(Ge,"border-bottom",e(s)==="list"?"3px solid var(--lavender)":"3px solid transparent"),w(We,"color",e(s)==="discussion"?"var(--subtext-1)":"var(--overlay-1)"),w(We,"border-bottom",e(s)==="discussion"?"3px solid var(--lavender)":"3px solid transparent")}),n(_,se),ce()}ta(["click"]);var Da=b("<!> <!>",1),qa=b('<!> <div class="svelte-uf21oc"></div>',1);function vr(_,o){ve(o,!0);let r=ct(o,"userid",3,void 0),C=ct(o,"username",3,void 0),s=W(()=>r()?Jt(r()):Qt(C())),m=ke(null);Wt(_,{type:"profile",get sidebar(){return e(m)},set sidebar(g){ie(m,be(g))},children:(g,y)=>{var P=qa(),h=d(P);j(h,()=>e(s),null,(T,G)=>{var f=x(),E=d(f);{var L=re=>{var ue=Da(),R=d(ue);za(R,{get sidebar(){return e(m)},get user(){return e(G)}});var M=c(R,2);{var H=Y=>{Yt(Y,{})};V(M,Y=>{var oe;e(G).id===((oe=he())==null?void 0:oe.id)&&Y(H)})}n(re,ue)};V(E,re=>{e(G)&&re(L)})}n(T,f)}),Dt(2),n(g,P)},$$slots:{default:!0}}),ce()}export{vr as P};
