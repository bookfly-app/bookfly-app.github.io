import{b as Pt,a as d,n as Se,t as C,c as V}from"./gFbpwaTI.js";import{h as ae,C as lt,i as Ke,b as jt,E as At,c as Ht,T as Nt,z as Et,F as it,B as vt,M as Ut,aJ as mt,J as Tt,G as zt,e as Dt,p as oe,s as v,j as n,r as l,t as x,a as se,f as y,aa as me,g as e,d as U,ab as re}from"./DBPlaF8E.js";import{s as G}from"./Chu0jhlY.js";import{t as ye,s as p,G as Ot,v as dt,x as Wt,H as Jt,c as J,i as ct,F as Zt,u as ie,f as gt,I as ut}from"./BWtWgn92.js";import{r as he,i as P,a as xe}from"./BW7aK-Zr.js";import{e as Ce,i as Ie}from"./HJfK_IHA.js";import{h as qt}from"./C5UIooYN.js";import{a as R,s as ve,h as Kt}from"./o2l4qZHV.js";import{m as Qt,o as Xt,d as Yt}from"./CThlKSBW.js";import{b as Qe}from"./CVPpxQ3u.js";import{o as $t}from"./CBxwvAny.js";import{g as Xe}from"./DYlwJe7p.js";import{L as ea}from"./8DEPAe4R.js";import{S as ta,B as aa,a as ra,A as Pe,C as oa}from"./5UU8o6SF.js";import{R as sa}from"./BlNhphuP.js";import{c as _t}from"./COdcIwaF.js";function na(m,o,r,f,s,c){let u=ae;ae&&lt();var _,M,w=null;ae&&Ke.nodeType===1&&(w=Ke,lt());var Z=ae?Ke:m,T;jt(()=>{const b=o()||null;var z=b==="svg"?mt:null;b!==_&&(T&&(b===null?Tt(T,()=>{T=null,M=null}):b===M?zt(T):Dt(T)),b&&b!==M&&(T=Ht(()=>{w=ae?w:z?document.createElementNS(z,b):document.createElement(b),Pt(w,w);{ae&&Qt(b)&&w.append(document.createComment(""));var j=ae?Nt(w):w.appendChild(Et());ae&&(j===null?it(!1):vt(j)),f(w,j)}Ut.nodes_end=w,Z.before(w)})),_=b,_&&(M=_))},At),u&&(it(!0),vt(Z))}var la=Se('<svg><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"><circle cx="12" cy="12" r="10" stroke-width="1.5"></circle><path d="M15 12L12 12M12 12L9 12M12 12L12 9M12 12L12 15" stroke-width="1.5" stroke-linecap="round"></path></g></svg>');function ia(m,o){oe(o,!0);let r=he(o,["$$slots","$$events","$$legacy"]),f=o.stroke;r={...r},r.stroke=void 0;var s=la();let c;var u=v(n(s),2),_=n(u);R(_,"stroke",f);var M=v(_);R(M,"stroke",f),l(u),l(s),x(()=>c=ve(s,c,{...r,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},void 0,!0)),d(m,s),se()}var va=Se('<svg><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"><path d="M4 19V6.2C4 5.0799 4 4.51984 4.21799 4.09202C4.40973 3.71569 4.71569 3.40973 5.09202 3.21799C5.51984 3 6.0799 3 7.2 3H16.8C17.9201 3 18.4802 3 18.908 3.21799C19.2843 3.40973 19.5903 3.71569 19.782 4.09202C20 4.51984 20 5.0799 20 6.2V17H6C4.89543 17 4 17.8954 4 19ZM4 19C4 20.1046 4.89543 21 6 21H20M9 7H15M9 11H15M19 17V21" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path></g></svg>');function da(m,o){oe(o,!0);let r=he(o,["$$slots","$$events","$$legacy"]),f=o.stroke;r={...r},r.stroke=void 0;var s=va();let c;var u=v(n(s),2),_=n(u);R(_,"stroke",f),l(u),l(s),x(()=>c=ve(s,c,{...r,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},void 0,!0)),d(m,s),se()}var ca=Se('<svg><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"><circle cx="12" cy="12" r="10" stroke-width="1.5"></circle><path d="M8.5 12.5L10.5 14.5L15.5 9.5" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path></g></svg>');function ga(m,o){oe(o,!0);let r=he(o,["$$slots","$$events","$$legacy"]),f=o.stroke;r={...r},r.stroke=void 0;var s=ca();let c;var u=v(n(s),2),_=n(u);R(_,"stroke",f);var M=v(_);R(M,"stroke",f),l(u),l(s),x(()=>c=ve(s,c,{...r,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},void 0,!0)),d(m,s),se()}var ua=Se('<svg><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"><path d="M12 7V12L14.5 10.5M21 12C21 16.9706 16.9706 21 12 21C7.02944 21 3 16.9706 3 12C3 7.02944 7.02944 3 12 3C16.9706 3 21 7.02944 21 12Z" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path></g></svg>');function _a(m,o){oe(o,!0);let r=he(o,["$$slots","$$events","$$legacy"]),f=o.stroke;r={...r},r.stroke=void 0;var s=ua();let c;var u=v(n(s),2),_=n(u);R(_,"stroke",f),l(u),l(s),x(()=>c=ve(s,c,{...r,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},void 0,!0)),d(m,s),se()}var fa=Se('<svg><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"><path d="M13 12H21M13 8H21M13 16H21M6 7V17M6 17L3 14M6 17L9 14" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path></g></svg>');function ma(m,o){oe(o,!0);let r=he(o,["$$slots","$$events","$$legacy"]),f=o.stroke;r={...r},r.stroke=void 0;var s=fa();let c;var u=v(n(s),2),_=n(u);R(_,"stroke",f),l(u),l(s),x(()=>c=ve(s,c,{...r,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},void 0,!0)),d(m,s),se()}var ha=C("<img>");function pa(m,o){oe(o,!0);let r=he(o,["$$slots","$$events","$$legacy","book"]),f;function s(){f.naturalWidth<10&&(f.src=o.book.backupCover)}var c=ha();let u;Qe(c,_=>f=_,()=>f),x(()=>u=ve(c,u,{...r,src:o.book.cover,onload:s})),Kt(c),Xt(c),d(m,c),se()}var ba=C('<div class="rating svelte-5hg3xl"><span> </span> <!> <span> </span></div>'),ka=C('<div class="book-info svelte-5hg3xl"><h1 class="svelte-5hg3xl"> </h1> <h2 class="svelte-5hg3xl"> </h2></div> <!> <!>',1);function ft(m,o){oe(o,!0);var r=V(),f=y(r);na(f,()=>o.onclick?"div":"a",!1,(s,c)=>{var u=()=>{var B;return(B=o.onclick)==null?void 0:B.call(o)};let _;x((B,I)=>{_=ve(s,_,{"data-rating":o.rating,id:"outer",href:`/book/${o.book.isbn??""}`,onclick:u},"svelte-5hg3xl",s.namespaceURI===mt,s.nodeName.includes("-")),p(s,"border-color",B),p(s,"background",I)},[()=>ye().textDark,()=>ye().background]);var M=ka(),w=y(M),Z=n(w),T=n(Z,!0);l(Z);var b=v(Z,2),z=n(b,!0);l(b),l(w);var j=v(w,2);{var je=B=>{var I=ba(),Y=n(I),He=n(Y);l(Y);var Re=v(Y,2);ta(Re,{get rating(){return o.rating},size:.6});var q=v(Re,2),ne=n(q);l(q),l(I),x((pe,Ne)=>{p(Y,"color",pe),G(He,`${o.user.displayName??""}'s rating:`),p(q,"color",pe),G(ne,`${Ne??""} / 10`)},[()=>ye().text,()=>o.rating===10?o.rating:o.rating.toFixed(1)]),d(B,I)};P(j,B=>{o.rating!==void 0&&B(je)})}var Ae=v(j,2);pa(Ae,{style:"height: 100%; aspect-ratio: 8 / 11;",get book(){return o.book}}),x((B,I,Y)=>{p(Z,"color",B),G(T,o.book.title),p(b,"color",I),G(z,Y)},[()=>ye().text,()=>ye().textDull,()=>o.book.authors.join(", ")]),d(c,M)}),d(m,r),se()}var wa=C('<div class="banner svelte-ga6amv"></div>'),ya=(m,o)=>o.show(),xa=C('<img class="profile-picture svelte-ga6amv">'),Ca=()=>Xe("/profile/edit"),Sa=C('<button class="edit-profile svelte-ga6amv">Edit Profile</button>'),Ra=C('<div class="profile-actions svelte-ga6amv"><button class="profile-action-follow svelte-ga6amv"><!></button></div>'),Ma=C('<p class="bio svelte-ga6amv"><!></p>'),Va=C('<a class="svelte-ga6amv"><!> <span class="truncate svelte-ga6amv"> </span></a>'),Ba=C('<a class="svelte-ga6amv"><!> <span class="truncate svelte-ga6amv"> </span></a>'),Fa=(m,o)=>re(o,"books"),La=C('<a class="svelte-ga6amv"><!> <span> </span></a>'),Ga=C("<span> </span>"),Ia=(m,o)=>e(o).open(m),Pa=C('<button class="svelte-ga6amv">Highest Rated</button> <button class="svelte-ga6amv">Recently Finished</button>',1),ja=C('<div class="ratings svelte-ga6amv"><div class="rating-options svelte-ga6amv"><span class="svelte-ga6amv"><label for="show-full-reviews" class="svelte-ga6amv">Show full reviews</label> <!></span> <span class="svelte-ga6amv"><label for="change-rating-sort" class="svelte-ga6amv"> </label> <button id="change-rating-sort" class="svelte-ga6amv"><!></button></span> <!></div> <!></div>'),Aa=C('<div class="ratings svelte-ga6amv"><!></div>'),Ha=C('<div class="loading svelte-ga6amv"><h1 class="svelte-ga6amv">Loading posts...</h1> <p class="svelte-ga6amv">We promise Wallflower will be faster soon.</p></div>'),Na=C('<section class="svelte-ga6amv"><!> <button class="back-arrow svelte-ga6amv"><!></button> <div class="profile svelte-ga6amv"><!> <div class="profile-line-1 svelte-ga6amv"><span class="name svelte-ga6amv"><h1 class="svelte-ga6amv"> </h1> <h2 class="svelte-ga6amv"> </h2> <!> <div class="dot svelte-ga6amv"></div> <h2 class="pronouns svelte-ga6amv"> </h2></span> <!></div> <!> <div class="profile-line-2 svelte-ga6amv"><span class="profile-books svelte-ga6amv"><!> <!></span> <!></div> <a class="follows svelte-ga6amv"><!> <span> </span></a> <div class="views svelte-ga6amv"><button class="svelte-ga6amv">All</button> <button class="svelte-ga6amv">Books</button> <button class="svelte-ga6amv">Activity</button> <button class="svelte-ga6amv">List</button> <button class="svelte-ga6amv">Discussion</button></div></div> <!></section>');function tr(m,o){oe(o,!0);let r=o.user,f=o.sidebar,s=me(xe(new URLSearchParams(window.location.search).get("view")??"all")),c=Ot(r),u=Promise.all(r.readingList.map(a=>dt(a))),_=Wt(r),M=Jt(r),w=U(()=>{var a;return((a=ie())==null?void 0:a.id)===r.id}),Z=r.currentBook?dt(r.currentBook):Promise.resolve(null),T=M.then(a=>a.filter(t=>t.type==="rating").length),b=me(!1),z=me(null),j=me("best"),je=U(()=>({best:"Highest Rated",recent:"Recently Finished"})[e(j)]),Ae=U(async()=>(e(j),M.then(a=>a.filter(t=>t.type==="rating").toSorted({best:(t,i)=>i.rating-t.rating,recent:(t,i)=>i.timestamp-t.timestamp}[e(j)]))));function B(a){return()=>{re(j,xe(a)),e(z).close()}}let I=me(null),Y=U(()=>{var a;return e(I)||(((a=ie())==null?void 0:a.following.some(t=>t===r.id))??!1)&&e(I)===null});function He(){re(I,!0),gt({following:[...new Set([...ie().following,r.id])]}),ut(r,{followers:[...new Set([...r.followers,ie().id])]})}function Re(){re(I,!1),gt({following:ie().following.filter(a=>a!==r.id)}),ut(r,{followers:r.followers.filter(a=>a!==ie().id)})}function q(a){return function(){Xe(`${window.location.origin}${window.location.pathname}?${new URLSearchParams({view:a})}`),re(s,xe(a))}}let ne=me(null);function pe(a){const t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(a);return{r:parseInt(t[1],16),g:parseInt(t[2],16),b:parseInt(t[3],16)}}function Ne(a,t,i){i=Math.min(Math.max(i,0),1);const k=pe(a),S=pe(t),h=g=>Math.round(k[g]*(1-i)+S[g]*i);return{r:h("r"),g:h("g"),b:h("b")}}$t(()=>{document.addEventListener("scroll",()=>{var a;if((a=e(z))==null||a.close(),e(ne)){const i=e(ne).getBoundingClientRect().top/100,{r:k,g:S,b:h}=Ne(_t("crust"),_t("base"),i);e(ne).style.background=`rgb(${k}, ${S}, ${h})`}},!0)});var Ee=Na(),Ye=n(Ee);J(Ye,()=>ct(r.banner),null,(a,t)=>{var i=wa();x(()=>p(i,"background-image",`url("${e(t)}")`)),d(a,i)});var Me=v(Ye,2);Me.__click=[ya,f];var ht=n(Me);ea(ht,{stroke:"#FFFFFF",style:"width: 1.5rem; height: 1.5rem;"}),l(Me);var Ue=v(Me,2),$e=n(Ue);J($e,()=>ct(r.picture),null,(a,t)=>{var i=xa();x(()=>{R(i,"src",e(t)),R(i,"alt",`${r.displayName} profile picture`)}),d(a,i)});var Te=v($e,2),ze=n(Te),De=n(ze),pt=n(De,!0);l(De);var Oe=v(De,2),bt=n(Oe);l(Oe);var et=v(Oe,2);aa(et,{forUser:r,size:1});var tt=v(et,4),kt=n(tt,!0);l(tt),l(ze);var wt=v(ze,2);{var yt=a=>{var t=Sa();t.__click=[Ca],d(a,t)},xt=a=>{var t=V(),i=y(t);{var k=S=>{var h=Ra(),g=n(h),F=n(g);{var A=D=>{ga(D,{stroke:"var(--overlay-1)",style:"width: 2rem;",onclick:Re})},H=D=>{ia(D,{stroke:"var(--overlay-1)",style:"width: 2rem;",onclick:He})};P(F,D=>{e(Y)?D(A):D(H,!1)})}l(g),l(h),d(S,h)};P(i,S=>{ie()&&S(k)},!0)}d(a,t)};P(wt,a=>{e(w)?a(yt):a(xt,!1)})}l(Te);var at=v(Te,2);J(at,()=>Zt(r.bio),null,(a,t)=>{var i=Ma(),k=n(i);qt(k,()=>e(t),!1,!1),l(i),d(a,i)});var We=v(at,2),Je=n(We),rt=n(Je);J(rt,()=>c,null,(a,t)=>{var i=V(),k=y(i);{var S=h=>{var g=Va(),F=n(g);ra(F,{stroke:"var(--overlay-1)",style:"width: 1rem; height: 1rem; flex-shrink: 0;"});var A=v(F,2),H=n(A,!0);l(A),l(g),x(()=>{R(g,"href",`/book/${e(t).isbn}`),R(g,"title",`${r.displayName}'s highest rated book is ${e(t).title}`),G(H,e(t).title)}),d(h,g)};P(k,h=>{e(t)&&h(S)})}d(a,i)});var Ct=v(rt,2);J(Ct,()=>Z,null,(a,t)=>{var i=V(),k=y(i);{var S=h=>{var g=Ba(),F=n(g);_a(F,{stroke:"var(--overlay-1)",style:"width: 1rem; height: 1rem; flex-shrink: 0;"});var A=v(F,2),H=n(A,!0);l(A),l(g),x(()=>{R(g,"href",`/book/${e(t).isbn??""}`),R(g,"title",`${r.displayName} is currently reading ${e(t).title}`),G(H,e(t).title)}),d(h,g)};P(k,h=>{e(t)&&h(S)})}d(a,i)}),l(Je);var St=v(Je,2);J(St,()=>T,null,(a,t)=>{var i=La();i.__click=[Fa,s];var k=n(i);da(k,{stroke:"var(--overlay-1)",style:"width: 1rem; height: 1rem;"});var S=v(k,2),h=n(S,!0);l(S),l(i),x(()=>{R(i,"href",`/profile/${r.username??""}?view=books`),R(i,"title",`${r.displayName??""} has read ${e(t)??""} book${(e(t)===1?"":"s")??""}`),G(h,e(t))}),d(a,i)}),l(We);var Ve=v(We,2),ot=n(Ve);J(ot,()=>_,null,(a,t)=>{var i=Ga(),k=n(i);l(i),x(()=>G(k,`${e(t).length??""} Followers`)),d(a,i)});var st=v(ot,2),Rt=n(st);l(st),l(Ve);var nt=v(Ve,2),Be=n(nt),Mt=U(()=>q("all"));Be.__click=function(...a){var t;(t=e(Mt))==null||t.apply(this,a)};var Fe=v(Be,2),Vt=U(()=>q("books"));Fe.__click=function(...a){var t;(t=e(Vt))==null||t.apply(this,a)};var Le=v(Fe,2),Bt=U(()=>q("activity"));Le.__click=function(...a){var t;(t=e(Bt))==null||t.apply(this,a)};var Ge=v(Le,2),Ft=U(()=>q("list"));Ge.__click=function(...a){var t;(t=e(Ft))==null||t.apply(this,a)};var Ze=v(Ge,2),Lt=U(()=>q("discussion"));Ze.__click=function(...a){var t;(t=e(Lt))==null||t.apply(this,a)},l(nt),l(Ue);var Gt=v(Ue,2);J(Gt,()=>M,a=>{var t=Ha();d(a,t)},(a,t)=>{var i=V(),k=y(i);{var S=g=>{var F=V(),A=y(F);Ce(A,17,()=>e(t).filter(H=>H.type==="general"),Ie,(H,D)=>{Pe(H,{get post(){return e(D)}})}),d(g,F)},h=g=>{var F=V(),A=y(F);{var H=de=>{var ce=ja(),ge=n(ce),ue=n(ge);p(ue,"color","var(--overlay-1)");var qe=v(n(ue),2);sa(qe,{id:"show-full-reviews",size:.5,get on(){return e(b)},set on(L){re(b,xe(L))}}),l(ue);var N=v(ue,2);p(N,"color","var(--overlay-1)");var K=n(N),be=n(K,!0);l(K);var Q=v(K,2);Q.__click=[Ia,z];var ke=n(Q);ma(ke,{stroke:"var(--overlay-1)",style:"width: 1.5rem; height: 1.5rem;"}),l(Q),l(N);var $=v(N,2);Qe(oa($,{children:(L,_e)=>{var E=Pa(),O=y(E),X=U(()=>B("best"));O.__click=function(...we){var le;(le=e(X))==null||le.apply(this,we)};var W=v(O,2),te=U(()=>B("recent"));W.__click=function(...we){var le;(le=e(te))==null||le.apply(this,we)},d(L,E)},$$slots:{default:!0}}),L=>re(z,xe(L)),()=>e(z)),l(ge),Qe(ge,L=>re(ne,L),()=>e(ne));var ee=v(ge,2);J(ee,()=>e(Ae),null,(L,_e)=>{var E=V(),O=y(E);Ce(O,17,()=>e(_e),X=>X.id,(X,W)=>{var te=V(),we=y(te);{var le=fe=>{Pe(fe,{get post(){return e(W)}})},It=fe=>{ft(fe,{get book(){return e(W).books[0]},get rating(){return e(W).rating},user:r,onclick:()=>Xe(`/post/${e(W).id}`)})};P(we,fe=>{e(b)?fe(le):fe(It,!1)})}d(X,te)}),d(L,E)}),l(ce),x(()=>G(be,e(je))),d(de,ce)},D=de=>{var ce=V(),ge=y(ce);{var ue=N=>{var K=V(),be=y(K);Ce(be,17,()=>e(t).filter(Q=>Q.type==="update"),Ie,(Q,ke)=>{Pe(Q,{get post(){return e(ke)}})}),d(N,K)},qe=N=>{var K=V(),be=y(K);{var Q=$=>{var ee=Aa(),L=n(ee);J(L,()=>u,null,(_e,E)=>{var O=V(),X=y(O);Ce(X,17,()=>e(E),Ie,(W,te)=>{ft(W,{get book(){return e(te)},user:r})}),d(_e,O)}),l(ee),d($,ee)},ke=$=>{var ee=V(),L=y(ee);{var _e=E=>{var O=V(),X=y(O);Ce(X,17,()=>e(t),Ie,(W,te)=>{Pe(W,{get post(){return e(te)}})}),d(E,O)};P(L,E=>{e(s)==="all"&&E(_e)},!0)}d($,ee)};P(be,$=>{e(s)==="list"?$(Q):$(ke,!1)},!0)}d(N,K)};P(ge,N=>{e(s)==="activity"?N(ue):N(qe,!1)},!0)}d(de,ce)};P(A,de=>{e(s)==="books"?de(H):de(D,!1)},!0)}d(g,F)};P(k,g=>{e(s)==="discussion"?g(S):g(h,!1)})}d(a,i)}),l(Ee),x(()=>{G(pt,r.displayName),G(bt,`@${r.username??""}`),G(kt,r.pronouns),R(Ve,"href",`/profile/${r.username}/follows`),G(Rt,`${r.following.length??""} Following`),p(Be,"color",e(s)==="all"?"var(--subtext-1)":"var(--overlay-1)"),p(Be,"border-bottom",e(s)==="all"?"3px solid var(--lavender)":"3px solid transparent"),p(Fe,"color",e(s)==="books"?"var(--subtext-1)":"var(--overlay-1)"),p(Fe,"border-bottom",e(s)==="books"?"3px solid var(--lavender)":"3px solid transparent"),p(Le,"color",e(s)==="activity"?"var(--subtext-1)":"var(--overlay-1)"),p(Le,"border-bottom",e(s)==="activity"?"3px solid var(--lavender)":"3px solid transparent"),p(Ge,"color",e(s)==="list"?"var(--subtext-1)":"var(--overlay-1)"),p(Ge,"border-bottom",e(s)==="list"?"3px solid var(--lavender)":"3px solid transparent"),p(Ze,"color",e(s)==="discussion"?"var(--subtext-1)":"var(--overlay-1)"),p(Ze,"border-bottom",e(s)==="discussion"?"3px solid var(--lavender)":"3px solid transparent")}),d(m,Ee),se()}Yt(["click"]);export{tr as P};
