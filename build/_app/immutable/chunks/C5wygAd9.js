import"./Bg9kRutz.js";import{m as ae,v as nt,z as Ke,w as At,a1 as Pt,B as Ht,Q as Nt,q as jt,y as lt,o as it,F as Et,aI as mt,C as Ut,A as zt,O as Tt,p as le,s as v,c as n,r as l,t as S,a as ie,f as y,a4 as fe,g as e,d as U,a5 as re}from"./BEuF9Aiu.js";import{s as G,b as vt}from"./CIMMqX_l.js";import{t as we,s as p,I as Ot,w as dt,z as Dt,J as Wt,a as Z,b as ct,H as Zt,u as ne,k as gt,K as ut}from"./CVc447rH.js";import{r as Ce,i as A,p as ye}from"./Dc0SBWOI.js";import{e as xe,i as Ie}from"./BLfhk5AQ.js";import{h as qt}from"./nSJZ-H2Q.js";import{b as Jt,a as d,n as Se,c as V,t as R}from"./DY2BR4sA.js";import{s as C,a as me}from"./5PfMkTiZ.js";import{o as Kt,d as Qt}from"./NdrWdQlm.js";import{o as Xt}from"./DXIKV8-l.js";import{g as Qe}from"./DU9UGetc.js";import{L as Yt}from"./BYlvyIoP.js";import{S as $t,B as ea,a as ta,A as Ae,C as aa}from"./BV3gILk7.js";import{B as ra}from"./CoIpPjfT.js";import{R as oa}from"./BANCdrcS.js";import{c as _t}from"./fbTVcXp3.js";function sa(f,s,r,k,o,m){let _=ae;ae&&nt();var g,M,w=null;ae&&Ke.nodeType===1&&(w=Ke,nt());var q=ae?Ke:f,z;At(()=>{const h=s()||null;var T=h==="svg"?mt:null;h!==g&&(z&&(h===null?Ut(z,()=>{z=null,M=null}):h===M?zt(z):Tt(z)),h&&h!==M&&(z=Ht(()=>{w=ae?w:T?document.createElementNS(T,h):document.createElement(h),Jt(w,w);{ae&&Kt(h)&&w.append(document.createComment(""));var P=ae?Nt(w):w.appendChild(jt());ae&&(P===null?lt(!1):it(P)),k(w,P)}Et.nodes_end=w,q.before(w)})),g=h,g&&(M=g))},Pt),_&&(lt(!0),it(q))}var na=Se('<svg><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"><circle cx="12" cy="12" r="10" stroke-width="1.5"></circle><path d="M15 12L12 12M12 12L9 12M12 12L12 9M12 12L12 15" stroke-width="1.5" stroke-linecap="round"></path></g></svg>');function la(f,s){le(s,!0);let r=Ce(s,["$$slots","$$events","$$legacy"]),k=s.stroke;r={...r},r.stroke=void 0;var o=na();let m;var _=v(n(o),2),g=n(_);C(g,"stroke",k);var M=v(g);C(M,"stroke",k),l(_),l(o),S(()=>m=me(o,m,{...r,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},void 0,!0)),d(f,o),ie()}var ia=Se('<svg><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"><path d="M4 19V6.2C4 5.0799 4 4.51984 4.21799 4.09202C4.40973 3.71569 4.71569 3.40973 5.09202 3.21799C5.51984 3 6.0799 3 7.2 3H16.8C17.9201 3 18.4802 3 18.908 3.21799C19.2843 3.40973 19.5903 3.71569 19.782 4.09202C20 4.51984 20 5.0799 20 6.2V17H6C4.89543 17 4 17.8954 4 19ZM4 19C4 20.1046 4.89543 21 6 21H20M9 7H15M9 11H15M19 17V21" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path></g></svg>');function va(f,s){le(s,!0);let r=Ce(s,["$$slots","$$events","$$legacy"]),k=s.stroke;r={...r},r.stroke=void 0;var o=ia();let m;var _=v(n(o),2),g=n(_);C(g,"stroke",k),l(_),l(o),S(()=>m=me(o,m,{...r,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},void 0,!0)),d(f,o),ie()}var da=Se('<svg><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"><circle cx="12" cy="12" r="10" stroke-width="1.5"></circle><path d="M8.5 12.5L10.5 14.5L15.5 9.5" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path></g></svg>');function ca(f,s){le(s,!0);let r=Ce(s,["$$slots","$$events","$$legacy"]),k=s.stroke;r={...r},r.stroke=void 0;var o=da();let m;var _=v(n(o),2),g=n(_);C(g,"stroke",k);var M=v(g);C(M,"stroke",k),l(_),l(o),S(()=>m=me(o,m,{...r,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},void 0,!0)),d(f,o),ie()}var ga=Se('<svg><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"><path d="M12 7V12L14.5 10.5M21 12C21 16.9706 16.9706 21 12 21C7.02944 21 3 16.9706 3 12C3 7.02944 7.02944 3 12 3C16.9706 3 21 7.02944 21 12Z" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path></g></svg>');function ua(f,s){le(s,!0);let r=Ce(s,["$$slots","$$events","$$legacy"]),k=s.stroke;r={...r},r.stroke=void 0;var o=ga();let m;var _=v(n(o),2),g=n(_);C(g,"stroke",k),l(_),l(o),S(()=>m=me(o,m,{...r,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},void 0,!0)),d(f,o),ie()}var _a=Se('<svg><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"><path d="M13 12H21M13 8H21M13 16H21M6 7V17M6 17L3 14M6 17L9 14" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path></g></svg>');function fa(f,s){le(s,!0);let r=Ce(s,["$$slots","$$events","$$legacy"]),k=s.stroke;r={...r},r.stroke=void 0;var o=_a();let m;var _=v(n(o),2),g=n(_);C(g,"stroke",k),l(_),l(o),S(()=>m=me(o,m,{...r,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},void 0,!0)),d(f,o),ie()}var ma=R('<div class="rating svelte-153hpy1"><span> </span> <!> <span> </span></div>'),pa=R('<div class="book-info svelte-153hpy1"><h1 class="svelte-153hpy1"> </h1> <h2 class="svelte-153hpy1"> </h2></div> <!> <!>',1);function ft(f,s){le(s,!0);var r=V(),k=y(r);sa(k,()=>s.onclick?"div":"a",!1,(o,m)=>{var _=()=>{var B;return(B=s.onclick)==null?void 0:B.call(s)};let g;S((B,I)=>{g=me(o,g,{"data-rating":s.rating,id:"outer",href:`/book/${s.book.isbn??""}`,onclick:_},"svelte-153hpy1",o.namespaceURI===mt,o.nodeName.includes("-")),p(o,"border-color",B),p(o,"background",I)},[()=>we().textDark,()=>we().background]);var M=pa(),w=y(M),q=n(w),z=n(q,!0);l(q);var h=v(q,2),T=n(h,!0);l(h),l(w);var P=v(w,2);{var Pe=B=>{var I=ma(),Y=n(I),Ne=n(Y);l(Y);var Re=v(Y,2);$t(Re,{get rating(){return s.rating},size:.6});var J=v(Re,2),oe=n(J);l(J),l(I),S((pe,je)=>{p(Y,"color",pe),G(Ne,`${s.user.displayName??""}'s rating:`),p(J,"color",pe),G(oe,`${je??""} / 10`)},[()=>we().text,()=>s.rating===10?s.rating:s.rating.toFixed(1)]),d(B,I)};A(P,B=>{s.rating!==void 0&&B(Pe)})}var He=v(P,2);ra(He,{style:"height: 100%; aspect-ratio: 8 / 11;",get book(){return s.book}}),S((B,I,Y)=>{p(q,"color",B),G(z,s.book.title),p(h,"color",I),G(T,Y)},[()=>we().text,()=>we().textDull,()=>s.book.authors.join(", ")]),d(m,M)}),d(f,r),ie()}var ha=R('<div class="banner svelte-ga6amv"></div>'),ba=(f,s)=>s.show(),ka=R('<img class="profile-picture svelte-ga6amv">'),wa=()=>Qe("/profile/edit"),ya=R('<button class="edit-profile svelte-ga6amv">Edit Profile</button>'),xa=R('<div class="profile-actions svelte-ga6amv"><button class="profile-action-follow svelte-ga6amv"><!></button></div>'),Ca=R('<p class="bio svelte-ga6amv"><!></p>'),Sa=R('<a class="svelte-ga6amv"><!> <span class="truncate svelte-ga6amv"> </span></a>'),Ra=R('<a class="svelte-ga6amv"><!> <span class="truncate svelte-ga6amv"> </span></a>'),Ma=(f,s)=>re(s,"books"),Va=R('<a class="svelte-ga6amv"><!> <span> </span></a>'),Ba=R("<span> </span>"),La=(f,s)=>e(s).open(f),Fa=R('<button class="svelte-ga6amv">Highest Rated</button> <button class="svelte-ga6amv">Recently Finished</button>',1),Ga=R('<div class="ratings svelte-ga6amv"><div class="rating-options svelte-ga6amv"><span class="svelte-ga6amv"><label for="show-full-reviews" class="svelte-ga6amv">Show full reviews</label> <!></span> <span class="svelte-ga6amv"><label for="change-rating-sort" class="svelte-ga6amv"> </label> <button id="change-rating-sort" class="svelte-ga6amv"><!></button></span> <!></div> <!></div>'),Ia=R('<div class="ratings svelte-ga6amv"><!></div>'),Aa=R('<div class="loading svelte-ga6amv"><h1 class="svelte-ga6amv">Loading posts...</h1> <p class="svelte-ga6amv">We promise Wallflower will be faster soon.</p></div>'),Pa=R('<section class="svelte-ga6amv"><!> <button class="back-arrow svelte-ga6amv"><!></button> <div class="profile svelte-ga6amv"><!> <div class="profile-line-1 svelte-ga6amv"><span class="name svelte-ga6amv"><h1 class="svelte-ga6amv"> </h1> <h2 class="svelte-ga6amv"> </h2> <!> <div class="dot svelte-ga6amv"></div> <h2 class="pronouns svelte-ga6amv"> </h2></span> <!></div> <!> <div class="profile-line-2 svelte-ga6amv"><span class="profile-books svelte-ga6amv"><!> <!></span> <!></div> <a class="follows svelte-ga6amv"><!> <span> </span></a> <div class="views svelte-ga6amv"><button class="svelte-ga6amv">All</button> <button class="svelte-ga6amv">Books</button> <button class="svelte-ga6amv">Activity</button> <button class="svelte-ga6amv">List</button> <button class="svelte-ga6amv">Discussion</button></div></div> <!></section>');function $a(f,s){le(s,!0);let r=s.user,k=s.sidebar,o=fe(ye(new URLSearchParams(window.location.search).get("view")??"all")),m=Ot(r),_=Promise.all(r.readingList.map(a=>dt(a))),g=Dt(r),M=Wt(r),w=U(()=>{var a;return((a=ne())==null?void 0:a.id)===r.id}),q=r.currentBook?dt(r.currentBook):Promise.resolve(null),z=M.then(a=>a.filter(t=>t.type==="rating").length),h=fe(!1),T=fe(null),P=fe("best"),Pe=U(()=>({best:"Highest Rated",recent:"Recently Finished"})[e(P)]),He=U(async()=>(e(P),M.then(a=>a.filter(t=>t.type==="rating").toSorted({best:(t,i)=>i.rating-t.rating,recent:(t,i)=>i.timestamp-t.timestamp}[e(P)]))));function B(a){return()=>{re(P,ye(a)),e(T).close()}}let I=fe(null),Y=U(()=>{var a;return e(I)||(((a=ne())==null?void 0:a.following.some(t=>t===r.id))??!1)&&e(I)===null});function Ne(){re(I,!0),gt({following:[...new Set([...ne().following,r.id])]}),ut(r,{followers:[...new Set([...r.followers,ne().id])]})}function Re(){re(I,!1),gt({following:ne().following.filter(a=>a!==r.id)}),ut(r,{followers:r.followers.filter(a=>a!==ne().id)})}function J(a){return function(){Qe(`${window.location.origin}${window.location.pathname}?${new URLSearchParams({view:a})}`),re(o,ye(a))}}let oe=fe(null);function pe(a){const t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(a);return{r:parseInt(t[1],16),g:parseInt(t[2],16),b:parseInt(t[3],16)}}function je(a,t,i){i=Math.min(Math.max(i,0),1);const b=pe(a),x=pe(t),u=c=>Math.round(b[c]*(1-i)+x[c]*i);return{r:u("r"),g:u("g"),b:u("b")}}Xt(()=>{document.addEventListener("scroll",()=>{var a;if((a=e(T))==null||a.close(),e(oe)){const i=e(oe).getBoundingClientRect().top/100,{r:b,g:x,b:u}=je(_t("crust"),_t("base"),i);e(oe).style.background=`rgb(${b}, ${x}, ${u})`}},!0)});var Ee=Pa(),Xe=n(Ee);Z(Xe,()=>ct(r.banner),null,(a,t)=>{var i=ha();S(()=>p(i,"background-image",`url("${e(t)}")`)),d(a,i)});var Me=v(Xe,2);Me.__click=[ba,k];var pt=n(Me);Yt(pt,{stroke:"#FFFFFF",style:"width: 1.5rem; height: 1.5rem;"}),l(Me);var Ue=v(Me,2),Ye=n(Ue);Z(Ye,()=>ct(r.picture),null,(a,t)=>{var i=ka();S(()=>{C(i,"src",e(t)),C(i,"alt",`${r.displayName} profile picture`)}),d(a,i)});var ze=v(Ye,2),Te=n(ze),Oe=n(Te),ht=n(Oe,!0);l(Oe);var De=v(Oe,2),bt=n(De);l(De);var $e=v(De,2);ea($e,{forUser:r,size:1});var et=v($e,4),kt=n(et,!0);l(et),l(Te);var wt=v(Te,2);{var yt=a=>{var t=ya();t.__click=[wa],d(a,t)},xt=a=>{var t=V(),i=y(t);{var b=x=>{var u=xa(),c=n(u),L=n(c);{var H=O=>{ca(O,{stroke:"var(--overlay-1)",style:"width: 2rem;",onclick:Re})},N=O=>{la(O,{stroke:"var(--overlay-1)",style:"width: 2rem;",onclick:Ne})};A(L,O=>{e(Y)?O(H):O(N,!1)})}l(c),l(u),d(x,u)};A(i,x=>{ne()&&x(b)},!0)}d(a,t)};A(wt,a=>{e(w)?a(yt):a(xt,!1)})}l(ze);var tt=v(ze,2);Z(tt,()=>Zt(r.bio),null,(a,t)=>{var i=Ca(),b=n(i);qt(b,()=>e(t),!1,!1),l(i),d(a,i)});var We=v(tt,2),Ze=n(We),at=n(Ze);Z(at,()=>m,null,(a,t)=>{var i=V(),b=y(i);{var x=u=>{var c=Sa(),L=n(c);ta(L,{stroke:"var(--overlay-1)",style:"width: 1rem; height: 1rem; flex-shrink: 0;"});var H=v(L,2),N=n(H,!0);l(H),l(c),S(()=>{C(c,"href",`/book/${e(t).isbn}`),C(c,"title",`${r.displayName}'s highest rated book is ${e(t).title}`),G(N,e(t).title)}),d(u,c)};A(b,u=>{e(t)&&u(x)})}d(a,i)});var Ct=v(at,2);Z(Ct,()=>q,null,(a,t)=>{var i=V(),b=y(i);{var x=u=>{var c=Ra(),L=n(c);ua(L,{stroke:"var(--overlay-1)",style:"width: 1rem; height: 1rem; flex-shrink: 0;"});var H=v(L,2),N=n(H,!0);l(H),l(c),S(()=>{C(c,"href",`/book/${e(t).isbn??""}`),C(c,"title",`${r.displayName} is currently reading ${e(t).title}`),G(N,e(t).title)}),d(u,c)};A(b,u=>{e(t)&&u(x)})}d(a,i)}),l(Ze);var St=v(Ze,2);Z(St,()=>z,null,(a,t)=>{var i=Va();i.__click=[Ma,o];var b=n(i);va(b,{stroke:"var(--overlay-1)",style:"width: 1rem; height: 1rem;"});var x=v(b,2),u=n(x,!0);l(x),l(i),S(()=>{C(i,"href",`/profile/${r.username??""}?view=books`),C(i,"title",`${r.displayName??""} has read ${e(t)??""} book${(e(t)===1?"":"s")??""}`),G(u,e(t))}),d(a,i)}),l(We);var Ve=v(We,2),rt=n(Ve);Z(rt,()=>g,null,(a,t)=>{var i=Ba(),b=n(i);l(i),S(()=>G(b,`${e(t).length??""} Followers`)),d(a,i)});var ot=v(rt,2),Rt=n(ot);l(ot),l(Ve);var st=v(Ve,2),Be=n(st),Mt=U(()=>J("all"));Be.__click=function(...a){var t;(t=e(Mt))==null||t.apply(this,a)};var Le=v(Be,2),Vt=U(()=>J("books"));Le.__click=function(...a){var t;(t=e(Vt))==null||t.apply(this,a)};var Fe=v(Le,2),Bt=U(()=>J("activity"));Fe.__click=function(...a){var t;(t=e(Bt))==null||t.apply(this,a)};var Ge=v(Fe,2),Lt=U(()=>J("list"));Ge.__click=function(...a){var t;(t=e(Lt))==null||t.apply(this,a)};var qe=v(Ge,2),Ft=U(()=>J("discussion"));qe.__click=function(...a){var t;(t=e(Ft))==null||t.apply(this,a)},l(st),l(Ue);var Gt=v(Ue,2);Z(Gt,()=>M,a=>{var t=Aa();d(a,t)},(a,t)=>{var i=V(),b=y(i);{var x=c=>{var L=V(),H=y(L);xe(H,17,()=>e(t).filter(N=>N.type==="general"),Ie,(N,O)=>{Ae(N,{get post(){return e(O)}})}),d(c,L)},u=c=>{var L=V(),H=y(L);{var N=ve=>{var de=Ga(),ce=n(de),ge=n(ce);p(ge,"color","var(--overlay-1)");var Je=v(n(ge),2);oa(Je,{id:"show-full-reviews",size:.5,get on(){return e(h)},set on(F){re(h,ye(F))}}),l(ge);var j=v(ge,2);p(j,"color","var(--overlay-1)");var K=n(j),he=n(K,!0);l(K);var Q=v(K,2);Q.__click=[La,T];var be=n(Q);fa(be,{stroke:"var(--overlay-1)",style:"width: 1.5rem; height: 1.5rem;"}),l(Q),l(j);var $=v(j,2);vt(aa($,{children:(F,ue)=>{var E=Fa(),D=y(E),X=U(()=>B("best"));D.__click=function(...ke){var se;(se=e(X))==null||se.apply(this,ke)};var W=v(D,2),te=U(()=>B("recent"));W.__click=function(...ke){var se;(se=e(te))==null||se.apply(this,ke)},d(F,E)},$$slots:{default:!0}}),F=>re(T,ye(F)),()=>e(T)),l(ce),vt(ce,F=>re(oe,F),()=>e(oe));var ee=v(ce,2);Z(ee,()=>e(He),null,(F,ue)=>{var E=V(),D=y(E);xe(D,17,()=>e(ue),X=>X.id,(X,W)=>{var te=V(),ke=y(te);{var se=_e=>{Ae(_e,{get post(){return e(W)}})},It=_e=>{ft(_e,{get book(){return e(W).books[0]},get rating(){return e(W).rating},user:r,onclick:()=>Qe(`/post/${e(W).id}`)})};A(ke,_e=>{e(h)?_e(se):_e(It,!1)})}d(X,te)}),d(F,E)}),l(de),S(()=>G(he,e(Pe))),d(ve,de)},O=ve=>{var de=V(),ce=y(de);{var ge=j=>{var K=V(),he=y(K);xe(he,17,()=>e(t).filter(Q=>Q.type==="update"),Ie,(Q,be)=>{Ae(Q,{get post(){return e(be)}})}),d(j,K)},Je=j=>{var K=V(),he=y(K);{var Q=$=>{var ee=Ia(),F=n(ee);Z(F,()=>_,null,(ue,E)=>{var D=V(),X=y(D);xe(X,17,()=>e(E),Ie,(W,te)=>{ft(W,{get book(){return e(te)},user:r})}),d(ue,D)}),l(ee),d($,ee)},be=$=>{var ee=V(),F=y(ee);{var ue=E=>{var D=V(),X=y(D);xe(X,17,()=>e(t),Ie,(W,te)=>{Ae(W,{get post(){return e(te)}})}),d(E,D)};A(F,E=>{e(o)==="all"&&E(ue)},!0)}d($,ee)};A(he,$=>{e(o)==="list"?$(Q):$(be,!1)},!0)}d(j,K)};A(ce,j=>{e(o)==="activity"?j(ge):j(Je,!1)},!0)}d(ve,de)};A(H,ve=>{e(o)==="books"?ve(N):ve(O,!1)},!0)}d(c,L)};A(b,c=>{e(o)==="discussion"?c(x):c(u,!1)})}d(a,i)}),l(Ee),S(()=>{G(ht,r.displayName),G(bt,`@${r.username??""}`),G(kt,r.pronouns),C(Ve,"href",`/profile/${r.username}/follows`),G(Rt,`${r.following.length??""} Following`),p(Be,"color",e(o)==="all"?"var(--subtext-1)":"var(--overlay-1)"),p(Be,"border-bottom",e(o)==="all"?"3px solid var(--lavender)":"3px solid transparent"),p(Le,"color",e(o)==="books"?"var(--subtext-1)":"var(--overlay-1)"),p(Le,"border-bottom",e(o)==="books"?"3px solid var(--lavender)":"3px solid transparent"),p(Fe,"color",e(o)==="activity"?"var(--subtext-1)":"var(--overlay-1)"),p(Fe,"border-bottom",e(o)==="activity"?"3px solid var(--lavender)":"3px solid transparent"),p(Ge,"color",e(o)==="list"?"var(--subtext-1)":"var(--overlay-1)"),p(Ge,"border-bottom",e(o)==="list"?"3px solid var(--lavender)":"3px solid transparent"),p(qe,"color",e(o)==="discussion"?"var(--subtext-1)":"var(--overlay-1)"),p(qe,"border-bottom",e(o)==="discussion"?"3px solid var(--lavender)":"3px solid transparent")}),d(f,Ee),ie()}Qt(["click"]);export{$a as P};
