import"./Bg9kRutz.js";import{p as It,aa as a,g as t,f as bt,s as i,j,r as tt,t as _t,a as wt,a9 as r,d as et}from"./DS4hZ2gQ.js";import{d as Mt}from"./v-gzyAfz.js";import{a as $t,t as yt}from"./BWjh48UC.js";import{r as Rt,s as Lt}from"./CEvXu-Yb.js";import{s as n,h as Ct}from"./DLcAAEJF.js";import{a as Bt}from"./CfxRyQs9.js";import{a as at,p as ct,r as Et}from"./DU6_0F4v.js";import{b as c}from"./DXvwv68a.js";import{o as Yt}from"./D9eG23ZG.js";async function Xt(P,l,f,u,x,$,T,Y,W,y){if(!t(l))return;const X=await f(t(l),parseInt(t(u)),parseInt(t(x)),parseInt(t($)),parseInt(t(T)));Y(await Ct(X)),W()(Y()),y()}function Ht(P,l){l()}var kt=yt('<input> <div class="preview svelte-ttdpte"><div class="image svelte-ttdpte"><img alt="User content" draggable="false" class="svelte-ttdpte"> <div class="overlay left svelte-ttdpte"></div> <div class="overlay right svelte-ttdpte"></div> <div class="overlay top svelte-ttdpte"></div> <div class="overlay bottom svelte-ttdpte"></div> <div class="cropper svelte-ttdpte"><div class="top left handle svelte-ttdpte"></div> <div class="top right handle svelte-ttdpte"></div> <div class="bottom left handle svelte-ttdpte"></div> <div class="bottom right handle svelte-ttdpte"></div></div></div> <button class="upload svelte-ttdpte">Done</button> <button class="choose-again svelte-ttdpte">Choose a different image</button> <button class="cancel svelte-ttdpte">Cancel</button></div>',1);function Kt(P,l){It(l,!0);let f=r(null),u,x,$;at(l,"aspectRatio",3,void 0);let T=at(l,"onupload",3,e=>{}),Y=at(l,"imageId",15,null),W=Et(l,["$$slots","$$events","$$legacy","aspectRatio","onupload","imageId"]),y=r(2);function X(){a(f,null),a(I,null),x.style.display="none"}function vt(){$.click()}let I=r(null);function ut(){var s;if(a(I,ct(((s=t(f))==null?void 0:s[0])??null)),!t(I))return;const e=new FileReader;e.onloadend=function(){x.style.display="flex",u.src=e.result,a(h,`${t(o).getBoundingClientRect().width}px`),a(w,`${t(o).getBoundingClientRect().height}px`)},t(I)?e.readAsDataURL(t(I)):u.src=""}function gt(e,s,V,C,B){return new Promise((Z,E)=>{const D=new Image;D.onload=()=>{const U=document.createElement("canvas");U.width=C,U.height=B,U.getContext("2d").drawImage(D,s,V,C,B,0,0,C,B),U.toBlob(mt=>{if(!mt)return E(new Error("Canvas is empty"));const xt=new File([mt],e.name,{type:e.type});Z(xt)},e.type)},D.onerror=E;const A=new FileReader;A.onload=function(){D.src=A.result},A.onerror=E,A.readAsDataURL(e)})}let H,b=r(!1),d=r(null),q=r("0px"),z=r("0px"),G,J,K,N,o=r(null),m=r("0px"),p=r("0px"),_=r("0px"),g=r("0px"),h=et(()=>t(o)?`${t(o).getBoundingClientRect().width-parseInt(t(p))-parseInt(t(g))}px`:"0px"),w=et(()=>t(o)?`${t(o).getBoundingClientRect().height-parseInt(t(m))-parseInt(t(_))}px`:"0px");Yt(()=>{H.addEventListener("wheel",e=>{a(y,ct(Math.min(Math.max(1,t(y)-e.deltaY/5),10)))},!0),u.addEventListener("mousedown",()=>{a(b,!0)}),H.addEventListener("mousedown",()=>{a(b,!0)}),G.addEventListener("mousedown",()=>{a(d,"top left")}),J.addEventListener("mousedown",()=>{a(d,"top right")}),K.addEventListener("mousedown",()=>{a(d,"bottom left")}),N.addEventListener("mousedown",()=>{a(d,"bottom right")}),document.addEventListener("mousemove",e=>{if(t(d)=="top left"){const s=Math.min(e.movementX,e.movementY);a(p,`${Math.max(0,parseInt(t(p))+s)}px`),a(m,`${Math.max(0,parseInt(t(m))+s)}px`)}else if(t(d)=="top right"){const s=Math.min(Math.abs(e.movementX),Math.abs(e.movementY));a(g,`${Math.max(0,parseInt(t(g))-s*Math.sign(e.movementX))}px`),a(m,`${Math.max(0,parseInt(t(m))+s*Math.sign(e.movementY))}px`)}else if(t(d)=="bottom left"){const s=Math.min(Math.abs(e.movementX),Math.abs(e.movementY));a(p,`${Math.max(0,parseInt(t(p))+s*Math.sign(e.movementX))}px`),a(_,`${Math.max(0,parseInt(t(_))-s*Math.sign(e.movementY))}px`)}else if(t(d)=="bottom right"){const s=Math.min(Math.abs(e.movementX),Math.abs(e.movementY));a(g,`${Math.max(0,parseInt(t(g))-s*Math.sign(e.movementX))}px`),a(_,`${Math.max(0,parseInt(t(_))-s*Math.sign(e.movementY))}px`)}else t(b)&&(a(q,`${parseInt(t(q))+e.movementX}px`),a(z,`${parseInt(t(z))+e.movementY}px`))},!0),document.addEventListener("mouseup",()=>{a(b,!1),a(d,null)})});const nt=et(()=>(t(p),t(o)?t(o).getBoundingClientRect().height:0));var st=kt(),R=bt(st);Rt(R);let ot;c(R,e=>$=e,()=>$);var O=i(R,2),k=j(O),M=j(k);c(M,e=>u=e,()=>u);var Q=i(M,2),S=i(Q,2),F=i(S,2),L=i(F,2),v=i(L,2),it=j(v);c(it,e=>G=e,()=>G);var rt=i(it,2);c(rt,e=>J=e,()=>J);var lt=i(rt,2);c(lt,e=>K=e,()=>K);var ht=i(lt,2);c(ht,e=>N=e,()=>N),tt(v),c(v,e=>H=e,()=>H),tt(k),c(k,e=>a(o,e),()=>t(o));var pt=i(k,2);pt.__click=[Xt,I,gt,p,m,h,w,Y,T,X];var dt=i(pt,2);dt.__click=vt;var ft=i(dt,2);ft.__click=[Ht,X],tt(O),c(O,e=>x=e,()=>x),_t((e,s,V,C,B,Z,E)=>{ot=Lt(R,ot,{...W,onchange:ut,type:"file"},"svelte-ttdpte"),n(M,"cursor",t(b)?"grabbing":"grab"),n(M,"scale",t(y)),n(M,"left",t(q)),n(M,"top",t(z)),n(Q,"width",`${e??""}px`),n(Q,"height",`${t(nt)??""}px`),n(S,"width",`${s??""}px`),n(S,"height",`${t(nt)??""}px`),n(F,"left",`${V??""}px`),n(F,"width",t(h)),n(F,"height",`${C??""}px`),n(L,"right",`${B??""}px`),n(L,"width",t(h)),n(L,"height",`${Z??""}px`),n(L,"top",`${E??""}px`),n(v,"width",t(h)),n(v,"height",t(w)),n(v,"top",t(m)),n(v,"left",t(p)),n(v,"cursor",t(b)?"grabbing":"grab")},[()=>{var e;return(((e=t(o))==null?void 0:e.getBoundingClientRect().width)??0)-parseInt(t(h))-parseInt(t(g))},()=>{var e;return(((e=t(o))==null?void 0:e.getBoundingClientRect().width)??0)-parseInt(t(h))-parseInt(t(p))},()=>parseInt(t(p)),()=>{var e;return(((e=t(o))==null?void 0:e.getBoundingClientRect().height)??0)-parseInt(t(w))-parseInt(t(_))},()=>parseInt(t(g)),()=>{var e;return(((e=t(o))==null?void 0:e.getBoundingClientRect().height)??0)-parseInt(t(w))-parseInt(t(m))},()=>parseInt(t(w))+parseInt(t(m))]),Bt(R,()=>t(f),e=>a(f,e)),$t(P,st),wt()}Mt(["click"]);export{Kt as I};
