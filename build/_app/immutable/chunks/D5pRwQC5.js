import"./Bg9kRutz.js";import{m as ae,v as st,z as Oe,w as Nt,_ as It,B as Ut,Q as At,q as Gt,y as nt,o as lt,F as Ht,aI as _t,C as Et,A as zt,O as Tt,p as he,s as d,c as i,r as v,t as P,a as ye,f as u,ab as be,g as e,a5 as ie,k as Z,aa as Dt}from"./pkGNK3NG.js";import{b as qt,a as l,n as Qe,c as k,t as m}from"./D66Go1WX.js";import{c as it,a as H,g as vt,P as Ot}from"./BgBOm0Eo.js";import{r as Je,i as V,s as A,b as dt,p as ct}from"./Bn2adsp5.js";import{p as pe}from"./CjTTMtIM.js";import{y as Wt,h as We,n as Zt,z as Qt,x as Jt,u as me,d as ft,m as Kt,k as Xt}from"./BDWQaBNk.js";import{N as Yt}from"./Bz9HOox4.js";import{e as je,i as Pe}from"./DfOdsPlP.js";import{h as $t}from"./D69UqS7S.js";import{s as E,a as Ne}from"./Ctg0qLZn.js";import{q as ea,d as ta}from"./Bh3Z7n3o.js";import{t as Ce,s as p}from"./DIVgqEhC.js";import{o as aa}from"./BSAyFCWD.js";import{g as Ze}from"./MFMTe_7B.js";import{L as ra}from"./Dhe3VNPN.js";import{S as oa,B as sa,a as na,A as Le,C as la}from"./Bs8-b7x1.js";import{B as ia}from"./oCoc8utF.js";import{R as va}from"./OibIxqag.js";function da(g,o,r,L,n,w){let h=ae;ae&&st();var x,F,b=null;ae&&Oe.nodeType===1&&(b=Oe,st());var z=ae?Oe:g,M;Nt(()=>{const _=o()||null;var G=_==="svg"?_t:null;_!==x&&(M&&(_===null?Et(M,()=>{M=null,F=null}):_===F?zt(M):Tt(M)),_&&_!==F&&(M=Ut(()=>{b=ae?b:G?document.createElementNS(G,_):document.createElement(_),qt(b,b);{ae&&ea(_)&&b.append(document.createComment(""));var N=ae?At(b):b.appendChild(Gt());ae&&(N===null?nt(!1):lt(N)),L(b,N)}Ht.nodes_end=b,z.before(b)})),x=_,x&&(F=x))},It),h&&(nt(!0),lt(z))}var ca=Qe('<svg><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"><path d="M4 19V6.2C4 5.0799 4 4.51984 4.21799 4.09202C4.40973 3.71569 4.71569 3.40973 5.09202 3.21799C5.51984 3 6.0799 3 7.2 3H16.8C17.9201 3 18.4802 3 18.908 3.21799C19.2843 3.40973 19.5903 3.71569 19.782 4.09202C20 4.51984 20 5.0799 20 6.2V17H6C4.89543 17 4 17.8954 4 19ZM4 19C4 20.1046 4.89543 21 6 21H20M9 7H15M9 11H15M19 17V21" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path></g></svg>');function ua(g,o){he(o,!0);let r=Je(o,["$$slots","$$events","$$legacy"]),L=o.stroke;r={...r},r.stroke=void 0;var n=ca();let w;var h=d(i(n),2),x=i(h);E(x,"stroke",L),v(h),v(n),P(()=>w=Ne(n,w,{...r,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},void 0,!0)),l(g,n),ye()}var _a=Qe('<svg><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"><path d="M12 7V12L14.5 10.5M21 12C21 16.9706 16.9706 21 12 21C7.02944 21 3 16.9706 3 12C3 7.02944 7.02944 3 12 3C16.9706 3 21 7.02944 21 12Z" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path></g></svg>');function fa(g,o){he(o,!0);let r=Je(o,["$$slots","$$events","$$legacy"]),L=o.stroke;r={...r},r.stroke=void 0;var n=_a();let w;var h=d(i(n),2),x=i(h);E(x,"stroke",L),v(h),v(n),P(()=>w=Ne(n,w,{...r,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},void 0,!0)),l(g,n),ye()}var ga=Qe('<svg><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"><path d="M13 12H21M13 8H21M13 16H21M6 7V17M6 17L3 14M6 17L9 14" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path></g></svg>');function ba(g,o){he(o,!0);let r=Je(o,["$$slots","$$events","$$legacy"]),L=o.stroke;r={...r},r.stroke=void 0;var n=ga();let w;var h=d(i(n),2),x=i(h);E(x,"stroke",L),v(h),v(n),P(()=>w=Ne(n,w,{...r,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},void 0,!0)),l(g,n),ye()}var pa=m('<div class="rating svelte-153hpy1"><span> </span> <!> <span> </span></div>'),ma=m('<div class="book-info svelte-153hpy1"><h1 class="svelte-153hpy1"> </h1> <h2 class="svelte-153hpy1"> </h2></div> <!> <!>',1);function ut(g,o){he(o,!0);var r=k(),L=u(r);da(L,()=>o.onclick?"div":"a",!1,(n,w)=>{var h=()=>{var j;return(j=o.onclick)==null?void 0:j.call(o)};let x;P((j,S)=>{x=Ne(n,x,{"data-rating":o.rating,id:"outer",href:`/book/${o.book.isbn??""}`,onclick:h},"svelte-153hpy1",n.namespaceURI===_t,n.nodeName.includes("-")),p(n,"border-color",j),p(n,"background",S)},[()=>Ce().textDark,()=>Ce().background]);var F=ma(),b=u(F),z=i(b),M=i(z,!0);v(z);var _=d(z,2),G=i(_,!0);v(_),v(b);var N=d(b,2);{var re=j=>{var S=pa(),B=i(S),Y=i(B);v(B);var oe=d(B,2);oa(oe,{get rating(){return o.rating},size:.6});var se=d(oe,2),Re=i(se);v(se),v(S),P((ne,Ie)=>{p(B,"color",ne),A(Y,`${o.user.displayName??""}'s rating:`),p(se,"color",ne),A(Re,`${Ie??""} / 10`)},[()=>Ce().text,()=>o.rating===10?o.rating:o.rating.toFixed(1)]),l(j,S)};V(N,j=>{o.rating!==void 0&&j(re)})}var ve=d(N,2);ia(ve,{style:"height: 100%; aspect-ratio: 8 / 11;",get book(){return o.book}}),P((j,S,B)=>{p(z,"color",j),A(M,o.book.title),p(_,"color",S),A(G,B)},[()=>Ce().text,()=>Ce().textDull,()=>o.book.authors.join(", ")]),l(w,F)}),l(g,r),ye()}function ha(g,o){ft({following:[...new Set([...me().following,o.id])]})}function ya(g,o){ft({following:me().following.filter(r=>r!==o.id)})}var ka=m('<div class="banner svelte-y7btj2"></div>'),wa=(g,o)=>o.show(),xa=m('<img class="profile-picture svelte-y7btj2">'),ja=()=>Ze("/profile/edit"),Ca=m('<button class="edit button svelte-y7btj2">Edit Profile</button>'),Ra=m('<button class="unfollow button svelte-y7btj2">Unfollow</button>'),Sa=m('<button class="follow button svelte-y7btj2">Follow</button>'),Fa=m('<p class="bio svelte-y7btj2"><!></p>'),Ma=m('<a class="svelte-y7btj2"><!> <span class="truncate svelte-y7btj2"> </span></a>'),Ba=m('<a class="svelte-y7btj2"><!> <span class="truncate svelte-y7btj2"> </span></a>'),Va=(g,o)=>ie(o,"books"),Pa=m('<a class="svelte-y7btj2"><!> <span> </span></a>'),La=m("<span> </span>"),Na=(g,o)=>e(o).open(g),Ia=m('<button class="svelte-y7btj2">Highest Rated</button> <button class="svelte-y7btj2">Recently Finished</button>',1),Ua=m('<div class="ratings svelte-y7btj2"><div class="rating-options svelte-y7btj2"><span class="svelte-y7btj2"><label for="show-full-reviews" class="svelte-y7btj2">Show full reviews</label> <!></span> <span class="svelte-y7btj2"><label for="change-rating-sort" class="svelte-y7btj2"> </label> <button id="change-rating-sort" class="svelte-y7btj2"><!></button></span> <!></div> <!></div>'),Aa=m('<div class="ratings svelte-y7btj2"><!></div>'),Ga=m('<div class="loading svelte-y7btj2"><h1 class="svelte-y7btj2">Loading posts...</h1> <p class="svelte-y7btj2">We promise Wallflower will be faster soon.</p></div>'),Ha=m('<section class="svelte-y7btj2"><!> <button class="back-arrow svelte-y7btj2"><!></button> <div class="profile svelte-y7btj2"><!> <div class="profile-line-1 svelte-y7btj2"><span class="name svelte-y7btj2"><h1 class="svelte-y7btj2"> </h1> <h2 class="svelte-y7btj2"> </h2> <!> <div class="dot svelte-y7btj2"></div> <h2 class="pronouns svelte-y7btj2"> </h2></span> <!></div> <!> <div class="profile-line-2 svelte-y7btj2"><span class="profile-books svelte-y7btj2"><!> <!></span> <!></div> <a class="follows svelte-y7btj2"><!> <span> </span></a> <div class="views svelte-y7btj2"><button class="svelte-y7btj2">All</button> <button class="svelte-y7btj2">Books</button> <button class="svelte-y7btj2">Activity</button> <button class="svelte-y7btj2">List</button> <button class="svelte-y7btj2">Discussion</button></div></div> <!></section>');function Ea(g,o){he(o,!0);let r=o.user,L=o.sidebar,n=be(pe(new URLSearchParams(window.location.search).get("view")??"all")),w=Wt(r),h=Promise.all(r.readingList.map(a=>We(a))),x=Zt(r),F=Qt(r),b=Z(()=>{var a;return((a=me())==null?void 0:a.id)===r.id}),z=r.currentBook?We(r.currentBook):Promise.resolve(null),M=F.then(a=>a.filter(t=>t.type==="rating").length),_=be(!1),G=be(null),N=be("best"),re=Z(()=>({best:"Highest Rated",recent:"Recently Finished"})[e(N)]),ve=Z(async()=>(e(N),F.then(a=>a.filter(t=>t.type==="rating").toSorted({best:(t,s)=>s.rating-t.rating,recent:(t,s)=>s.timestamp-t.timestamp}[e(N)]))));function j(a){return()=>{ie(N,pe(a)),e(G).close()}}function S(a){return function(){Ze(`${window.location.origin}${window.location.pathname}?${new URLSearchParams({view:a})}`),ie(n,pe(a))}}let B=be(null);function Y(a){const t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(a);return{r:parseInt(t[1],16),g:parseInt(t[2],16),b:parseInt(t[3],16)}}function oe(a,t,s){s=Math.min(Math.max(s,0),1);const y=Y(a),C=Y(t),f=c=>Math.round(y[c]*(1-s)+C[c]*s);return{r:f("r"),g:f("g"),b:f("b")}}aa(()=>{document.addEventListener("scroll",()=>{var a;if((a=e(G))==null||a.close(),e(B)){const s=e(B).getBoundingClientRect().top/100,{r:y,g:C,b:f}=oe(it("crust"),it("base"),s);e(B).style.background=`rgb(${y}, ${C}, ${f})`}},!0)});var se=Ha(),Re=i(se);H(Re,()=>vt(r.banner),null,(a,t)=>{var s=ka();P(()=>p(s,"background-image",`url("${e(t)}")`)),l(a,s)});var ne=d(Re,2);ne.__click=[wa,L];var Ie=i(ne);ra(Ie,{stroke:"#FFFFFF",style:"width: 1.5rem; height: 1.5rem;"}),v(ne);var Ue=d(ne,2),Ke=i(Ue);H(Ke,()=>vt(r.picture),null,(a,t)=>{var s=xa();P(()=>{E(s,"src",e(t)),E(s,"alt",`${r.displayName} profile picture`)}),l(a,s)});var Ae=d(Ke,2),Ge=i(Ae),He=i(Ge),gt=i(He,!0);v(He);var Ee=d(He,2),bt=i(Ee);v(Ee);var Xe=d(Ee,2);sa(Xe,{forUser:r,size:1});var Ye=d(Xe,4),pt=i(Ye,!0);v(Ye),v(Ge);var mt=d(Ge,2);{var ht=a=>{var t=Ca();t.__click=[ja],l(a,t)},yt=a=>{var t=k(),s=u(t);{var y=C=>{var f=k(),c=u(f);{var I=R=>{var Q=Ra();Q.__click=[ya,r],l(R,Q)},T=R=>{var Q=Sa();Q.__click=[ha,r],l(R,Q)};V(c,R=>{me().following.includes(r.id)?R(I):R(T,!1)})}l(C,f)};V(s,C=>{me()&&C(y)},!0)}l(a,t)};V(mt,a=>{e(b)?a(ht):a(yt,!1)})}v(Ae);var $e=d(Ae,2);H($e,()=>Jt(r.bio),null,(a,t)=>{var s=Fa(),y=i(s);$t(y,()=>e(t),!1,!1),v(s),l(a,s)});var ze=d($e,2),Te=i(ze),et=i(Te);H(et,()=>w,null,(a,t)=>{var s=k(),y=u(s);{var C=f=>{var c=Ma(),I=i(c);na(I,{stroke:"var(--overlay-1)",style:"width: 1rem; height: 1rem; flex-shrink: 0;"});var T=d(I,2),R=i(T,!0);v(T),v(c),P(()=>{E(c,"href",`/book/${e(t).isbn}`),E(c,"title",`${r.displayName}'s highest rated book is ${e(t).title}`),A(R,e(t).title)}),l(f,c)};V(y,f=>{e(t)&&f(C)})}l(a,s)});var kt=d(et,2);H(kt,()=>z,null,(a,t)=>{var s=k(),y=u(s);{var C=f=>{var c=Ba(),I=i(c);fa(I,{stroke:"var(--overlay-1)",style:"width: 1rem; height: 1rem; flex-shrink: 0;"});var T=d(I,2),R=i(T,!0);v(T),v(c),P(()=>{E(c,"href",`/book/${e(t).isbn??""}`),E(c,"title",`${r.displayName} is currently reading ${e(t).title}`),A(R,e(t).title)}),l(f,c)};V(y,f=>{e(t)&&f(C)})}l(a,s)}),v(Te);var wt=d(Te,2);H(wt,()=>M,null,(a,t)=>{var s=Pa();s.__click=[Va,n];var y=i(s);ua(y,{stroke:"var(--overlay-1)",style:"width: 1rem; height: 1rem;"});var C=d(y,2),f=i(C,!0);v(C),v(s),P(()=>{E(s,"href",`/profile/${r.username??""}?view=books`),E(s,"title",`${r.displayName??""} has read ${e(t)??""} book${(e(t)===1?"":"s")??""}`),A(f,e(t))}),l(a,s)}),v(ze);var Se=d(ze,2),tt=i(Se);H(tt,()=>x,null,(a,t)=>{var s=La(),y=i(s);v(s),P(()=>A(y,`${e(t).length??""} Followers`)),l(a,s)});var at=d(tt,2),xt=i(at);v(at),v(Se);var rt=d(Se,2),Fe=i(rt),jt=Z(()=>S("all"));Fe.__click=function(...a){var t;(t=e(jt))==null||t.apply(this,a)};var Me=d(Fe,2),Ct=Z(()=>S("books"));Me.__click=function(...a){var t;(t=e(Ct))==null||t.apply(this,a)};var Be=d(Me,2),Rt=Z(()=>S("activity"));Be.__click=function(...a){var t;(t=e(Rt))==null||t.apply(this,a)};var Ve=d(Be,2),St=Z(()=>S("list"));Ve.__click=function(...a){var t;(t=e(St))==null||t.apply(this,a)};var De=d(Ve,2),Ft=Z(()=>S("discussion"));De.__click=function(...a){var t;(t=e(Ft))==null||t.apply(this,a)},v(rt),v(Ue);var Mt=d(Ue,2);H(Mt,()=>F,a=>{var t=Ga();l(a,t)},(a,t)=>{var s=k(),y=u(s);{var C=c=>{var I=k(),T=u(I);je(T,17,()=>e(t).filter(R=>R.type==="general"),Pe,(R,Q)=>{Le(R,{get post(){return e(Q)}})}),l(c,I)},f=c=>{var I=k(),T=u(I);{var R=de=>{var ce=Ua(),ue=i(ce),_e=i(ue);p(_e,"color","var(--overlay-1)");var qe=d(i(_e),2);va(qe,{id:"show-full-reviews",size:.5,get on(){return e(_)},set on(U){ie(_,pe(U))}}),v(_e);var D=d(_e,2);p(D,"color","var(--overlay-1)");var J=i(D),ke=i(J,!0);v(J);var K=d(J,2);K.__click=[Na,G];var we=i(K);ba(we,{stroke:"var(--overlay-1)",style:"width: 1.5rem; height: 1.5rem;"}),v(K),v(D);var $=d(D,2);dt(la($,{children:(U,fe)=>{var q=Ia(),O=u(q),X=Z(()=>j("best"));O.__click=function(...xe){var le;(le=e(X))==null||le.apply(this,xe)};var W=d(O,2),te=Z(()=>j("recent"));W.__click=function(...xe){var le;(le=e(te))==null||le.apply(this,xe)},l(U,q)},$$slots:{default:!0}}),U=>ie(G,pe(U)),()=>e(G)),v(ue),dt(ue,U=>ie(B,U),()=>e(B));var ee=d(ue,2);H(ee,()=>e(ve),null,(U,fe)=>{var q=k(),O=u(q);je(O,17,()=>e(fe),X=>X.id,(X,W)=>{var te=k(),xe=u(te);{var le=ge=>{Le(ge,{get post(){return e(W)}})},Bt=ge=>{var ot=k(),Vt=u(ot);H(Vt,()=>We(e(W).books[0]),null,(Pt,Lt)=>{ut(Pt,{get book(){return e(Lt)},get rating(){return e(W).rating},user:r,onclick:()=>Ze(`/post/${e(W).id}`)})}),l(ge,ot)};V(xe,ge=>{e(_)?ge(le):ge(Bt,!1)})}l(X,te)}),l(U,q)}),v(ce),P(()=>A(ke,e(re))),l(de,ce)},Q=de=>{var ce=k(),ue=u(ce);{var _e=D=>{var J=k(),ke=u(J);je(ke,17,()=>e(t).filter(K=>K.type==="update"),Pe,(K,we)=>{Le(K,{get post(){return e(we)}})}),l(D,J)},qe=D=>{var J=k(),ke=u(J);{var K=$=>{var ee=Aa(),U=i(ee);H(U,()=>h,null,(fe,q)=>{var O=k(),X=u(O);je(X,17,()=>e(q),Pe,(W,te)=>{ut(W,{get book(){return e(te)},user:r})}),l(fe,O)}),v(ee),l($,ee)},we=$=>{var ee=k(),U=u(ee);{var fe=q=>{var O=k(),X=u(O);je(X,17,()=>e(t),Pe,(W,te)=>{Le(W,{get post(){return e(te)}})}),l(q,O)};V(U,q=>{e(n)==="all"&&q(fe)},!0)}l($,ee)};V(ke,$=>{e(n)==="list"?$(K):$(we,!1)},!0)}l(D,J)};V(ue,D=>{e(n)==="activity"?D(_e):D(qe,!1)},!0)}l(de,ce)};V(T,de=>{e(n)==="books"?de(R):de(Q,!1)},!0)}l(c,I)};V(y,c=>{e(n)==="discussion"?c(C):c(f,!1)})}l(a,s)}),v(se),P(()=>{A(gt,r.displayName),A(bt,`@${r.username??""}`),A(pt,r.pronouns),E(Se,"href",`/profile/${r.username}/follows`),A(xt,`${r.following.length??""} Following`),p(Fe,"color",e(n)==="all"?"var(--subtext-1)":"var(--overlay-1)"),p(Fe,"border-bottom",e(n)==="all"?"3px solid var(--lavender)":"3px solid transparent"),p(Me,"color",e(n)==="books"?"var(--subtext-1)":"var(--overlay-1)"),p(Me,"border-bottom",e(n)==="books"?"3px solid var(--lavender)":"3px solid transparent"),p(Be,"color",e(n)==="activity"?"var(--subtext-1)":"var(--overlay-1)"),p(Be,"border-bottom",e(n)==="activity"?"3px solid var(--lavender)":"3px solid transparent"),p(Ve,"color",e(n)==="list"?"var(--subtext-1)":"var(--overlay-1)"),p(Ve,"border-bottom",e(n)==="list"?"3px solid var(--lavender)":"3px solid transparent"),p(De,"color",e(n)==="discussion"?"var(--subtext-1)":"var(--overlay-1)"),p(De,"border-bottom",e(n)==="discussion"?"3px solid var(--lavender)":"3px solid transparent")}),l(g,se),ye()}ta(["click"]);var za=m("<!> <!>",1),Ta=m('<!> <div class="svelte-uf21oc"></div>',1);function ir(g,o){he(o,!0);let r=ct(o,"userid",3,void 0),L=ct(o,"username",3,void 0),n=r()?Kt(r()):Xt(L()),w=be(null);Ot(g,{type:"profile",get sidebar(){return e(w)},set sidebar(h){ie(w,pe(h))},children:(h,x)=>{var F=Ta(),b=u(F);H(b,()=>n,null,(z,M)=>{var _=k(),G=u(_);{var N=re=>{var ve=za(),j=u(ve);Ea(j,{get sidebar(){return e(w)},get user(){return e(M)}});var S=d(j,2);{var B=Y=>{Yt(Y,{})};V(S,Y=>{var oe;e(M).id===((oe=me())==null?void 0:oe.id)&&Y(B)})}l(re,ve)};V(G,re=>{e(M)&&re(N)})}l(z,_)}),Dt(2),l(h,F)},$$slots:{default:!0}}),ye()}export{ir as P};
