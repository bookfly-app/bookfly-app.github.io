import{w as ft,x as vt,t as f,u as L,s as v,c as _t,a as ut,f as Y}from"../chunks/BgaTf3pO.js";import{a as b,t as P,c as C}from"../chunks/gFbpwaTI.js";import{V as gt,ag as mt,aj as kt,p as bt,u as pt,f as D,t as U,a as ht,ab as Z,aa as jt,s as _,j as p,g as h,r as j,d as xt}from"../chunks/DBPlaF8E.js";import{s as V}from"../chunks/Chu0jhlY.js";import{i as J}from"../chunks/BW7aK-Zr.js";import{e as Lt,i as St}from"../chunks/HJfK_IHA.js";import{a as X}from"../chunks/CitSOB86.js";import{d as wt}from"../chunks/CThlKSBW.js";import{b as yt}from"../chunks/CVPpxQ3u.js";import{S as At,F as Bt}from"../chunks/BMyVZsPx.js";import{B as Dt}from"../chunks/BV7adXHU.js";import{P as Rt,S as Ot}from"../chunks/CQaUlW_D.js";import{A as Pt}from"../chunks/DT5qcLCO.js";const Mt=[];function Tt(t,e=!1){return N(t,new Map,"",Mt)}function N(t,e,r,a,w=null){if(typeof t=="object"&&t!==null){var y=e.get(t);if(y!==void 0)return y;if(t instanceof Map)return new Map(t);if(t instanceof Set)return new Set(t);if(gt(t)){var l=Array(t.length);e.set(t,l),w!==null&&e.set(w,l);for(var S=0;S<t.length;S+=1){var M=t[S];S in t&&(l[S]=N(M,e,r,a))}return l}if(mt(t)===kt){l={},e.set(t,l),w!==null&&e.set(w,l);for(var R in t)l[R]=N(t[R],e,r,a);return l}if(t instanceof Date)return structuredClone(t);if(typeof t.toJSON=="function")return N(t.toJSON(),e,r,a,t)}if(t instanceof EventTarget)return t;try{return structuredClone(t)}catch{return t}}const Ft=async({params:t})=>({book:await ft(t.slug)}),ae=Object.freeze(Object.defineProperty({__proto__:null,load:Ft},Symbol.toStringTag,{value:"Module"}));async function It(t,e){var a;const r=L().readingList;Y({readingList:[...r,e.isbn]}),(a=L())==null||a.readingList.push(e.isbn)}async function Ct(t,e){const r=L().readingList.filter(a=>a!==e.isbn);Y({readingList:r}),L().readingList=r}var Jt=(t,e)=>Z(e,"info"),Nt=(t,e)=>Z(e,"discussion"),$t=P('<div class="book-info svelte-kn64jk"><img class="cover svelte-kn64jk"> <p class="description svelte-kn64jk"> </p></div>'),zt=P('<button id="add-to-reading-list" class="remove-from-reading-list svelte-kn64jk">Remove from Reading List</button>'),Et=P('<button id="add-to-reading-list" class="svelte-kn64jk">Add to Reading List</button>'),Gt=P('<nav class="svelte-kn64jk"><div class="banner svelte-kn64jk"><button aria-label="Open sidebar" class="svelte-kn64jk"></button> <div class="book-name svelte-kn64jk"><h1 class="svelte-kn64jk"> </h1> <h2 class="svelte-kn64jk"> </h2></div> <!></div></nav> <section class="svelte-kn64jk"><div class="views svelte-kn64jk"><button class="svelte-kn64jk">Info</button> <button class="svelte-kn64jk">Discussion</button></div> <!> <!></section> <!> <!>',1),Ut=P("<!> <!>",1);function ne(t,e){bt(e,!0);let r=e.data.book,a=jt("info"),w=vt(r.isbn),y,l=xt(()=>{var n;return((n=L())==null?void 0:n.readingList.includes(r.isbn))??!1});pt(()=>{var n;console.log(Tt((n=L())==null?void 0:n.readingList))});function S(n,H=3){n=n.replaceAll("--","â€”"),n=n.replaceAll(/\.(\S)/g,(o,u)=>`. ${u}`);let A=n.split(/([.!?])\s*/),x=[];for(let o=0;o<A.length;o+=2)x.push(A[o]+A[o+1]);let B=x.map((o,u)=>(u+1)%H===0&&u!==x.length-1?o+`

`:o).join("");return B=B.replaceAll(/\.(\S)/g,(o,u)=>`. ${u}`),B}var M=Ut(),R=D(M);Dt(R);var q=_(R,2);Rt(q,{style:"overflow-y: hidden;",children:(n,H)=>{var A=Gt(),x=D(A),B=p(x),o=p(B);o.__click=()=>y.show();var u=_(o,2),T=p(u),tt=p(T,!0);j(T);var $=_(T,2),et=p($,!0);j($),j(u);var rt=_(u,2);At(rt,{style:"width: 2rem; height: 2rem;",get stroke(){return f().textBright}}),j(B),j(x);var z=_(x,2),F=p(z),I=p(F);I.__click=[Jt,a];var E=_(I,2);E.__click=[Nt,a],j(F);var K=_(F,2);{var st=s=>{var d=$t(),g=p(d),m=_(g,2),k=p(m,!0);j(m),j(d),U((i,c)=>{X(g,"alt",`${r.title} cover`),X(g,"src",r.cover),v(m,"color",i),V(k,c)},[()=>f().textDull,()=>S(r.description)]),b(s,d)},at=s=>{var d=C(),g=D(d);{var m=k=>{var i=C(),c=D(i);_t(c,()=>w,null,(O,G)=>{var W=C(),ct=D(W);Lt(ct,17,()=>h(G),St,(lt,dt)=>{Pt(lt,{get post(){return h(dt)}})}),b(O,W)}),b(k,i)};J(g,k=>{h(a)==="discussion"&&k(m)},!0)}b(s,d)};J(K,s=>{h(a)==="info"?s(st):s(at,!1)})}var nt=_(K,2);{var ot=s=>{var d=C(),g=D(d);{var m=i=>{var c=zt();c.__click=[Ct,r],b(i,c)},k=i=>{var c=Et();c.__click=[It,r],U(O=>v(c,"background",O),[ut]),b(i,c)};J(g,i=>{h(l)?i(m):i(k,!1)})}b(s,d)};J(nt,s=>{L()&&s(ot)})}j(z);var Q=_(z,2);Bt(Q,{selected:"search"});var it=_(Q,2);yt(Ot(it,{}),s=>y=s,()=>y),U((s,d,g,m,k,i,c,O,G)=>{v(x,"background",s),v(o,"background-image",d),v(T,"color",g),V(tt,r.title),v($,"color",m),V(et,k),v(F,"background-color",s),v(I,"color",i),v(I,"border-bottom-color",c),v(E,"color",O),v(E,"border-bottom-color",G)},[()=>f().backgroundDark,()=>{var s;return`url("${((s=L())==null?void 0:s.picture)??""}")`},()=>f().textBright,()=>f().textDim,()=>r.authors.join(", "),()=>h(a)==="info"?f().textBright:f().textDull,()=>h(a)==="info"?f().accent:"transparent",()=>h(a)==="discussion"?f().textBright:f().textDull,()=>h(a)==="discussion"?f().accent:"transparent"]),b(n,A)},$$slots:{default:!0}}),b(t,M),ht()}wt(["click"]);export{ne as component,ae as universal};
