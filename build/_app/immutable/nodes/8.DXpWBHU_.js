import{q as ft,r as vt,t as f,u as L,s as v,a as _t,d as X}from"../chunks/B--cxG5T.js";import"../chunks/Bg9kRutz.js";import{Y as mt,am as ut,ap as gt,p as kt,u as bt,f as D,t as G,a as pt,ag as Z,af as ht,s as _,j as b,g as p,r as h,d as jt}from"../chunks/BO_dsxE5.js";import{s as U}from"../chunks/0WGjuh-S.js";import{a as xt}from"../chunks/a6fUsN8N.js";import{i as C}from"../chunks/8RKJ_MII.js";import{e as Lt,i as St}from"../chunks/B3-0hlRh.js";import{a as j,t as P,c as J}from"../chunks/D6uidfMZ.js";import{a as W}from"../chunks/C9G_F7KX.js";import{d as wt}from"../chunks/oUCqpRI-.js";import{b as yt}from"../chunks/CNEjyuJc.js";import{S as At,F as Bt}from"../chunks/DXa1AiWR.js";import{B as Dt}from"../chunks/DkF1SMXj.js";import{P as Rt,S as Ot}from"../chunks/DgqabkDF.js";import{A as Pt}from"../chunks/BSdXhxyR.js";const Mt=[];function Tt(t,e=!1){return N(t,new Map,"",Mt)}function N(t,e,r,a,w=null){if(typeof t=="object"&&t!==null){var y=e.get(t);if(y!==void 0)return y;if(t instanceof Map)return new Map(t);if(t instanceof Set)return new Set(t);if(mt(t)){var l=Array(t.length);e.set(t,l),w!==null&&e.set(w,l);for(var S=0;S<t.length;S+=1){var M=t[S];S in t&&(l[S]=N(M,e,r,a))}return l}if(ut(t)===gt){l={},e.set(t,l),w!==null&&e.set(w,l);for(var R in t)l[R]=N(t[R],e,r,a);return l}if(t instanceof Date)return structuredClone(t);if(typeof t.toJSON=="function")return N(t.toJSON(),e,r,a,t)}if(t instanceof EventTarget)return t;try{return structuredClone(t)}catch{return t}}const Ft=async({params:t})=>({book:await ft(t.slug)}),oe=Object.freeze(Object.defineProperty({__proto__:null,load:Ft},Symbol.toStringTag,{value:"Module"}));async function It(t,e){var a;const r=L().readingList;X({readingList:[...r,e.isbn]}),(a=L())==null||a.readingList.push(e.isbn)}async function Ct(t,e){const r=L().readingList.filter(a=>a!==e.isbn);X({readingList:r}),L().readingList=r}var Jt=(t,e)=>Z(e,"info"),Nt=(t,e)=>Z(e,"discussion"),$t=P('<div class="book-info svelte-kn64jk"><img class="cover svelte-kn64jk"> <p class="description svelte-kn64jk"> </p></div>'),qt=P('<button id="add-to-reading-list" class="remove-from-reading-list svelte-kn64jk">Remove from Reading List</button>'),zt=P('<button id="add-to-reading-list" class="svelte-kn64jk">Add to Reading List</button>'),Et=P('<nav class="svelte-kn64jk"><div class="banner svelte-kn64jk"><button aria-label="Open sidebar" class="svelte-kn64jk"></button> <div class="book-name svelte-kn64jk"><h1 class="svelte-kn64jk"> </h1> <h2 class="svelte-kn64jk"> </h2></div> <!></div></nav> <section class="svelte-kn64jk"><div class="views svelte-kn64jk"><button class="svelte-kn64jk">Info</button> <button class="svelte-kn64jk">Discussion</button></div> <!> <!></section> <!> <!>',1),Gt=P("<!> <!>",1);function ie(t,e){kt(e,!0);let r=e.data.book,a=ht("info"),w=vt(r.isbn),y,l=jt(()=>{var n;return((n=L())==null?void 0:n.readingList.includes(r.isbn))??!1});bt(()=>{var n;console.log(Tt((n=L())==null?void 0:n.readingList))});function S(n,H=3){n=n.replaceAll("--","â€”"),n=n.replaceAll(/\.(\S)/g,(o,m)=>`. ${m}`);let A=n.split(/([.!?])\s*/),x=[];for(let o=0;o<A.length;o+=2)x.push(A[o]+A[o+1]);let B=x.map((o,m)=>(m+1)%H===0&&m!==x.length-1?o+`

`:o).join("");return B=B.replaceAll(/\.(\S)/g,(o,m)=>`. ${m}`),B}var M=Gt(),R=D(M);Dt(R);var Y=_(R,2);Rt(Y,{style:"overflow-y: hidden;",children:(n,H)=>{var A=Et(),x=D(A),B=b(x),o=b(B);o.__click=()=>y.show();var m=_(o,2),T=b(m),tt=b(T,!0);h(T);var $=_(T,2),et=b($,!0);h($),h(m);var rt=_(m,2);At(rt,{style:"width: 2rem; height: 2rem;",get stroke(){return f().textBright}}),h(B),h(x);var q=_(x,2),F=b(q),I=b(F);I.__click=[Jt,a];var z=_(I,2);z.__click=[Nt,a],h(F);var K=_(F,2);{var st=s=>{var d=$t(),u=b(d),g=_(u,2),k=b(g,!0);h(g),h(d),G((i,c)=>{W(u,"alt",`${r.title} cover`),W(u,"src",r.cover),v(g,"color",i),U(k,c)},[()=>f().textDull,()=>S(r.description)]),j(s,d)},at=s=>{var d=J(),u=D(d);{var g=k=>{var i=J(),c=D(i);xt(c,()=>w,null,(O,E)=>{var V=J(),ct=D(V);Lt(ct,17,()=>p(E),St,(lt,dt)=>{Pt(lt,{get post(){return p(dt)}})}),j(O,V)}),j(k,i)};C(u,k=>{p(a)==="discussion"&&k(g)},!0)}j(s,d)};C(K,s=>{p(a)==="info"?s(st):s(at,!1)})}var nt=_(K,2);{var ot=s=>{var d=J(),u=D(d);{var g=i=>{var c=qt();c.__click=[Ct,r],j(i,c)},k=i=>{var c=zt();c.__click=[It,r],G(O=>v(c,"background",O),[_t]),j(i,c)};C(u,i=>{p(l)?i(g):i(k,!1)})}j(s,d)};C(nt,s=>{L()&&s(ot)})}h(q);var Q=_(q,2);Bt(Q,{selected:"search"});var it=_(Q,2);yt(Ot(it,{}),s=>y=s,()=>y),G((s,d,u,g,k,i,c,O,E)=>{v(x,"background",s),v(o,"background-image",d),v(T,"color",u),U(tt,r.title),v($,"color",g),U(et,k),v(F,"background-color",s),v(I,"color",i),v(I,"border-bottom-color",c),v(z,"color",O),v(z,"border-bottom-color",E)},[()=>f().backgroundDark,()=>{var s;return`url("${((s=L())==null?void 0:s.picture)??""}")`},()=>f().textBright,()=>f().textDim,()=>r.authors.join(", "),()=>p(a)==="info"?f().textBright:f().textDull,()=>p(a)==="info"?f().accent:"transparent",()=>p(a)==="discussion"?f().textBright:f().textDull,()=>p(a)==="discussion"?f().accent:"transparent"]),j(n,A)},$$slots:{default:!0}}),j(t,M),pt()}wt(["click"]);export{ie as component,oe as universal};
