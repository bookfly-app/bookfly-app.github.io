import{w as ft,x as vt,t as f,u as L,s as v,c as _t,a as ut,e as Y}from"../chunks/DLcAAEJF.js";import"../chunks/Bg9kRutz.js";import{U as mt,ag as gt,aj as kt,p as bt,u as pt,f as D,t as G,a as ht,aa as Z,a9 as jt,s as _,j as b,g as p,r as h,d as xt}from"../chunks/DS4hZ2gQ.js";import{s as q}from"../chunks/CaB2gU4d.js";import{i as C}from"../chunks/DU6_0F4v.js";import{e as Lt,i as St}from"../chunks/DS8sFolU.js";import{a as j,t as P,c as J}from"../chunks/BWjh48UC.js";import{a as X}from"../chunks/CEvXu-Yb.js";import{d as wt}from"../chunks/v-gzyAfz.js";import{b as yt}from"../chunks/DXvwv68a.js";import{S as At,F as Bt}from"../chunks/Bg5-f8vH.js";import{B as Dt}from"../chunks/6NqtgJ9Z.js";import{P as Rt,S as Ot}from"../chunks/BwpCW82D.js";import{A as Pt}from"../chunks/g1BOh0F5.js";const Mt=[];function Tt(t,e=!1){return N(t,new Map,"",Mt)}function N(t,e,r,a,w=null){if(typeof t=="object"&&t!==null){var y=e.get(t);if(y!==void 0)return y;if(t instanceof Map)return new Map(t);if(t instanceof Set)return new Set(t);if(mt(t)){var l=Array(t.length);e.set(t,l),w!==null&&e.set(w,l);for(var S=0;S<t.length;S+=1){var M=t[S];S in t&&(l[S]=N(M,e,r,a))}return l}if(gt(t)===kt){l={},e.set(t,l),w!==null&&e.set(w,l);for(var R in t)l[R]=N(t[R],e,r,a);return l}if(t instanceof Date)return structuredClone(t);if(typeof t.toJSON=="function")return N(t.toJSON(),e,r,a,t)}if(t instanceof EventTarget)return t;try{return structuredClone(t)}catch{return t}}const Ft=async({params:t})=>({book:await ft(t.slug)}),ne=Object.freeze(Object.defineProperty({__proto__:null,load:Ft},Symbol.toStringTag,{value:"Module"}));async function It(t,e){var a;const r=L().readingList;Y({readingList:[...r,e.isbn]}),(a=L())==null||a.readingList.push(e.isbn)}async function Ct(t,e){const r=L().readingList.filter(a=>a!==e.isbn);Y({readingList:r}),L().readingList=r}var Jt=(t,e)=>Z(e,"info"),Nt=(t,e)=>Z(e,"discussion"),Ut=P('<div class="book-info svelte-kn64jk"><img class="cover svelte-kn64jk"> <p class="description svelte-kn64jk"> </p></div>'),$t=P('<button id="add-to-reading-list" class="remove-from-reading-list svelte-kn64jk">Remove from Reading List</button>'),zt=P('<button id="add-to-reading-list" class="svelte-kn64jk">Add to Reading List</button>'),Et=P('<nav class="svelte-kn64jk"><div class="banner svelte-kn64jk"><button aria-label="Open sidebar" class="svelte-kn64jk"></button> <div class="book-name svelte-kn64jk"><h1 class="svelte-kn64jk"> </h1> <h2 class="svelte-kn64jk"> </h2></div> <!></div></nav> <section class="svelte-kn64jk"><div class="views svelte-kn64jk"><button class="svelte-kn64jk">Info</button> <button class="svelte-kn64jk">Discussion</button></div> <!> <!></section> <!> <!>',1),Gt=P("<!> <!>",1);function oe(t,e){bt(e,!0);let r=e.data.book,a=jt("info"),w=vt(r.isbn),y,l=xt(()=>{var n;return((n=L())==null?void 0:n.readingList.includes(r.isbn))??!1});pt(()=>{var n;console.log(Tt((n=L())==null?void 0:n.readingList))});function S(n,K=3){n=n.replaceAll("--","â€”"),n=n.replaceAll(/\.(\S)/g,(o,u)=>`. ${u}`);let A=n.split(/([.!?])\s*/),x=[];for(let o=0;o<A.length;o+=2)x.push(A[o]+A[o+1]);let B=x.map((o,u)=>(u+1)%K===0&&u!==x.length-1?o+`

`:o).join("");return B=B.replaceAll(/\.(\S)/g,(o,u)=>`. ${u}`),B}var M=Gt(),R=D(M);Dt(R);var H=_(R,2);Rt(H,{style:"overflow-y: hidden;",children:(n,K)=>{var A=Et(),x=D(A),B=b(x),o=b(B);o.__click=()=>y.show();var u=_(o,2),T=b(u),tt=b(T,!0);h(T);var U=_(T,2),et=b(U,!0);h(U),h(u);var rt=_(u,2);At(rt,{style:"width: 2rem; height: 2rem;",get stroke(){return f().textBright}}),h(B),h(x);var $=_(x,2),F=b($),I=b(F);I.__click=[Jt,a];var z=_(I,2);z.__click=[Nt,a],h(F);var Q=_(F,2);{var st=s=>{var d=Ut(),m=b(d),g=_(m,2),k=b(g,!0);h(g),h(d),G((i,c)=>{X(m,"alt",`${r.title} cover`),X(m,"src",r.cover),v(g,"color",i),q(k,c)},[()=>f().textDull,()=>S(r.description)]),j(s,d)},at=s=>{var d=J(),m=D(d);{var g=k=>{var i=J(),c=D(i);_t(c,()=>w,null,(O,E)=>{var W=J(),ct=D(W);Lt(ct,17,()=>p(E),St,(lt,dt)=>{Pt(lt,{get post(){return p(dt)}})}),j(O,W)}),j(k,i)};C(m,k=>{p(a)==="discussion"&&k(g)},!0)}j(s,d)};C(Q,s=>{p(a)==="info"?s(st):s(at,!1)})}var nt=_(Q,2);{var ot=s=>{var d=J(),m=D(d);{var g=i=>{var c=$t();c.__click=[Ct,r],j(i,c)},k=i=>{var c=zt();c.__click=[It,r],G(O=>v(c,"background",O),[ut]),j(i,c)};C(m,i=>{p(l)?i(g):i(k,!1)})}j(s,d)};C(nt,s=>{L()&&s(ot)})}h($);var V=_($,2);Bt(V,{selected:"search"});var it=_(V,2);yt(Ot(it,{}),s=>y=s,()=>y),G((s,d,m,g,k,i,c,O,E)=>{v(x,"background",s),v(o,"background-image",d),v(T,"color",m),q(tt,r.title),v(U,"color",g),q(et,k),v(F,"background-color",s),v(I,"color",i),v(I,"border-bottom-color",c),v(z,"color",O),v(z,"border-bottom-color",E)},[()=>f().backgroundDark,()=>{var s;return`url("${((s=L())==null?void 0:s.picture)??""}")`},()=>f().textBright,()=>f().textDim,()=>r.authors.join(", "),()=>p(a)==="info"?f().textBright:f().textDull,()=>p(a)==="info"?f().accent:"transparent",()=>p(a)==="discussion"?f().textBright:f().textDull,()=>p(a)==="discussion"?f().accent:"transparent"]),j(n,A)},$$slots:{default:!0}}),j(t,M),ht()}wt(["click"]);export{oe as component,ne as universal};
