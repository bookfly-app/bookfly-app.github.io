import"./Bg9kRutz.js";import{h as le,z as et,y as Ze,q as Pt,E as Gt,v as Lt,N as At,O as Ht,C as tt,B as at,k as It,aF as vt,F as Nt,D as Ut,x as Et,p as ce,s as v,c as n,r as l,t as M,a as ue,f as g,a5 as me,j as e,a6 as z,g as ge,a4 as jt}from"./DpL-zfgl.js";import{b as qt,a as i,n as Ae,c as k,t as m}from"./DitkTsWA.js";import{e as rt,a as Z,s as E,g as st,P as Tt}from"./BpcGamk_.js";import{r as He,i as F,s as j,b as ot,p as nt}from"./BdjlEak8.js";import{p as he}from"./D9Rqb9Mt.js";import{B as zt,m as De,t as Zt,C as Dt,A as Ot,u as ye,f as dt,r as Wt,q as Jt}from"./CNXCd5Iu.js";import{e as we,i as Ge}from"./BzvN9xHF.js";import{h as Kt}from"./C57OuvGF.js";import{s as J,a as xe}from"./Bh5g2vjz.js";import{p as Qt,d as Xt}from"./DHveY-33.js";import{o as Yt}from"./BKa3V-0I.js";import{g as Oe}from"./CafJ9o8I.js";import{B as $t,S as ea,C as lt,a as ta,b as aa,A as Le,c as ra}from"./Db6GcBfP.js";import{R as sa}from"./Cl3kE4Vu.js";function oa(c,s,a,y,o,f){let u=le;le&&et();var h,V,b=null;le&&Ze.nodeType===1&&(b=Ze,et());var K=le?Ze:c,L;Pt(()=>{const p=s()||null;var q=p==="svg"?vt:null;p!==h&&(L&&(p===null?Nt(L,()=>{L=null,V=null}):p===V?Ut(L):Et(L)),p&&p!==V&&(L=Lt(()=>{b=le?b:q?document.createElementNS(q,p):document.createElement(p),qt(b,b);{le&&Qt(p)&&b.append(document.createComment(""));var A=le?At(b):b.appendChild(Ht());le&&(A===null?tt(!1):at(A)),y(b,A)}It.nodes_end=b,K.before(b)})),h=p,h&&(V=h))},Gt),u&&(tt(!0),at(K))}var na=Ae('<svg><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"><path d="M4 19V6.2C4 5.0799 4 4.51984 4.21799 4.09202C4.40973 3.71569 4.71569 3.40973 5.09202 3.21799C5.51984 3 6.0799 3 7.2 3H16.8C17.9201 3 18.4802 3 18.908 3.21799C19.2843 3.40973 19.5903 3.71569 19.782 4.09202C20 4.51984 20 5.0799 20 6.2V17H6C4.89543 17 4 17.8954 4 19ZM4 19C4 20.1046 4.89543 21 6 21H20M9 7H15M9 11H15M19 17V21" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path></g></svg>');function la(c,s){ce(s,!0);let a=He(s,["$$slots","$$events","$$legacy"]),y=s.stroke;a={...a},a.stroke=void 0;var o=na();let f;var u=v(n(o),2),h=n(u);J(h,"stroke",y),l(u),l(o),M(()=>f=xe(o,f,{...a,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},void 0,!0)),i(c,o),ue()}var ia=Ae('<svg><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"><path d="M12 7V12L14.5 10.5M21 12C21 16.9706 16.9706 21 12 21C7.02944 21 3 16.9706 3 12C3 7.02944 7.02944 3 12 3C16.9706 3 21 7.02944 21 12Z" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path></g></svg>');function va(c,s){ce(s,!0);let a=He(s,["$$slots","$$events","$$legacy"]),y=s.stroke;a={...a},a.stroke=void 0;var o=ia();let f;var u=v(n(o),2),h=n(u);J(h,"stroke",y),l(u),l(o),M(()=>f=xe(o,f,{...a,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},void 0,!0)),i(c,o),ue()}var da=Ae('<svg><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"><path id="primary" d="M21,11H5.41l1.3-1.29A1,1,0,0,0,5.29,8.29l-3,3a1,1,0,0,0,0,1.42l3,3a1,1,0,0,0,1.42,0,1,1,0,0,0,0-1.42L5.41,13H21a1,1,0,0,0,0-2Z"></path></g></svg>');function ga(c,s){ce(s,!0);let a=He(s,["$$slots","$$events","$$legacy"]),y=s.stroke;a={...a},a.stroke=void 0;var o=da();let f;var u=v(n(o),2),h=n(u);J(h,"style",`fill: ${y??""};`),l(u),l(o),M(()=>f=xe(o,f,{...a,fill:y,viewBox:"0 0 24 24",id:"left-arrow","data-name":"Flat Color",xmlns:"http://www.w3.org/2000/svg",class:"icon flat-color"},void 0,!0)),i(c,o),ue()}var ca=Ae('<svg><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"><path d="M13 12H21M13 8H21M13 16H21M6 7V17M6 17L3 14M6 17L9 14" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path></g></svg>');function ua(c,s){ce(s,!0);let a=He(s,["$$slots","$$events","$$legacy"]),y=s.stroke;a={...a},a.stroke=void 0;var o=ca();let f;var u=v(n(o),2),h=n(u);J(h,"stroke",y),l(u),l(o),M(()=>f=xe(o,f,{...a,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},void 0,!0)),i(c,o),ue()}var _a=m('<div class="rating svelte-1aw03vq"><span class="name svelte-1aw03vq"> </span> <!> <span class="rating-number svelte-1aw03vq"> </span></div>'),fa=m('<div class="book-info svelte-1aw03vq"><h1 class="svelte-1aw03vq"> </h1> <h2 class="svelte-1aw03vq"> </h2></div> <!> <!>',1);function it(c,s){ce(s,!0);var a=k(),y=g(a);oa(y,()=>s.onclick?"div":"a",!1,(o,f)=>{var u=()=>{var D;return(D=s.onclick)==null?void 0:D.call(s)};let h;M(()=>h=xe(o,h,{"data-rating":s.rating,id:"outer",href:`/book/${s.book.isbn??""}`,onclick:u},"svelte-1aw03vq",o.namespaceURI===vt,o.nodeName.includes("-")));var V=fa(),b=g(V),K=n(b),L=n(K,!0);l(K);var p=v(K,2),q=n(p,!0);l(p),l(b);var A=v(b,2);{var ie=D=>{var ee=_a(),te=n(ee),Ce=n(te);l(te);var Se=v(te,2);ea(Se,{get rating(){return s.rating},size:.6});var _e=v(Se,2),Re=n(_e);l(_e),l(ee),M(fe=>{j(Ce,`${s.user.displayName??""}'s rating:`),j(Re,`${fe??""} / 10`)},[()=>s.rating===10?s.rating:s.rating.toFixed(1)]),i(D,ee)};F(A,D=>{s.rating!==void 0&&D(ie)})}var Ie=v(A,2);$t(Ie,{style:"height: 100%; aspect-ratio: 8 / 11;",get book(){return s.book}}),M(D=>{j(L,s.book.title),j(q,D)},[()=>s.book.authors.join(", ")]),i(f,V)}),i(c,a),ue()}function pa(c,s){dt({following:[...new Set([...ye().following,s.id])]})}function ba(c,s){dt({following:ye().following.filter(a=>a!==s.id)})}var ma=m('<div style="view-transition-name: profile-banner-image;" class="banner svelte-era8g7"></div>'),ha=(c,s)=>s.show(),ka=m('<div class="dot svelte-era8g7"></div> <h2 class="pronouns svelte-era8g7"> </h2>',1),wa=()=>Oe("/profile/edit"),ya=m('<button class="edit button svelte-era8g7">Edit Profile</button>'),xa=m('<button class="unfollow button svelte-era8g7">Unfollow</button>'),Ca=m('<button class="follow button svelte-era8g7">Follow</button>'),Sa=m('<p class="bio svelte-era8g7"><!></p>'),Ra=m('<a class="svelte-era8g7"><!> <span class="truncate svelte-era8g7"> </span></a>'),Fa=m('<a class="svelte-era8g7"><!> <span class="truncate svelte-era8g7"> </span></a>'),Ma=m('<span class="profile-books svelte-era8g7"><!> <!></span>'),Va=(c,s)=>ge(s,"books"),Ba=m('<!> <a class="svelte-era8g7"><!> <span> </span></a>',1),Pa=m("<span> </span>"),Ga=(c,s)=>e(s).open(c),La=m('<button class="svelte-era8g7">Highest Rated</button> <button class="svelte-era8g7">Recently Finished</button>',1),Aa=m('<div class="ratings svelte-era8g7"><div class="rating-options svelte-era8g7"><span class="svelte-era8g7"><label for="show-full-reviews" class="svelte-era8g7">Show full reviews</label> <!></span> <span class="svelte-era8g7"><label for="change-rating-sort" class="svelte-era8g7"> </label> <button id="change-rating-sort" class="svelte-era8g7"><!></button></span> <!></div> <!></div>'),Ha=m('<div class="ratings svelte-era8g7"><!></div>'),Ia=m('<div class="loading svelte-era8g7"><h1 class="svelte-era8g7">Loading posts...</h1> <p class="svelte-era8g7">We promise Wallflower will be faster soon.</p></div>'),Na=m('<section class="svelte-era8g7"><!> <button class="back-arrow svelte-era8g7"><!></button> <div class="profile svelte-era8g7"><!> <div class="profile-line-1 svelte-era8g7"><span class="name svelte-era8g7"><h1 class="svelte-era8g7"> </h1> <h2 class="svelte-era8g7"> </h2> <!> <!></span> <!></div> <!> <div class="profile-line-2 svelte-era8g7"><!></div> <a class="follows svelte-era8g7"><!> <span> </span></a> <div class="views svelte-era8g7"><button class="svelte-era8g7">All</button> <button class="svelte-era8g7">Books</button> <button class="svelte-era8g7">Activity</button> <button class="svelte-era8g7">List</button> <button class="svelte-era8g7">Discussion</button></div></div> <!></section>');function Ua(c,s){ce(s,!0);let a=s.user,y=s.sidebar,o=me(he(new URLSearchParams(window.location.search).get("view")??"all")),f=zt(a),u=Promise.all(a.readingList.map(r=>De(r))),h=Zt(a),V=Dt(a),b=z(()=>{var r;return((r=ye())==null?void 0:r.id)===a.id}),K=a.currentBook?De(a.currentBook):Promise.resolve(null),L=V.then(r=>r.filter(t=>t.type==="rating").length),p=me(!1),q=me(null),A=me("best"),ie=z(()=>({best:"Highest Rated",recent:"Recently Finished"})[e(A)]),Ie=z(async()=>(e(A),V.then(r=>r.filter(t=>t.type==="rating").toSorted({best:(t,d)=>d.rating-t.rating,recent:(t,d)=>d.timestamp-t.timestamp}[e(A)]))));function D(r){return()=>{ge(A,he(r)),e(q).close()}}function ee(r){return function(){Oe(`${window.location.origin}${window.location.pathname}?${new URLSearchParams({view:r})}`),ge(o,he(r))}}let te=me(null);function Ce(r){const t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(r);return{r:parseInt(t[1],16),g:parseInt(t[2],16),b:parseInt(t[3],16)}}function Se(r,t,d){d=Math.min(Math.max(d,0),1);const w=Ce(r),B=Ce(t),x=P=>Math.round(w[P]*(1-d)+B[P]*d);return{r:x("r"),g:x("g"),b:x("b")}}Yt(()=>{document.addEventListener("scroll",()=>{var r;if((r=e(q))==null||r.close(),e(te)){const d=e(te).getBoundingClientRect().top/100,{r:w,g:B,b:x}=Se(rt("crust"),rt("base"),d);e(te).style.background=`rgb(${w}, ${B}, ${x})`}},!0)});var _e=Na(),Re=n(_e);Z(Re,()=>st(a.banner),null,(r,t)=>{lt(r,{get src(){return e(t)},style:"view-transition-name: profile-banner;",children:(d,w)=>{var B=ma();M(()=>E(B,"background-image",`url("${e(t)}")`)),i(d,B)},$$slots:{default:!0}})});var fe=v(Re,2);fe.__click=[ha,y];var gt=n(fe);ga(gt,{stroke:"#FFFFFF",style:"width: 1.5rem; height: 1.5rem;"}),l(fe);var Ne=v(fe,2),We=n(Ne);Z(We,()=>st(a.picture),null,(r,t)=>{const d=z(()=>`${a.displayName} profile picture`);lt(r,{class:"profile-picture",get src(){return e(t)},get alt(){return e(d)}})});var Ue=v(We,2),Ee=n(Ue),je=n(Ee),ct=n(je,!0);l(je);var qe=v(je,2),ut=n(qe);l(qe);var Je=v(qe,2);ta(Je,{forUser:a,size:1});var _t=v(Je,2);{var ft=r=>{var t=ka(),d=v(g(t),2),w=n(d,!0);l(d),M(()=>j(w,a.pronouns)),i(r,t)};F(_t,r=>{a.pronouns&&r(ft)})}l(Ee);var pt=v(Ee,2);{var bt=r=>{var t=ya();t.__click=[wa],i(r,t)},mt=r=>{var t=k(),d=g(t);{var w=B=>{var x=k(),P=g(x);{var Q=C=>{var H=xa();H.__click=[ba,a],i(C,H)},ve=C=>{var H=Ca();H.__click=[pa,a],i(C,H)};F(P,C=>{ye().following.includes(a.id)?C(Q):C(ve,!1)})}i(B,x)};F(d,B=>{ye()&&B(w)},!0)}i(r,t)};F(pt,r=>{e(b)?r(bt):r(mt,!1)})}l(Ue);var Ke=v(Ue,2);Z(Ke,()=>Ot(a.bio),null,(r,t)=>{var d=Sa(),w=n(d);Kt(w,()=>e(t),!1,!1),l(d),i(r,d)});var Te=v(Ke,2),ht=n(Te);Z(ht,()=>L,null,(r,t)=>{var d=Ba(),w=g(d);{var B=C=>{var H=Ma(),ae=n(H);Z(ae,()=>f,null,(X,S)=>{var re=k(),R=g(re);{var I=N=>{var _=Ra(),O=n(_);aa(O,{stroke:"var(--overlay-1)",style:"width: 1rem; height: 1rem; flex-shrink: 0;"});var G=v(O,2),T=n(G,!0);l(G),l(_),M(()=>{J(_,"href",`/book/${e(S).isbn}`),J(_,"title",`${a.displayName}'s highest rated book is ${e(S).title}`),j(T,e(S).title)}),i(N,_)};F(R,N=>{e(S)&&N(I)})}i(X,re)});var oe=v(ae,2);Z(oe,()=>K,null,(X,S)=>{var re=k(),R=g(re);{var I=N=>{var _=Fa(),O=n(_);va(O,{stroke:"var(--overlay-1)",style:"width: 1rem; height: 1rem; flex-shrink: 0;"});var G=v(O,2),T=n(G,!0);l(G),l(_),M(()=>{J(_,"href",`/book/${e(S).isbn??""}`),J(_,"title",`${a.displayName} is currently reading ${e(S).title}`),j(T,e(S).title)}),i(N,_)};F(R,N=>{e(S)&&N(I)})}i(X,re)}),l(H),i(C,H)};F(w,C=>{e(t)>0&&C(B)})}var x=v(w,2);x.__click=[Va,o];var P=n(x);la(P,{stroke:"var(--overlay-1)",style:"width: 1rem; height: 1rem;"});var Q=v(P,2),ve=n(Q,!0);l(Q),l(x),M(()=>{J(x,"href",`/profile/${a.username??""}?view=books`),J(x,"title",`${a.displayName??""} has read ${e(t)??""} book${(e(t)===1?"":"s")??""}`),j(ve,e(t))}),i(r,d)}),l(Te);var Fe=v(Te,2),Qe=n(Fe);Z(Qe,()=>h,null,(r,t)=>{var d=Pa(),w=n(d);l(d),M(()=>j(w,`${e(t).length??""} Followers`)),i(r,d)});var Xe=v(Qe,2),kt=n(Xe);l(Xe),l(Fe);var Ye=v(Fe,2),Me=n(Ye),wt=z(()=>ee("all"));Me.__click=function(...r){var t;(t=e(wt))==null||t.apply(this,r)};var Ve=v(Me,2),yt=z(()=>ee("books"));Ve.__click=function(...r){var t;(t=e(yt))==null||t.apply(this,r)};var Be=v(Ve,2),xt=z(()=>ee("activity"));Be.__click=function(...r){var t;(t=e(xt))==null||t.apply(this,r)};var Pe=v(Be,2),Ct=z(()=>ee("list"));Pe.__click=function(...r){var t;(t=e(Ct))==null||t.apply(this,r)};var ze=v(Pe,2),St=z(()=>ee("discussion"));ze.__click=function(...r){var t;(t=e(St))==null||t.apply(this,r)},l(Ye),l(Ne);var Rt=v(Ne,2);Z(Rt,()=>V,r=>{var t=Ia();i(r,t)},(r,t)=>{var d=k(),w=g(d);{var B=P=>{var Q=k(),ve=g(Q);we(ve,17,()=>e(t).filter(C=>C.type==="general"),Ge,(C,H)=>{Le(C,{get post(){return e(H)}})}),i(P,Q)},x=P=>{var Q=k(),ve=g(Q);{var C=ae=>{var oe=Aa(),X=n(oe),S=n(X);E(S,"color","var(--overlay-1)");var re=v(n(S),2);sa(re,{id:"show-full-reviews",size:.5,get value(){return e(p)},set value(U){ge(p,he(U))}}),l(S);var R=v(S,2);E(R,"color","var(--overlay-1)");var I=n(R),N=n(I,!0);l(I);var _=v(I,2);_.__click=[Ga,q];var O=n(_);ua(O,{stroke:"var(--overlay-1)",style:"width: 1.5rem; height: 1.5rem;"}),l(_),l(R);var G=v(R,2);ot(ra(G,{children:(U,pe)=>{var W=La(),Y=g(W),se=z(()=>D("best"));Y.__click=function(...ke){var de;(de=e(se))==null||de.apply(this,ke)};var $=v(Y,2),ne=z(()=>D("recent"));$.__click=function(...ke){var de;(de=e(ne))==null||de.apply(this,ke)},i(U,W)},$$slots:{default:!0}}),U=>ge(q,he(U)),()=>e(q)),l(X),ot(X,U=>ge(te,U),()=>e(te));var T=v(X,2);Z(T,()=>e(Ie),null,(U,pe)=>{var W=k(),Y=g(W);we(Y,17,()=>e(pe),se=>se.id,(se,$)=>{var ne=k(),ke=g(ne);{var de=be=>{Le(be,{get post(){return e($)}})},Ft=be=>{var $e=k(),Mt=g($e);Z(Mt,()=>De(e($).books[0]),null,(Vt,Bt)=>{it(Vt,{get book(){return e(Bt)},get rating(){return e($).rating},user:a,onclick:()=>Oe(`/post/${e($).id}`)})}),i(be,$e)};F(ke,be=>{e(p)?be(de):be(Ft,!1)})}i(se,ne)}),i(U,W)}),l(oe),M(()=>j(N,e(ie))),i(ae,oe)},H=ae=>{var oe=k(),X=g(oe);{var S=R=>{var I=k(),N=g(I);we(N,17,()=>e(t).filter(_=>_.type==="update"),Ge,(_,O)=>{Le(_,{get post(){return e(O)}})}),i(R,I)},re=R=>{var I=k(),N=g(I);{var _=G=>{var T=Ha(),U=n(T);Z(U,()=>u,null,(pe,W)=>{var Y=k(),se=g(Y);we(se,17,()=>e(W),Ge,($,ne)=>{it($,{get book(){return e(ne)},user:a})}),i(pe,Y)}),l(T),i(G,T)},O=G=>{var T=k(),U=g(T);{var pe=W=>{var Y=k(),se=g(Y);we(se,17,()=>e(t),Ge,($,ne)=>{Le($,{get post(){return e(ne)}})}),i(W,Y)};F(U,W=>{e(o)==="all"&&W(pe)},!0)}i(G,T)};F(N,G=>{e(o)==="list"?G(_):G(O,!1)},!0)}i(R,I)};F(X,R=>{e(o)==="activity"?R(S):R(re,!1)},!0)}i(ae,oe)};F(ve,ae=>{e(o)==="books"?ae(C):ae(H,!1)},!0)}i(P,Q)};F(w,P=>{e(o)==="discussion"?P(B):P(x,!1)})}i(r,d)}),l(_e),M(()=>{j(ct,a.displayName),j(ut,`@${a.username??""}`),J(Fe,"href",`/profile/${a.username}/follows`),j(kt,`${a.following.length??""} Following`),E(Me,"color",e(o)==="all"?"var(--subtext-1)":"var(--overlay-1)"),E(Me,"border-bottom",e(o)==="all"?"3px solid var(--lavender)":"3px solid transparent"),E(Ve,"color",e(o)==="books"?"var(--subtext-1)":"var(--overlay-1)"),E(Ve,"border-bottom",e(o)==="books"?"3px solid var(--lavender)":"3px solid transparent"),E(Be,"color",e(o)==="activity"?"var(--subtext-1)":"var(--overlay-1)"),E(Be,"border-bottom",e(o)==="activity"?"3px solid var(--lavender)":"3px solid transparent"),E(Pe,"color",e(o)==="list"?"var(--subtext-1)":"var(--overlay-1)"),E(Pe,"border-bottom",e(o)==="list"?"3px solid var(--lavender)":"3px solid transparent"),E(ze,"color",e(o)==="discussion"?"var(--subtext-1)":"var(--overlay-1)"),E(ze,"border-bottom",e(o)==="discussion"?"3px solid var(--lavender)":"3px solid transparent")}),i(c,_e),ue()}Xt(["click"]);var Ea=m('<!> <div class="svelte-uf21oc"></div>',1);function tr(c,s){ce(s,!0);let a=nt(s,"userid",3,void 0),y=nt(s,"username",3,void 0),o=z(()=>a()?Wt(a()):Jt(y())),f=me(null);Tt(c,{type:"profile",get sidebar(){return e(f)},set sidebar(u){ge(f,he(u))},children:(u,h)=>{var V=Ea(),b=g(V);Z(b,()=>e(o),null,(K,L)=>{var p=k(),q=g(p);{var A=ie=>{Ua(ie,{get sidebar(){return e(f)},get user(){return e(L)}})};F(q,ie=>{e(L)&&ie(A)})}i(K,p)}),jt(2),i(u,V)},$$slots:{default:!0}}),ue()}export{tr as P};
