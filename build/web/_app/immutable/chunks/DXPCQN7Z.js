import"./Bg9kRutz.js";import{l as ie,H as at,G as qe,B as Pt,E as Gt,C as Ht,W as Lt,X as Nt,L as rt,K as ot,x as At,aH as ct,O as Ut,N as It,F as Et,p as me,s as v,c as n,r as i,t as M,a as pe,f as u,ab as we,g as e,v as fe,k as Q,aa as jt}from"./B4GbWA8R.js";import{b as Tt,a as l,n as Ae,c as w,t as m}from"./Dl9jAjjr.js";import{s as b,e as st,a as q,g as lt,P as zt}from"./D3-kl1oe.js";import{r as Ue,i as B,s as z,b as nt,p as it}from"./Cyj749Ah.js";import{p as ye}from"./DM7NgvAD.js";import{B as Dt,m as Oe,t as Wt,C as Zt,A as qt,u as xe,f as ut,r as Ot,q as Kt}from"./DvfE787y.js";import{N as Xt}from"./BKk1Vust.js";import{e as Se,i as Le}from"./Cctvoyb2.js";import{h as Jt}from"./CESpdpSj.js";import{s as D,a as Fe}from"./BVQKxV24.js";import{q as Qt,d as Yt}from"./D6HPNALu.js";import{o as $t}from"./6jwXdfWr.js";import{g as Ke}from"./Br7lPkcf.js";import{S as ea,B as ta,a as aa,A as Ne,C as ra}from"./CDRpWArv.js";import{t as Re}from"./TG4sZsnt.js";import{B as oa}from"./Cm2LK7DQ.js";import{R as sa}from"./D6KVGyMn.js";function la(d,o,a,y,s,p){let _=ie;ie&&at();var h,G,k=null;ie&&qe.nodeType===1&&(k=qe,at());var O=ie?qe:d,H;Pt(()=>{const g=o()||null;var W=g==="svg"?ct:null;g!==h&&(H&&(g===null?Ut(H,()=>{H=null,G=null}):g===G?It(H):Et(H)),g&&g!==G&&(H=Ht(()=>{k=ie?k:W?document.createElementNS(W,g):document.createElement(g),Tt(k,k);{ie&&Qt(g)&&k.append(document.createComment(""));var U=ie?Lt(k):k.appendChild(Nt());ie&&(U===null?rt(!1):ot(U)),y(k,U)}At.nodes_end=k,O.before(k)})),h=g,h&&(G=h))},Gt),_&&(rt(!0),ot(O))}var na=Ae('<svg><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"><path d="M4 19V6.2C4 5.0799 4 4.51984 4.21799 4.09202C4.40973 3.71569 4.71569 3.40973 5.09202 3.21799C5.51984 3 6.0799 3 7.2 3H16.8C17.9201 3 18.4802 3 18.908 3.21799C19.2843 3.40973 19.5903 3.71569 19.782 4.09202C20 4.51984 20 5.0799 20 6.2V17H6C4.89543 17 4 17.8954 4 19ZM4 19C4 20.1046 4.89543 21 6 21H20M9 7H15M9 11H15M19 17V21" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path></g></svg>');function ia(d,o){me(o,!0);let a=Ue(o,["$$slots","$$events","$$legacy"]),y=o.stroke;a={...a},a.stroke=void 0;var s=na();let p;var _=v(n(s),2),h=n(_);D(h,"stroke",y),i(_),i(s),M(()=>p=Fe(s,p,{...a,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},void 0,!0)),l(d,s),pe()}var va=Ae('<svg><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"><path d="M12 7V12L14.5 10.5M21 12C21 16.9706 16.9706 21 12 21C7.02944 21 3 16.9706 3 12C3 7.02944 7.02944 3 12 3C16.9706 3 21 7.02944 21 12Z" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path></g></svg>');function ca(d,o){me(o,!0);let a=Ue(o,["$$slots","$$events","$$legacy"]),y=o.stroke;a={...a},a.stroke=void 0;var s=va();let p;var _=v(n(s),2),h=n(_);D(h,"stroke",y),i(_),i(s),M(()=>p=Fe(s,p,{...a,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},void 0,!0)),l(d,s),pe()}var ua=Ae('<svg><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"><path id="primary" d="M21,11H5.41l1.3-1.29A1,1,0,0,0,5.29,8.29l-3,3a1,1,0,0,0,0,1.42l3,3a1,1,0,0,0,1.42,0,1,1,0,0,0,0-1.42L5.41,13H21a1,1,0,0,0,0-2Z"></path></g></svg>');function da(d,o){me(o,!0);let a=Ue(o,["$$slots","$$events","$$legacy"]),y=o.stroke;a={...a},a.stroke=void 0;var s=ua();let p;var _=v(n(s),2),h=n(_);D(h,"style",`fill: ${y??""};`),i(_),i(s),M(()=>p=Fe(s,p,{...a,fill:y,viewBox:"0 0 24 24",id:"left-arrow","data-name":"Flat Color",xmlns:"http://www.w3.org/2000/svg",class:"icon flat-color"},void 0,!0)),l(d,s),pe()}var _a=Ae('<svg><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"><path d="M13 12H21M13 8H21M13 16H21M6 7V17M6 17L3 14M6 17L9 14" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path></g></svg>');function ga(d,o){me(o,!0);let a=Ue(o,["$$slots","$$events","$$legacy"]),y=o.stroke;a={...a},a.stroke=void 0;var s=_a();let p;var _=v(n(s),2),h=n(_);D(h,"stroke",y),i(_),i(s),M(()=>p=Fe(s,p,{...a,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},void 0,!0)),l(d,s),pe()}var fa=m('<div class="rating svelte-153hpy1"><span> </span> <!> <span> </span></div>'),ma=m('<div class="book-info svelte-153hpy1"><h1 class="svelte-153hpy1"> </h1> <h2 class="svelte-153hpy1"> </h2></div> <!> <!>',1);function vt(d,o){me(o,!0);var a=w(),y=u(a);la(y,()=>o.onclick?"div":"a",!1,(s,p)=>{var _=()=>{var x;return(x=o.onclick)==null?void 0:x.call(o)};let h;M((x,V)=>{h=Fe(s,h,{"data-rating":o.rating,id:"outer",href:`/book/${o.book.isbn??""}`,onclick:_},"svelte-153hpy1",s.namespaceURI===ct,s.nodeName.includes("-")),b(s,"border-color",x),b(s,"background",V)},[()=>Re().textDark,()=>Re().background]);var G=ma(),k=u(G),O=n(k),H=n(O,!0);i(O);var g=v(O,2),W=n(g,!0);i(g),i(k);var U=v(k,2);{var ve=x=>{var V=fa(),L=n(V),se=n(L);i(L);var ce=v(L,2);ea(ce,{get rating(){return o.rating},size:.6});var ue=v(ce,2),Be=n(ue);i(ue),i(V),M((de,Ie)=>{b(L,"color",de),z(se,`${o.user.displayName??""}'s rating:`),b(ue,"color",de),z(Be,`${Ie??""} / 10`)},[()=>Re().text,()=>o.rating===10?o.rating:o.rating.toFixed(1)]),l(x,V)};B(U,x=>{o.rating!==void 0&&x(ve)})}var ke=v(U,2);oa(ke,{style:"height: 100%; aspect-ratio: 8 / 11;",get book(){return o.book}}),M((x,V,L)=>{b(O,"color",x),z(H,o.book.title),b(g,"color",V),z(W,L)},[()=>Re().text,()=>Re().textDull,()=>o.book.authors.join(", ")]),l(p,G)}),l(d,a),pe()}function pa(d,o){ut({following:[...new Set([...xe().following,o.id])]})}function ka(d,o){ut({following:xe().following.filter(a=>a!==o.id)})}var ba=m('<div class="banner svelte-1aukclm"></div>'),ha=(d,o)=>o.show(),wa=m('<img class="profile-picture svelte-1aukclm">'),ya=m('<div class="dot svelte-1aukclm"></div> <h2 class="pronouns svelte-1aukclm"> </h2>',1),xa=()=>Ke("/profile/edit"),Ca=m('<button class="edit button svelte-1aukclm">Edit Profile</button>'),Sa=m('<button class="unfollow button svelte-1aukclm">Unfollow</button>'),Ra=m('<button class="follow button svelte-1aukclm">Follow</button>'),Fa=m('<p class="bio svelte-1aukclm"><!></p>'),Ba=m('<a class="svelte-1aukclm"><!> <span class="truncate svelte-1aukclm"> </span></a>'),Ma=m('<a class="svelte-1aukclm"><!> <span class="truncate svelte-1aukclm"> </span></a>'),Va=m('<span class="profile-books svelte-1aukclm"><!> <!></span>'),Pa=(d,o)=>fe(o,"books"),Ga=m('<!> <a class="svelte-1aukclm"><!> <span> </span></a>',1),Ha=m("<span> </span>"),La=(d,o)=>e(o).open(d),Na=m('<button class="svelte-1aukclm">Highest Rated</button> <button class="svelte-1aukclm">Recently Finished</button>',1),Aa=m('<div class="ratings svelte-1aukclm"><div class="rating-options svelte-1aukclm"><span class="svelte-1aukclm"><label for="show-full-reviews" class="svelte-1aukclm">Show full reviews</label> <!></span> <span class="svelte-1aukclm"><label for="change-rating-sort" class="svelte-1aukclm"> </label> <button id="change-rating-sort" class="svelte-1aukclm"><!></button></span> <!></div> <!></div>'),Ua=m('<div class="ratings svelte-1aukclm"><!></div>'),Ia=m('<div class="loading svelte-1aukclm"><h1 class="svelte-1aukclm">Loading posts...</h1> <p class="svelte-1aukclm">We promise Wallflower will be faster soon.</p></div>'),Ea=m('<section class="svelte-1aukclm"><!> <button class="back-arrow svelte-1aukclm"><!></button> <div class="profile svelte-1aukclm"><!> <div class="profile-line-1 svelte-1aukclm"><span class="name svelte-1aukclm"><h1 class="svelte-1aukclm"> </h1> <h2 class="svelte-1aukclm"> </h2> <!> <!></span> <!></div> <!> <div class="profile-line-2 svelte-1aukclm"><!></div> <a class="follows svelte-1aukclm"><!> <span> </span></a> <div class="views svelte-1aukclm"><button class="svelte-1aukclm">All</button> <button class="svelte-1aukclm">Books</button> <button class="svelte-1aukclm">Activity</button> <button class="svelte-1aukclm">List</button> <button class="svelte-1aukclm">Discussion</button></div></div> <!></section>');function ja(d,o){me(o,!0);let a=o.user,y=o.sidebar,s=we(ye(new URLSearchParams(window.location.search).get("view")??"all")),p=Dt(a),_=Promise.all(a.readingList.map(r=>Oe(r))),h=Wt(a),G=Zt(a),k=Q(()=>{var r;return((r=xe())==null?void 0:r.id)===a.id}),O=a.currentBook?Oe(a.currentBook):Promise.resolve(null),H=G.then(r=>r.filter(t=>t.type==="rating").length),g=we(!1),W=we(null),U=we("best"),ve=Q(()=>({best:"Highest Rated",recent:"Recently Finished"})[e(U)]),ke=Q(async()=>(e(U),G.then(r=>r.filter(t=>t.type==="rating").toSorted({best:(t,c)=>c.rating-t.rating,recent:(t,c)=>c.timestamp-t.timestamp}[e(U)]))));function x(r){return()=>{fe(U,ye(r)),e(W).close()}}function V(r){return function(){Ke(`${window.location.origin}${window.location.pathname}?${new URLSearchParams({view:r})}`),fe(s,ye(r))}}let L=we(null);function se(r){const t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(r);return{r:parseInt(t[1],16),g:parseInt(t[2],16),b:parseInt(t[3],16)}}function ce(r,t,c){c=Math.min(Math.max(c,0),1);const C=se(r),K=se(t),S=N=>Math.round(C[N]*(1-c)+K[N]*c);return{r:S("r"),g:S("g"),b:S("b")}}$t(()=>{document.addEventListener("scroll",()=>{var r;if((r=e(W))==null||r.close(),e(L)){const c=e(L).getBoundingClientRect().top/100,{r:C,g:K,b:S}=ce(st("crust"),st("base"),c);e(L).style.background=`rgb(${C}, ${K}, ${S})`}},!0)});var ue=Ea(),Be=n(ue);q(Be,()=>lt(a.banner),null,(r,t)=>{var c=ba();M(()=>b(c,"background-image",`url("${e(t)}")`)),l(r,c)});var de=v(Be,2);de.__click=[ha,y];var Ie=n(de);da(Ie,{stroke:"#FFFFFF",style:"width: 1.5rem; height: 1.5rem;"}),i(de);var Ee=v(de,2),Xe=n(Ee);q(Xe,()=>lt(a.picture),null,(r,t)=>{var c=wa();M(()=>{D(c,"src",e(t)),D(c,"alt",`${a.displayName} profile picture`)}),l(r,c)});var je=v(Xe,2),Te=n(je),ze=n(Te),dt=n(ze,!0);i(ze);var De=v(ze,2),_t=n(De);i(De);var Je=v(De,2);ta(Je,{forUser:a,size:1});var gt=v(Je,2);{var ft=r=>{var t=ya(),c=v(u(t),2),C=n(c,!0);i(c),M(()=>z(C,a.pronouns)),l(r,t)};B(gt,r=>{a.pronouns&&r(ft)})}i(Te);var mt=v(Te,2);{var pt=r=>{var t=Ca();t.__click=[xa],l(r,t)},kt=r=>{var t=w(),c=u(t);{var C=K=>{var S=w(),N=u(S);{var Y=R=>{var I=Sa();I.__click=[ka,a],l(R,I)},_e=R=>{var I=Ra();I.__click=[pa,a],l(R,I)};B(N,R=>{xe().following.includes(a.id)?R(Y):R(_e,!1)})}l(K,S)};B(c,K=>{xe()&&K(C)},!0)}l(r,t)};B(mt,r=>{e(k)?r(pt):r(kt,!1)})}i(je);var Qe=v(je,2);q(Qe,()=>qt(a.bio),null,(r,t)=>{var c=Fa(),C=n(c);Jt(C,()=>e(t),!1,!1),i(c),l(r,c)});var We=v(Qe,2),bt=n(We);q(bt,()=>H,null,(r,t)=>{var c=Ga(),C=u(c);{var K=R=>{var I=Va(),ae=n(I);q(ae,()=>p,null,($,F)=>{var re=w(),P=u(re);{var E=j=>{var f=Ba(),X=n(f);aa(X,{stroke:"var(--overlay-1)",style:"width: 1rem; height: 1rem; flex-shrink: 0;"});var A=v(X,2),Z=n(A,!0);i(A),i(f),M(()=>{D(f,"href",`/book/${e(F).isbn}`),D(f,"title",`${a.displayName}'s highest rated book is ${e(F).title}`),z(Z,e(F).title)}),l(j,f)};B(P,j=>{e(F)&&j(E)})}l($,re)});var le=v(ae,2);q(le,()=>O,null,($,F)=>{var re=w(),P=u(re);{var E=j=>{var f=Ma(),X=n(f);ca(X,{stroke:"var(--overlay-1)",style:"width: 1rem; height: 1rem; flex-shrink: 0;"});var A=v(X,2),Z=n(A,!0);i(A),i(f),M(()=>{D(f,"href",`/book/${e(F).isbn??""}`),D(f,"title",`${a.displayName} is currently reading ${e(F).title}`),z(Z,e(F).title)}),l(j,f)};B(P,j=>{e(F)&&j(E)})}l($,re)}),i(I),l(R,I)};B(C,R=>{e(t)>0&&R(K)})}var S=v(C,2);S.__click=[Pa,s];var N=n(S);ia(N,{stroke:"var(--overlay-1)",style:"width: 1rem; height: 1rem;"});var Y=v(N,2),_e=n(Y,!0);i(Y),i(S),M(()=>{D(S,"href",`/profile/${a.username??""}?view=books`),D(S,"title",`${a.displayName??""} has read ${e(t)??""} book${(e(t)===1?"":"s")??""}`),z(_e,e(t))}),l(r,c)}),i(We);var Me=v(We,2),Ye=n(Me);q(Ye,()=>h,null,(r,t)=>{var c=Ha(),C=n(c);i(c),M(()=>z(C,`${e(t).length??""} Followers`)),l(r,c)});var $e=v(Ye,2),ht=n($e);i($e),i(Me);var et=v(Me,2),Ve=n(et),wt=Q(()=>V("all"));Ve.__click=function(...r){var t;(t=e(wt))==null||t.apply(this,r)};var Pe=v(Ve,2),yt=Q(()=>V("books"));Pe.__click=function(...r){var t;(t=e(yt))==null||t.apply(this,r)};var Ge=v(Pe,2),xt=Q(()=>V("activity"));Ge.__click=function(...r){var t;(t=e(xt))==null||t.apply(this,r)};var He=v(Ge,2),Ct=Q(()=>V("list"));He.__click=function(...r){var t;(t=e(Ct))==null||t.apply(this,r)};var Ze=v(He,2),St=Q(()=>V("discussion"));Ze.__click=function(...r){var t;(t=e(St))==null||t.apply(this,r)},i(et),i(Ee);var Rt=v(Ee,2);q(Rt,()=>G,r=>{var t=Ia();l(r,t)},(r,t)=>{var c=w(),C=u(c);{var K=N=>{var Y=w(),_e=u(Y);Se(_e,17,()=>e(t).filter(R=>R.type==="general"),Le,(R,I)=>{Ne(R,{get post(){return e(I)}})}),l(N,Y)},S=N=>{var Y=w(),_e=u(Y);{var R=ae=>{var le=Aa(),$=n(le),F=n($);b(F,"color","var(--overlay-1)");var re=v(n(F),2);sa(re,{id:"show-full-reviews",size:.5,get value(){return e(g)},set value(T){fe(g,ye(T))}}),i(F);var P=v(F,2);b(P,"color","var(--overlay-1)");var E=n(P),j=n(E,!0);i(E);var f=v(E,2);f.__click=[La,W];var X=n(f);ga(X,{stroke:"var(--overlay-1)",style:"width: 1.5rem; height: 1.5rem;"}),i(f),i(P);var A=v(P,2);nt(ra(A,{children:(T,be)=>{var J=Na(),ee=u(J),oe=Q(()=>x("best"));ee.__click=function(...Ce){var ge;(ge=e(oe))==null||ge.apply(this,Ce)};var te=v(ee,2),ne=Q(()=>x("recent"));te.__click=function(...Ce){var ge;(ge=e(ne))==null||ge.apply(this,Ce)},l(T,J)},$$slots:{default:!0}}),T=>fe(W,ye(T)),()=>e(W)),i($),nt($,T=>fe(L,T),()=>e(L));var Z=v($,2);q(Z,()=>e(ke),null,(T,be)=>{var J=w(),ee=u(J);Se(ee,17,()=>e(be),oe=>oe.id,(oe,te)=>{var ne=w(),Ce=u(ne);{var ge=he=>{Ne(he,{get post(){return e(te)}})},Ft=he=>{var tt=w(),Bt=u(tt);q(Bt,()=>Oe(e(te).books[0]),null,(Mt,Vt)=>{vt(Mt,{get book(){return e(Vt)},get rating(){return e(te).rating},user:a,onclick:()=>Ke(`/post/${e(te).id}`)})}),l(he,tt)};B(Ce,he=>{e(g)?he(ge):he(Ft,!1)})}l(oe,ne)}),l(T,J)}),i(le),M(()=>z(j,e(ve))),l(ae,le)},I=ae=>{var le=w(),$=u(le);{var F=P=>{var E=w(),j=u(E);Se(j,17,()=>e(t).filter(f=>f.type==="update"),Le,(f,X)=>{Ne(f,{get post(){return e(X)}})}),l(P,E)},re=P=>{var E=w(),j=u(E);{var f=A=>{var Z=Ua(),T=n(Z);q(T,()=>_,null,(be,J)=>{var ee=w(),oe=u(ee);Se(oe,17,()=>e(J),Le,(te,ne)=>{vt(te,{get book(){return e(ne)},user:a})}),l(be,ee)}),i(Z),l(A,Z)},X=A=>{var Z=w(),T=u(Z);{var be=J=>{var ee=w(),oe=u(ee);Se(oe,17,()=>e(t),Le,(te,ne)=>{Ne(te,{get post(){return e(ne)}})}),l(J,ee)};B(T,J=>{e(s)==="all"&&J(be)},!0)}l(A,Z)};B(j,A=>{e(s)==="list"?A(f):A(X,!1)},!0)}l(P,E)};B($,P=>{e(s)==="activity"?P(F):P(re,!1)},!0)}l(ae,le)};B(_e,ae=>{e(s)==="books"?ae(R):ae(I,!1)},!0)}l(N,Y)};B(C,N=>{e(s)==="discussion"?N(K):N(S,!1)})}l(r,c)}),i(ue),M(()=>{z(dt,a.displayName),z(_t,`@${a.username??""}`),D(Me,"href",`/profile/${a.username}/follows`),z(ht,`${a.following.length??""} Following`),b(Ve,"color",e(s)==="all"?"var(--subtext-1)":"var(--overlay-1)"),b(Ve,"border-bottom",e(s)==="all"?"3px solid var(--lavender)":"3px solid transparent"),b(Pe,"color",e(s)==="books"?"var(--subtext-1)":"var(--overlay-1)"),b(Pe,"border-bottom",e(s)==="books"?"3px solid var(--lavender)":"3px solid transparent"),b(Ge,"color",e(s)==="activity"?"var(--subtext-1)":"var(--overlay-1)"),b(Ge,"border-bottom",e(s)==="activity"?"3px solid var(--lavender)":"3px solid transparent"),b(He,"color",e(s)==="list"?"var(--subtext-1)":"var(--overlay-1)"),b(He,"border-bottom",e(s)==="list"?"3px solid var(--lavender)":"3px solid transparent"),b(Ze,"color",e(s)==="discussion"?"var(--subtext-1)":"var(--overlay-1)"),b(Ze,"border-bottom",e(s)==="discussion"?"3px solid var(--lavender)":"3px solid transparent")}),l(d,ue),pe()}Yt(["click"]);var Ta=m("<!> <!>",1),za=m('<!> <div class="svelte-uf21oc"></div>',1);function nr(d,o){me(o,!0);let a=it(o,"userid",3,void 0),y=it(o,"username",3,void 0),s=Q(()=>a()?Ot(a()):Kt(y())),p=we(null);zt(d,{type:"profile",get sidebar(){return e(p)},set sidebar(_){fe(p,ye(_))},children:(_,h)=>{var G=za(),k=u(G);q(k,()=>e(s),null,(O,H)=>{var g=w(),W=u(g);{var U=ve=>{var ke=Ta(),x=u(ke);ja(x,{get sidebar(){return e(p)},get user(){return e(H)}});var V=v(x,2);{var L=se=>{Xt(se,{})};B(V,se=>{var ce;e(H).id===((ce=xe())==null?void 0:ce.id)&&se(L)})}l(ve,ke)};B(W,ve=>{e(H)&&ve(U)})}l(O,g)}),jt(2),l(_,G)},$$slots:{default:!0}}),pe()}export{nr as P};
