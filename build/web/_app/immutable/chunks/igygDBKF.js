import"./Bg9kRutz.js";import{l as ie,H as rt,G as Ze,B as Pt,E as Gt,C as Lt,W as Nt,X as Ht,L as at,K as ot,x as It,aI as ct,O as At,N as Ut,F as Et,p as he,s as v,c as l,r as i,t as B,a as pe,f as c,ab as we,g as e,k as Z,v as fe,aa as jt}from"./C62SPajG.js";import{b as Tt,a as n,n as He,c as w,t as p}from"./Bqi7JOxH.js";import{s as m,f as st,a as O,g as nt,P as zt}from"./D9igWbRp.js";import{r as Ie,i as F,s as z,b as lt,p as it}from"./BbJ7nyNa.js";import{p as ye}from"./B65nbPqP.js";import{B as Dt,m as Oe,t as Wt,C as Zt,A as Ot,u as xe,f as ut,r as Kt,q as Xt}from"./DV3XZOMr.js";import{N as Jt}from"./BKlOVOgk.js";import{e as Ce,i as Le}from"./EPkomH51.js";import{h as Qt}from"./8DCDmLcT.js";import{s as Q,a as Re}from"./BqKKz4p4.js";import{p as Yt,d as $t}from"./Bu0Zqk6q.js";import{o as er}from"./Dxq3VFhd.js";import{g as Ke}from"./BA5qhnwX.js";import{B as tr,S as rr,C as vt,a as ar,b as or,A as Ne,c as sr}from"./LVj815OY.js";import{t as Se}from"./DKhumj_K.js";import{R as nr}from"./kAy-A6jS.js";function lr(u,o,r,x,s,h){let _=ie;ie&&rt();var k,P,b=null;ie&&Ze.nodeType===1&&(b=Ze,rt());var K=ie?Ze:u,G;Pt(()=>{const g=o()||null;var D=g==="svg"?ct:null;g!==k&&(G&&(g===null?At(G,()=>{G=null,P=null}):g===P?Ut(G):Et(G)),g&&g!==P&&(G=Lt(()=>{b=ie?b:D?document.createElementNS(D,g):document.createElement(g),Tt(b,b);{ie&&Yt(g)&&b.append(document.createComment(""));var A=ie?Nt(b):b.appendChild(Ht());ie&&(A===null?at(!1):ot(A)),x(b,A)}It.nodes_end=b,K.before(b)})),k=g,k&&(P=k))},Gt),_&&(at(!0),ot(K))}var ir=He('<svg><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"><path d="M4 19V6.2C4 5.0799 4 4.51984 4.21799 4.09202C4.40973 3.71569 4.71569 3.40973 5.09202 3.21799C5.51984 3 6.0799 3 7.2 3H16.8C17.9201 3 18.4802 3 18.908 3.21799C19.2843 3.40973 19.5903 3.71569 19.782 4.09202C20 4.51984 20 5.0799 20 6.2V17H6C4.89543 17 4 17.8954 4 19ZM4 19C4 20.1046 4.89543 21 6 21H20M9 7H15M9 11H15M19 17V21" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path></g></svg>');function vr(u,o){he(o,!0);let r=Ie(o,["$$slots","$$events","$$legacy"]),x=o.stroke;r={...r},r.stroke=void 0;var s=ir();let h;var _=v(l(s),2),k=l(_);Q(k,"stroke",x),i(_),i(s),B(()=>h=Re(s,h,{...r,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},void 0,!0)),n(u,s),pe()}var dr=He('<svg><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"><path d="M12 7V12L14.5 10.5M21 12C21 16.9706 16.9706 21 12 21C7.02944 21 3 16.9706 3 12C3 7.02944 7.02944 3 12 3C16.9706 3 21 7.02944 21 12Z" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path></g></svg>');function cr(u,o){he(o,!0);let r=Ie(o,["$$slots","$$events","$$legacy"]),x=o.stroke;r={...r},r.stroke=void 0;var s=dr();let h;var _=v(l(s),2),k=l(_);Q(k,"stroke",x),i(_),i(s),B(()=>h=Re(s,h,{...r,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},void 0,!0)),n(u,s),pe()}var ur=He('<svg><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"><path id="primary" d="M21,11H5.41l1.3-1.29A1,1,0,0,0,5.29,8.29l-3,3a1,1,0,0,0,0,1.42l3,3a1,1,0,0,0,1.42,0,1,1,0,0,0,0-1.42L5.41,13H21a1,1,0,0,0,0-2Z"></path></g></svg>');function _r(u,o){he(o,!0);let r=Ie(o,["$$slots","$$events","$$legacy"]),x=o.stroke;r={...r},r.stroke=void 0;var s=ur();let h;var _=v(l(s),2),k=l(_);Q(k,"style",`fill: ${x??""};`),i(_),i(s),B(()=>h=Re(s,h,{...r,fill:x,viewBox:"0 0 24 24",id:"left-arrow","data-name":"Flat Color",xmlns:"http://www.w3.org/2000/svg",class:"icon flat-color"},void 0,!0)),n(u,s),pe()}var gr=He('<svg><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"><path d="M13 12H21M13 8H21M13 16H21M6 7V17M6 17L3 14M6 17L9 14" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path></g></svg>');function fr(u,o){he(o,!0);let r=Ie(o,["$$slots","$$events","$$legacy"]),x=o.stroke;r={...r},r.stroke=void 0;var s=gr();let h;var _=v(l(s),2),k=l(_);Q(k,"stroke",x),i(_),i(s),B(()=>h=Re(s,h,{...r,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},void 0,!0)),n(u,s),pe()}var hr=p('<div class="rating svelte-153hpy1"><span> </span> <!> <span> </span></div>'),pr=p('<div class="book-info svelte-153hpy1"><h1 class="svelte-153hpy1"> </h1> <h2 class="svelte-153hpy1"> </h2></div> <!> <!>',1);function dt(u,o){he(o,!0);var r=w(),x=c(r);lr(x,()=>o.onclick?"div":"a",!1,(s,h)=>{var _=()=>{var q;return(q=o.onclick)==null?void 0:q.call(o)};let k;B((q,M)=>{k=Re(s,k,{"data-rating":o.rating,id:"outer",href:`/book/${o.book.isbn??""}`,onclick:_},"svelte-153hpy1",s.namespaceURI===ct,s.nodeName.includes("-")),m(s,"border-color",q),m(s,"background",M)},[()=>Se().textDark,()=>Se().background]);var P=pr(),b=c(P),K=l(b),G=l(K,!0);i(K);var g=v(K,2),D=l(g,!0);i(g),i(b);var A=v(b,2);{var ve=q=>{var M=hr(),L=l(M),se=l(L);i(L);var de=v(L,2);rr(de,{get rating(){return o.rating},size:.6});var ce=v(de,2),Fe=l(ce);i(ce),i(M),B((ue,Ae)=>{m(L,"color",ue),z(se,`${o.user.displayName??""}'s rating:`),m(ce,"color",ue),z(Fe,`${Ae??""} / 10`)},[()=>Se().text,()=>o.rating===10?o.rating:o.rating.toFixed(1)]),n(q,M)};F(A,q=>{o.rating!==void 0&&q(ve)})}var be=v(A,2);tr(be,{style:"height: 100%; aspect-ratio: 8 / 11;",get book(){return o.book}}),B((q,M,L)=>{m(K,"color",q),z(G,o.book.title),m(g,"color",M),z(D,L)},[()=>Se().text,()=>Se().textDull,()=>o.book.authors.join(", ")]),n(h,P)}),n(u,r),pe()}function br(u,o){ut({following:[...new Set([...xe().following,o.id])]})}function mr(u,o){ut({following:xe().following.filter(r=>r!==o.id)})}var kr=p('<div class="banner svelte-2qnh35"></div>'),wr=(u,o)=>o.show(),yr=p('<div class="dot svelte-2qnh35"></div> <h2 class="pronouns svelte-2qnh35"> </h2>',1),xr=()=>Ke("/profile/edit"),qr=p('<button class="edit button svelte-2qnh35">Edit Profile</button>'),Cr=p('<button class="unfollow button svelte-2qnh35">Unfollow</button>'),Sr=p('<button class="follow button svelte-2qnh35">Follow</button>'),Rr=p('<p class="bio svelte-2qnh35"><!></p>'),Fr=p('<a class="svelte-2qnh35"><!> <span class="truncate svelte-2qnh35"> </span></a>'),Mr=p('<a class="svelte-2qnh35"><!> <span class="truncate svelte-2qnh35"> </span></a>'),Vr=p('<span class="profile-books svelte-2qnh35"><!> <!></span>'),Br=(u,o)=>fe(o,"books"),Pr=p('<!> <a class="svelte-2qnh35"><!> <span> </span></a>',1),Gr=p("<span> </span>"),Lr=(u,o)=>e(o).open(u),Nr=p('<button class="svelte-2qnh35">Highest Rated</button> <button class="svelte-2qnh35">Recently Finished</button>',1),Hr=p('<div class="ratings svelte-2qnh35"><div class="rating-options svelte-2qnh35"><span class="svelte-2qnh35"><label for="show-full-reviews" class="svelte-2qnh35">Show full reviews</label> <!></span> <span class="svelte-2qnh35"><label for="change-rating-sort" class="svelte-2qnh35"> </label> <button id="change-rating-sort" class="svelte-2qnh35"><!></button></span> <!></div> <!></div>'),Ir=p('<div class="ratings svelte-2qnh35"><!></div>'),Ar=p('<div class="loading svelte-2qnh35"><h1 class="svelte-2qnh35">Loading posts...</h1> <p class="svelte-2qnh35">We promise Wallflower will be faster soon.</p></div>'),Ur=p('<section class="svelte-2qnh35"><!> <button class="back-arrow svelte-2qnh35"><!></button> <div class="profile svelte-2qnh35"><!> <div class="profile-line-1 svelte-2qnh35"><span class="name svelte-2qnh35"><h1 class="svelte-2qnh35"> </h1> <h2 class="svelte-2qnh35"> </h2> <!> <!></span> <!></div> <!> <div class="profile-line-2 svelte-2qnh35"><!></div> <a class="follows svelte-2qnh35"><!> <span> </span></a> <div class="views svelte-2qnh35"><button class="svelte-2qnh35">All</button> <button class="svelte-2qnh35">Books</button> <button class="svelte-2qnh35">Activity</button> <button class="svelte-2qnh35">List</button> <button class="svelte-2qnh35">Discussion</button></div></div> <!></section>');function Er(u,o){he(o,!0);let r=o.user,x=o.sidebar,s=we(ye(new URLSearchParams(window.location.search).get("view")??"all")),h=Dt(r),_=Promise.all(r.readingList.map(a=>Oe(a))),k=Wt(r),P=Zt(r),b=Z(()=>{var a;return((a=xe())==null?void 0:a.id)===r.id}),K=r.currentBook?Oe(r.currentBook):Promise.resolve(null),G=P.then(a=>a.filter(t=>t.type==="rating").length),g=we(!1),D=we(null),A=we("best"),ve=Z(()=>({best:"Highest Rated",recent:"Recently Finished"})[e(A)]),be=Z(async()=>(e(A),P.then(a=>a.filter(t=>t.type==="rating").toSorted({best:(t,d)=>d.rating-t.rating,recent:(t,d)=>d.timestamp-t.timestamp}[e(A)]))));function q(a){return()=>{fe(A,ye(a)),e(D).close()}}function M(a){return function(){Ke(`${window.location.origin}${window.location.pathname}?${new URLSearchParams({view:a})}`),fe(s,ye(a))}}let L=we(null);function se(a){const t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(a);return{r:parseInt(t[1],16),g:parseInt(t[2],16),b:parseInt(t[3],16)}}function de(a,t,d){d=Math.min(Math.max(d,0),1);const y=se(a),N=se(t),C=H=>Math.round(y[H]*(1-d)+N[H]*d);return{r:C("r"),g:C("g"),b:C("b")}}er(()=>{document.addEventListener("scroll",()=>{var a;if((a=e(D))==null||a.close(),e(L)){const d=e(L).getBoundingClientRect().top/100,{r:y,g:N,b:C}=de(st("crust"),st("base"),d);e(L).style.background=`rgb(${y}, ${N}, ${C})`}},!0)});var ce=Ur(),Fe=l(ce);O(Fe,()=>nt(r.banner),null,(a,t)=>{vt(a,{get src(){return e(t)},children:(d,y)=>{var N=kr();B(()=>m(N,"background-image",`url("${e(t)}")`)),n(d,N)},$$slots:{default:!0}})});var ue=v(Fe,2);ue.__click=[wr,x];var Ae=l(ue);_r(Ae,{stroke:"#FFFFFF",style:"width: 1.5rem; height: 1.5rem;"}),i(ue);var Ue=v(ue,2),Xe=l(Ue);O(Xe,()=>nt(r.picture),null,(a,t)=>{const d=Z(()=>`${r.displayName} profile picture`);vt(a,{class:"profile-picture",get src(){return e(t)},get alt(){return e(d)}})});var Ee=v(Xe,2),je=l(Ee),Te=l(je),_t=l(Te,!0);i(Te);var ze=v(Te,2),gt=l(ze);i(ze);var Je=v(ze,2);ar(Je,{forUser:r,size:1});var ft=v(Je,2);{var ht=a=>{var t=yr(),d=v(c(t),2),y=l(d,!0);i(d),B(()=>z(y,r.pronouns)),n(a,t)};F(ft,a=>{r.pronouns&&a(ht)})}i(je);var pt=v(je,2);{var bt=a=>{var t=qr();t.__click=[xr],n(a,t)},mt=a=>{var t=w(),d=c(t);{var y=N=>{var C=w(),H=c(C);{var Y=S=>{var U=Cr();U.__click=[mr,r],n(S,U)},_e=S=>{var U=Sr();U.__click=[br,r],n(S,U)};F(H,S=>{xe().following.includes(r.id)?S(Y):S(_e,!1)})}n(N,C)};F(d,N=>{xe()&&N(y)},!0)}n(a,t)};F(pt,a=>{e(b)?a(bt):a(mt,!1)})}i(Ee);var Qe=v(Ee,2);O(Qe,()=>Ot(r.bio),null,(a,t)=>{var d=Rr(),y=l(d);Qt(y,()=>e(t),!1,!1),i(d),n(a,d)});var De=v(Qe,2),kt=l(De);O(kt,()=>G,null,(a,t)=>{var d=Pr(),y=c(d);{var N=S=>{var U=Vr(),re=l(U);O(re,()=>h,null,($,R)=>{var ae=w(),V=c(ae);{var E=j=>{var f=Fr(),X=l(f);or(X,{stroke:"var(--overlay-1)",style:"width: 1rem; height: 1rem; flex-shrink: 0;"});var I=v(X,2),W=l(I,!0);i(I),i(f),B(()=>{Q(f,"href",`/book/${e(R).isbn}`),Q(f,"title",`${r.displayName}'s highest rated book is ${e(R).title}`),z(W,e(R).title)}),n(j,f)};F(V,j=>{e(R)&&j(E)})}n($,ae)});var ne=v(re,2);O(ne,()=>K,null,($,R)=>{var ae=w(),V=c(ae);{var E=j=>{var f=Mr(),X=l(f);cr(X,{stroke:"var(--overlay-1)",style:"width: 1rem; height: 1rem; flex-shrink: 0;"});var I=v(X,2),W=l(I,!0);i(I),i(f),B(()=>{Q(f,"href",`/book/${e(R).isbn??""}`),Q(f,"title",`${r.displayName} is currently reading ${e(R).title}`),z(W,e(R).title)}),n(j,f)};F(V,j=>{e(R)&&j(E)})}n($,ae)}),i(U),n(S,U)};F(y,S=>{e(t)>0&&S(N)})}var C=v(y,2);C.__click=[Br,s];var H=l(C);vr(H,{stroke:"var(--overlay-1)",style:"width: 1rem; height: 1rem;"});var Y=v(H,2),_e=l(Y,!0);i(Y),i(C),B(()=>{Q(C,"href",`/profile/${r.username??""}?view=books`),Q(C,"title",`${r.displayName??""} has read ${e(t)??""} book${(e(t)===1?"":"s")??""}`),z(_e,e(t))}),n(a,d)}),i(De);var Me=v(De,2),Ye=l(Me);O(Ye,()=>k,null,(a,t)=>{var d=Gr(),y=l(d);i(d),B(()=>z(y,`${e(t).length??""} Followers`)),n(a,d)});var $e=v(Ye,2),wt=l($e);i($e),i(Me);var et=v(Me,2),Ve=l(et),yt=Z(()=>M("all"));Ve.__click=function(...a){var t;(t=e(yt))==null||t.apply(this,a)};var Be=v(Ve,2),xt=Z(()=>M("books"));Be.__click=function(...a){var t;(t=e(xt))==null||t.apply(this,a)};var Pe=v(Be,2),qt=Z(()=>M("activity"));Pe.__click=function(...a){var t;(t=e(qt))==null||t.apply(this,a)};var Ge=v(Pe,2),Ct=Z(()=>M("list"));Ge.__click=function(...a){var t;(t=e(Ct))==null||t.apply(this,a)};var We=v(Ge,2),St=Z(()=>M("discussion"));We.__click=function(...a){var t;(t=e(St))==null||t.apply(this,a)},i(et),i(Ue);var Rt=v(Ue,2);O(Rt,()=>P,a=>{var t=Ar();n(a,t)},(a,t)=>{var d=w(),y=c(d);{var N=H=>{var Y=w(),_e=c(Y);Ce(_e,17,()=>e(t).filter(S=>S.type==="general"),Le,(S,U)=>{Ne(S,{get post(){return e(U)}})}),n(H,Y)},C=H=>{var Y=w(),_e=c(Y);{var S=re=>{var ne=Hr(),$=l(ne),R=l($);m(R,"color","var(--overlay-1)");var ae=v(l(R),2);nr(ae,{id:"show-full-reviews",size:.5,get value(){return e(g)},set value(T){fe(g,ye(T))}}),i(R);var V=v(R,2);m(V,"color","var(--overlay-1)");var E=l(V),j=l(E,!0);i(E);var f=v(E,2);f.__click=[Lr,D];var X=l(f);fr(X,{stroke:"var(--overlay-1)",style:"width: 1.5rem; height: 1.5rem;"}),i(f),i(V);var I=v(V,2);lt(sr(I,{children:(T,me)=>{var J=Nr(),ee=c(J),oe=Z(()=>q("best"));ee.__click=function(...qe){var ge;(ge=e(oe))==null||ge.apply(this,qe)};var te=v(ee,2),le=Z(()=>q("recent"));te.__click=function(...qe){var ge;(ge=e(le))==null||ge.apply(this,qe)},n(T,J)},$$slots:{default:!0}}),T=>fe(D,ye(T)),()=>e(D)),i($),lt($,T=>fe(L,T),()=>e(L));var W=v($,2);O(W,()=>e(be),null,(T,me)=>{var J=w(),ee=c(J);Ce(ee,17,()=>e(me),oe=>oe.id,(oe,te)=>{var le=w(),qe=c(le);{var ge=ke=>{Ne(ke,{get post(){return e(te)}})},Ft=ke=>{var tt=w(),Mt=c(tt);O(Mt,()=>Oe(e(te).books[0]),null,(Vt,Bt)=>{dt(Vt,{get book(){return e(Bt)},get rating(){return e(te).rating},user:r,onclick:()=>Ke(`/post/${e(te).id}`)})}),n(ke,tt)};F(qe,ke=>{e(g)?ke(ge):ke(Ft,!1)})}n(oe,le)}),n(T,J)}),i(ne),B(()=>z(j,e(ve))),n(re,ne)},U=re=>{var ne=w(),$=c(ne);{var R=V=>{var E=w(),j=c(E);Ce(j,17,()=>e(t).filter(f=>f.type==="update"),Le,(f,X)=>{Ne(f,{get post(){return e(X)}})}),n(V,E)},ae=V=>{var E=w(),j=c(E);{var f=I=>{var W=Ir(),T=l(W);O(T,()=>_,null,(me,J)=>{var ee=w(),oe=c(ee);Ce(oe,17,()=>e(J),Le,(te,le)=>{dt(te,{get book(){return e(le)},user:r})}),n(me,ee)}),i(W),n(I,W)},X=I=>{var W=w(),T=c(W);{var me=J=>{var ee=w(),oe=c(ee);Ce(oe,17,()=>e(t),Le,(te,le)=>{Ne(te,{get post(){return e(le)}})}),n(J,ee)};F(T,J=>{e(s)==="all"&&J(me)},!0)}n(I,W)};F(j,I=>{e(s)==="list"?I(f):I(X,!1)},!0)}n(V,E)};F($,V=>{e(s)==="activity"?V(R):V(ae,!1)},!0)}n(re,ne)};F(_e,re=>{e(s)==="books"?re(S):re(U,!1)},!0)}n(H,Y)};F(y,H=>{e(s)==="discussion"?H(N):H(C,!1)})}n(a,d)}),i(ce),B(()=>{z(_t,r.displayName),z(gt,`@${r.username??""}`),Q(Me,"href",`/profile/${r.username}/follows`),z(wt,`${r.following.length??""} Following`),m(Ve,"color",e(s)==="all"?"var(--subtext-1)":"var(--overlay-1)"),m(Ve,"border-bottom",e(s)==="all"?"3px solid var(--lavender)":"3px solid transparent"),m(Be,"color",e(s)==="books"?"var(--subtext-1)":"var(--overlay-1)"),m(Be,"border-bottom",e(s)==="books"?"3px solid var(--lavender)":"3px solid transparent"),m(Pe,"color",e(s)==="activity"?"var(--subtext-1)":"var(--overlay-1)"),m(Pe,"border-bottom",e(s)==="activity"?"3px solid var(--lavender)":"3px solid transparent"),m(Ge,"color",e(s)==="list"?"var(--subtext-1)":"var(--overlay-1)"),m(Ge,"border-bottom",e(s)==="list"?"3px solid var(--lavender)":"3px solid transparent"),m(We,"color",e(s)==="discussion"?"var(--subtext-1)":"var(--overlay-1)"),m(We,"border-bottom",e(s)==="discussion"?"3px solid var(--lavender)":"3px solid transparent")}),n(u,ce),pe()}$t(["click"]);var jr=p("<!> <!>",1),Tr=p('<!> <div class="svelte-uf21oc"></div>',1);function na(u,o){he(o,!0);let r=it(o,"userid",3,void 0),x=it(o,"username",3,void 0),s=Z(()=>r()?Kt(r()):Xt(x())),h=we(null);zt(u,{type:"profile",get sidebar(){return e(h)},set sidebar(_){fe(h,ye(_))},children:(_,k)=>{var P=Tr(),b=c(P);O(b,()=>e(s),null,(K,G)=>{var g=w(),D=c(g);{var A=ve=>{var be=jr(),q=c(be);Er(q,{get sidebar(){return e(h)},get user(){return e(G)}});var M=v(q,2);{var L=se=>{Jt(se,{})};F(M,se=>{var de;e(G).id===((de=xe())==null?void 0:de.id)&&se(L)})}n(ve,be)};F(D,ve=>{e(G)&&ve(A)})}n(K,g)}),jt(2),n(_,P)},$$slots:{default:!0}}),pe()}export{na as P};
