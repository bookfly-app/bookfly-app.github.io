import"../chunks/Bg9kRutz.js";import{p as ge,a7 as B,a as ke,s as r,y as e,w as c,c as i,f as D,r as s,t as F,a8 as se,Y as xe,ac as we}from"../chunks/BaZyK-JQ.js";import{i as T,s as M}from"../chunks/DBYv9uc3.js";import{P as Be,a as ne,s as le}from"../chunks/BBznB-Ys.js";import{e as me,i as Te}from"../chunks/CN4MRzID.js";import{h as je}from"../chunks/BrYFX6Dx.js";import{a as n,t as _,c as ye}from"../chunks/Dd2BwSaU.js";import{r as de,s as Q}from"../chunks/D230ZY73.js";import{d as Ce,r as Pe}from"../chunks/BuFl6vNe.js";import{b as oe}from"../chunks/2_PfXxFa.js";import{p as G}from"../chunks/COAggT6D.js";import{g as Ee}from"../chunks/EeCmvtSl.js";import{r as Oe,t as Se,v as Le}from"../chunks/C5TKFuMC.js";import{S as Re}from"../chunks/BIFOjtH1.js";import{E as Ae,T as Ne}from"../chunks/KFNUWUS5.js";import{H as He}from"../chunks/BT8yK3cY.js";import{C as Ie}from"../chunks/CsU4twge.js";const Me=({params:q})=>q,ht=Object.freeze(Object.defineProperty({__proto__:null,load:Me},Symbol.toStringTag,{value:"Module"}));function qe(q,L){q.key==="Enter"&&L()}var ze=_('<span class="error svelte-y7ymmy"> </span>'),Ue=_('<div class="book search-book svelte-y7ymmy"><img class="svelte-y7ymmy"> <div class="info svelte-y7ymmy"><span class="title svelte-y7ymmy"> </span> <span class="authors svelte-y7ymmy"> </span></div></div>'),Ve=_('<div class="book search-book svelte-y7ymmy"><img alt="Book cover" src="" class="svelte-y7ymmy"> <div class="info svelte-y7ymmy"><span class="title svelte-y7ymmy">Loading Title...</span> <span class="authors svelte-y7ymmy">Loading authors...</span></div></div>'),Ye=_('<h2 class="svelte-y7ymmy"> </h2> <div class="book-search svelte-y7ymmy"><input id="search" type="text" class="svelte-y7ymmy"> <!></div> <div class="search-results svelte-y7ymmy"></div>',1),De=_('<div class="book svelte-y7ymmy"><img class="svelte-y7ymmy"> <div class="info svelte-y7ymmy"><span class="title svelte-y7ymmy"> </span> <span class="authors svelte-y7ymmy"> </span></div> <button class="close svelte-y7ymmy"><!></button></div>'),Fe=_('<div class="books"></div>'),Ge=_('<span class="error svelte-y7ymmy"> </span>'),Je=_('<!> <h2 class="body-name svelte-y7ymmy">Rating</h2> <div class="stars svelte-y7ymmy"><input id="rating" class="svelte-y7ymmy"> <!></div>',1),Ke=_('<h2 class="body-name svelte-y7ymmy">Update Type</h2> <!> <!>',1),Qe=(q,L)=>c(L,!e(L)),We=_("<button><!></button>"),Xe=_('<div class="preview svelte-y7ymmy"><!></div>'),Ze=_('<div class="text-container svelte-y7ymmy"><textarea maxlength="144" id="body" class="svelte-y7ymmy"></textarea> <!></div>'),$e=_("<!> <!>",1),et=_('<div class="new-post-page svelte-y7ymmy"><!> <!> <!> <div class="body-header svelte-y7ymmy"><h2 class="body-name preview-body svelte-y7ymmy"></h2> <!></div> <!> <!> <button class="post-button svelte-y7ymmy">Post</button></div>');function bt(q,L){ge(L,!0);const W=(m,f)=>{let C=xe(()=>we(f==null?void 0:f(),"Add a book"));var b=Ye(),k=D(b),A=i(k,!0);s(k);var x=r(k,2),g=i(x);de(g),g.__keyup=[qe,_e];var N=r(g,2);{var H=p=>{var w=ze(),S=i(w,!0);s(w),F(()=>M(S,e(U))),n(p,w)};T(N,p=>{e(U)&&p(H)})}s(x);var V=r(x,2);me(V,21,()=>e(ie),Te,(p,w)=>{var S=ye(),I=D(S);ne(I,()=>e(w),P=>{var E=Ve();n(P,E)},(P,E)=>{var Y=Ue(),t=se(()=>fe(e(E)));Y.__click=function(...J){var K;(K=e(t))==null||K.apply(this,J)};var a=i(Y),o=r(a,2),y=i(o),u=i(y,!0);s(y);var d=r(y,2),v=i(d,!0);s(d),s(o),s(Y),F(J=>{Q(a,"alt",`${e(E).title??""} cover`),Q(a,"src",e(E).cover),M(u,e(E).title),M(v,J)},[()=>e(E).authors.join(",")]),n(P,Y)}),n(p,S)}),s(V),F(()=>{M(A,e(C)),le(g,"outline",e(U)?"2px solid var(--red)":"none")}),oe(g,()=>e($),p=>c($,p)),n(m,b)},X=m=>{var f=Fe();me(f,21,()=>e(j),C=>C.isbn,(C,b)=>{var k=De(),A=i(k),x=r(A,2),g=i(x),N=i(g,!0);s(g);var H=r(g,2),V=i(H,!0);s(H),s(x);var p=r(x,2),w=se(()=>he(e(b)));p.__click=function(...I){var P;(P=e(w))==null||P.apply(this,I)};var S=i(p);Ne(S,{stroke:"var(--red)",style:"width: 1.25rem; height: 1.25rem;"}),s(p),s(k),F(I=>{Q(A,"alt",`${e(b).title??""} cover`),Q(A,"src",e(b).cover),M(N,e(b).title),M(V,I)},[()=>e(b).authors.join(",")]),n(C,k)}),s(f),n(m,f)};let{type:l}=L.data,ce={general:"Post Body",rating:"Review (Optional)",update:"Comments (Optional)",reply:null}[l],O=B(""),z=B(null),Z=B("start"),j=B(G([])),ie=B(G([])),$=B("");async function _e(){c(ie,G(await Le(e($))))}let ee=B("");function pe(){l==="general"&&e(O).trim().length===0?c(ee,"Body cannot be empty"):c(ee,"")}function ue(){if(l==="rating"&&ve(),(l==="rating"||l==="update")&&te(),l==="general"&&pe(),e(R)||e(U)||e(ee))return;let m={type:l,body:e(O),books:e(j).map(f=>f.isbn)};e(z)!==null&&(m=Object.assign(m,{rating:Number(e(z))})),l==="update"&&(m=Object.assign(m,{updateType:e(Z)})),Oe(m),Ee("/profile")}function fe(m){return function(){e(j).push(m),te()}}function he(m){return function(){c(j,G(e(j).filter(f=>f.isbn!==m.isbn))),te()}}let R=B(""),U=B("");function ve(){if(l==="rating"){if(e(z)===null){c(R,"Add a rating value.");return}if(!/^\d(\.\d)?$/.test(e(z))){c(R,"Value must be between 0 and 10, to at most one decimal place.");return}}c(R,"")}function te(){l==="rating"&&e(j).length===0?c(U,"Choose a book to rate."):c(U,"")}let ae=B(!1);Be(q,{children:(m,f)=>{var C=et(),b=i(C);He(b,{title:`New ${l??""} Post`});var k=r(b,2);{var A=t=>{var a=Je(),o=D(a);{var y=h=>{W(h,()=>"Choose a book")},u=h=>{X(h)};T(o,h=>{e(j).length===0?h(y):h(u,!1)})}var d=r(o,4),v=i(d);de(v),v.__input=ve;var J=r(v,2);{var K=h=>{var re=Ge(),be=i(re,!0);s(re),F(()=>M(be,e(R))),n(h,re)};T(J,h=>{e(R)&&h(K)})}s(d),F(()=>le(v,"outline",e(R)?"2px solid #f38ba8":"none")),oe(v,()=>e(z),h=>c(z,h)),n(t,a)};T(k,t=>{l==="rating"&&t(A)})}var x=r(k,2);{var g=t=>{var a=Ke(),o=r(D(a),2);Re(o,{options:["start","finish","abandon"],style:"margin-bottom: 1rem;",get value(){return e(Z)},set value(v){c(Z,G(v))}});var y=r(o,2);{var u=v=>{W(v,()=>"Choose a book")},d=v=>{X(v)};T(y,v=>{e(j).length===0?v(u):v(d,!1)})}n(t,a)};T(x,t=>{l==="update"&&t(g)})}var N=r(x,2),H=i(N);H.textContent=ce;var V=r(H,2);{var p=t=>{var a=We();a.__click=[Qe,ae];var o=i(a);const y=se(()=>e(ae)?"var(--lavender)":"var(--overlay-1)");Ae(o,{get stroke(){return e(y)},style:"width: 1rem; height: 1rem;"}),s(a),n(t,a)};T(V,t=>{e(O)&&t(p)})}s(N);var w=r(N,2);{var S=t=>{var a=ye(),o=D(a);ne(o,()=>Se(e(O)),null,(y,u)=>{var d=Xe(),v=i(d);je(v,()=>e(u),!1,!1),s(d),n(y,d)}),n(t,a)},I=t=>{var a=Ze(),o=i(a);Pe(o);var y=r(o,2);Ie(y,{limit:144,get text(){return e(O)},set text(u){c(O,G(u))}}),s(a),oe(o,()=>e(O),u=>c(O,u)),n(t,a)};T(w,t=>{e(ae)?t(S):t(I,!1)})}var P=r(w,2);{var E=t=>{var a=$e(),o=D(a);{var y=d=>{X(d)};T(o,d=>{e(j).length!==0&&d(y)})}var u=r(o,2);W(u,()=>"Add a book"),n(t,a)};T(P,t=>{l!=="rating"&&l!=="update"&&t(E)})}var Y=r(P,2);Y.__click=ue,s(C),n(m,C)},$$slots:{default:!0}}),ke()}Ce(["keyup","click","input"]);export{bt as component,ht as universal};
