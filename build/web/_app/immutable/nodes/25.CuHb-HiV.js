import"../chunks/Bg9kRutz.js";import{c as y,r as m,p as Ne,a7 as R,a as Be,y as e,w,f as c,s as p,t as fe,a8 as J}from"../chunks/BaZyK-JQ.js";import{i as k,s as _e}from"../chunks/DBYv9uc3.js";import{P as Ae,a as K}from"../chunks/D61NNt0m.js";import{e as ae,i as re}from"../chunks/CN4MRzID.js";import{a as s,t as a,c as b}from"../chunks/Dd2BwSaU.js";import{r as Me,s as ue,c as O}from"../chunks/D230ZY73.js";import{s as Q}from"../chunks/B3s4N60E.js";import{d as Re,e as Te}from"../chunks/BuFl6vNe.js";import{b as He}from"../chunks/2_PfXxFa.js";import{p as h}from"../chunks/COAggT6D.js";import{o as je}from"../chunks/cM7fshyi.js";import{g as me}from"../chunks/DM5Thq4q.js";import{z as ze,v as Ce,A as Ie}from"../chunks/CgDT1lHw.js";import"../chunks/69_IOA4Y.js";import{W as Ve}from"../chunks/CExDkfQy.js";import{A as qe,B as De}from"../chunks/TtIkNWu6.js";import{U as Fe}from"../chunks/BhQzf7mE.js";import{H as Ge}from"../chunks/DhFw9Gcx.js";var Je=a('<div class="svelte-162e39x"><!></div>');function he(C){var P=Je(),x=y(P);Ve(x,{stroke:"var(--surface-2)",style:"width: 2rem; height: 2rem;"}),m(P),s(C,P)}function Ke(C,P,x){C.key==="Enter"?P():(e(x)&&clearTimeout(e(x)),w(x,h(setTimeout(P,3e3))))}var Oe=a('<div class="loading svelte-ok325s"><h1 class="svelte-ok325s">Search for a post</h1> <p class="svelte-ok325s">Enter your search term to find relevant posts.</p></div>'),Qe=a('<div class="loading svelte-ok325s"><h1 class="svelte-ok325s">No posts found</h1> <p class="svelte-ok325s">No posts were found relating to your search term. Make sure you spelled everything right!</p></div>'),Xe=a("<!> <!>",1),Ye=a('<div class="loading svelte-ok325s"><h1 class="svelte-ok325s">Loading posts...</h1> <p class="svelte-ok325s">We promise Wallflower will be faster soon.</p> <!></div>'),Ze=a('<div class="loading svelte-ok325s"><h1 class="svelte-ok325s">Search for a book</h1> <p class="svelte-ok325s">Enter your search term to find relevant books.</p></div>'),$e=a('<div class="loading svelte-ok325s"><h1 class="svelte-ok325s">No books found</h1> <p class="svelte-ok325s">No books were found relating to your search term. Make sure you spelled everything right!</p></div>'),es=a('<div class="loading-cover svelte-ok325s"></div>'),ss=a('<a class="book svelte-ok325s"><div class="book-info svelte-ok325s"><h1 class="svelte-ok325s"> </h1> <h2 class="svelte-ok325s"> </h2></div> <!></a>'),os=a('<div class="book svelte-ok325s"><div class="book-info svelte-ok325s"><div class="loading-title svelte-ok325s"></div> <div class="loading-authors svelte-ok325s"></div></div> <div class="loading-cover svelte-ok325s"></div></div>'),as=a('<!> <div class="books svelte-ok325s"></div>',1),rs=a('<div class="loading svelte-ok325s"><h1 class="svelte-ok325s">Loading books...</h1> <p class="svelte-ok325s">We promise Wallflower will be faster soon.</p> <!></div>'),ts=a('<div class="loading svelte-ok325s"><h1 class="svelte-ok325s">Search for a user</h1> <p class="svelte-ok325s">Enter your search term to find relevant users.</p></div>'),vs=a('<div class="loading svelte-ok325s"><h1 class="svelte-ok325s">No users found</h1> <p class="svelte-ok325s">No users were found relating to your search term. Make sure you spelled everything right!</p></div>'),ls=a('<!> <div class="people"></div>',1),is=a('<div class="loading svelte-ok325s"><h1 class="svelte-ok325s">Loading accounts...</h1> <p class="svelte-ok325s">We promise Wallflower will be faster soon.</p></div>'),ns=a('<!> <section class="svelte-ok325s"><input type="text" enterkeyhint="search" class="svelte-ok325s"> <div class="views svelte-ok325s"><button>Posts</button> <button>Books</button> <button>Authors</button> <button>Users</button></div></section> <!>',1);function Us(C,P){Ne(P,!0);let x=R(null),n=R(h(new URLSearchParams(window.location.search).get("view")??"posts")),i=R("");async function D(){e(F)&&clearTimeout(e(F)),w(F,null),w(i,h(e(i).trim()));const S=new URLSearchParams({term:e(i),view:e(n)});me(`/search?${S}`),e(n)==="posts"?w(te,h(ze(e(i)))):e(n)==="books"?w(ve,h(Ce(e(i)))):e(n)==="people"&&w(le,h(Ie(e(i))))}je(()=>{e(i)&&D()});let F=R(null),te=R(h(Promise.resolve([]))),ve=R(h(Promise.resolve([]))),le=R(h(Promise.resolve([])));function G(S){return function(){const X=new URLSearchParams({view:S});e(i)&&X.set("term",e(i)),me(`/search?${X}`),w(n,h(S)),D()}}Ae(C,{type:"search",get sidebar(){return e(x)},set sidebar(S){w(x,h(S))},children:(S,X)=>{var ie=ns(),ne=c(ie);Ge(ne,{title:"Search"});var Y=p(ne,2),T=y(Y);Me(T),T.__keyup=[Ke,D,F];var de=p(T,2),Z=y(de),ke=J(()=>G("posts"));Z.__click=function(...r){var o;(o=e(ke))==null||o.apply(this,r)};var $=p(Z,2),ge=J(()=>G("books"));$.__click=function(...r){var o;(o=e(ge))==null||o.apply(this,r)};var ee=p($,2),be=J(()=>G("authors"));ee.__click=function(...r){var o;(o=e(be))==null||o.apply(this,r)};var ce=p(ee,2),ye=J(()=>G("people"));ce.__click=function(...r){var o;(o=e(ye))==null||o.apply(this,r)},m(de),m(Y);var we=p(Y,2);{var Pe=r=>{var o=b(),se=c(o);K(se,()=>e(te),I=>{var E=Ye(),_=p(y(E),4);he(_,{}),m(E),s(I,E)},(I,E)=>{var _=Xe(),L=c(_);{var V=t=>{var u=Oe();s(t,u)},B=t=>{var u=b(),A=c(u);{var W=g=>{var d=Qe();s(g,d)};k(A,g=>{e(E).length===0&&g(W)},!0)}s(t,u)};k(L,t=>{e(i)==""?t(V):t(B,!1)})}var f=p(L,2);ae(f,17,()=>e(E),re,(t,u)=>{qe(t,{get post(){return e(u)}})}),s(I,_)}),s(r,o)},xe=r=>{var o=b(),se=c(o);{var I=_=>{var L=b(),V=c(L);K(V,()=>e(ve),B=>{var f=rs(),t=p(y(f),4);he(t,{}),m(f),s(B,f)},(B,f)=>{var t=as(),u=c(t);{var A=d=>{var U=Ze();s(d,U)},W=d=>{var U=b(),H=c(U);{var j=v=>{var l=$e();s(v,l)};k(H,v=>{e(f).length===0&&v(j)},!0)}s(d,U)};k(u,d=>{e(i)==""?d(A):d(W,!1)})}var g=p(u,2);ae(g,21,()=>e(f),re,(d,U)=>{var H=b(),j=c(H);K(j,()=>e(U),v=>{var l=os();s(v,l)},(v,l)=>{var z=ss(),q=y(z),M=y(q),oe=y(M,!0);m(M);var pe=p(M,2),Se=y(pe,!0);m(pe),m(q);var Ee=p(q,2);{var Le=N=>{De(N,{get book(){return e(l)},style:"width: 3.5rem; margin-left: auto;"})},We=N=>{var Ue=es();s(N,Ue)};k(Ee,N=>{e(l).cover?N(Le):N(We,!1)})}m(z),fe(N=>{ue(z,"href",`/book/${e(l).isbn}`),_e(oe,e(l).title),_e(Se,N)},[()=>e(l).authors.join(", ")]),s(v,z)}),s(d,H)}),m(g),s(B,t)}),s(_,L)},E=_=>{var L=b(),V=c(L);{var B=f=>{var t=b(),u=c(t);K(u,()=>e(le),A=>{var W=is();s(A,W)},(A,W)=>{var g=ls(),d=c(g);{var U=v=>{var l=ts();s(v,l)},H=v=>{var l=b(),z=c(l);{var q=M=>{var oe=vs();s(M,oe)};k(z,M=>{e(W).length===0&&M(q)},!0)}s(v,l)};k(d,v=>{e(i)==""?v(U):v(H,!1)})}var j=p(d,2);ae(j,21,()=>e(W),re,(v,l)=>{Fe(v,{get user(){return e(l)}})}),m(j),s(A,g)}),s(f,t)};k(V,f=>{e(n)==="people"&&f(B)},!0)}s(_,L)};k(se,_=>{e(n)==="books"?_(I):_(E,!1)},!0)}s(r,o)};k(we,r=>{e(n)==="posts"?r(Pe):r(xe,!1)})}fe(()=>{ue(T,"placeholder",{books:"Enter a title or ISBN",posts:"Enter some keywords",authors:"Enter an author's name",people:"Enter a username"}[e(n)]),Q(Z,O(e(n)==="posts"?"selected":""),"svelte-ok325s"),Q($,O(e(n)==="books"?"selected":""),"svelte-ok325s"),Q(ee,O(e(n)==="authors"?"selected":""),"svelte-ok325s"),Q(ce,O(e(n)==="people"?"selected":""),"svelte-ok325s")}),Te("blur",T,D),He(T,()=>e(i),r=>w(i,r)),s(S,ie)},$$slots:{default:!0}}),Be()}Re(["keyup","click"]);export{Us as component};
