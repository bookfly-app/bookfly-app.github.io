import"../chunks/Bzak7iHL.js";import{p as xe,a9 as j,aa as le,g as we,a6 as u,e as o,d as s,t as M,a as l,j as e,ac as c,r,f as J,ab as se,c as ne,av as Be,k as je,aC as Te}from"../chunks/DhKu0NfF.js";import{s as A}from"../chunks/DGkc4AeD.js";import{P as Ce,a as me}from"../chunks/gV0rRayJ.js";import{i as T}from"../chunks/DZzuPxtn.js";import{e as ye,i as Pe}from"../chunks/B8n4LtgD.js";import{h as Ee}from"../chunks/D1T9_Aj1.js";import{r as de,b as ce,s as W}from"../chunks/COSmXfxt.js";import{d as Oe}from"../chunks/DGKU-49f.js";import{b as oe}from"../chunks/CmLPpUp4.js";import{g as Se}from"../chunks/T3L1wa_c.js";import{r as Le,t as Re,v as Ae}from"../chunks/D8MsmRYf.js";import{S as Ne}from"../chunks/CrAwrVAV.js";import{E as He,T as Ie}from"../chunks/DfWq5u-V.js";import{H as Me}from"../chunks/Dcj6gjm5.js";import{C as qe}from"../chunks/CL0HSnGG.js";const ze=({params:q})=>q,bt=Object.freeze(Object.defineProperty({__proto__:null,load:ze},Symbol.toStringTag,{value:"Module"}));function Ue(q,N){q.key==="Enter"&&N()}var Ve=u('<span class="error svelte-y7ymmy"> </span>'),De=u('<div class="book search-book svelte-y7ymmy"><img class="svelte-y7ymmy"/> <div class="info svelte-y7ymmy"><span class="title svelte-y7ymmy"> </span> <span class="authors svelte-y7ymmy"> </span></div></div>'),Fe=u('<div class="book search-book svelte-y7ymmy"><img alt="Book cover" src="" class="svelte-y7ymmy"/> <div class="info svelte-y7ymmy"><span class="title svelte-y7ymmy">Loading Title...</span> <span class="authors svelte-y7ymmy">Loading authors...</span></div></div>'),Ge=u('<h2 class="svelte-y7ymmy"> </h2> <div class="book-search svelte-y7ymmy"><input id="search" type="text" class="svelte-y7ymmy"/> <!></div> <div class="search-results svelte-y7ymmy"></div>',1),Je=u('<div class="book svelte-y7ymmy"><img class="svelte-y7ymmy"/> <div class="info svelte-y7ymmy"><span class="title svelte-y7ymmy"> </span> <span class="authors svelte-y7ymmy"> </span></div> <button class="close svelte-y7ymmy"><!></button></div>'),Ke=u('<div class="books"></div>'),Qe=u('<span class="error svelte-y7ymmy"> </span>'),We=u('<!> <h2 class="body-name svelte-y7ymmy">Rating</h2> <div class="stars svelte-y7ymmy"><input id="rating" class="svelte-y7ymmy"/> <!></div>',1),Xe=u('<h2 class="body-name svelte-y7ymmy">Update Type</h2> <!> <!>',1),Ye=(q,N)=>c(N,!e(N)),Ze=u("<button><!></button>"),$e=u('<div class="preview svelte-y7ymmy"><!></div>'),et=u('<div class="text-container svelte-y7ymmy"><textarea maxlength="144" id="body" class="svelte-y7ymmy"></textarea> <!></div>'),tt=u("<!> <!>",1),at=u('<div class="new-post-page svelte-y7ymmy"><!> <!> <!> <div class="body-header svelte-y7ymmy"><h2 class="body-name preview-body svelte-y7ymmy"> </h2> <!></div> <!> <!> <button class="post-button svelte-y7ymmy">Post</button></div>');function gt(q,N){xe(N,!0);const X=(m,h)=>{let P=je(()=>Te(h==null?void 0:h(),"Add a book"));var b=Ge(),k=J(b),I=o(k,!0);r(k);var x=s(k,2),g=o(x);de(g),g.__keyup=[Ue,ue];let S;var L=s(g,2);{var K=p=>{var w=Ve(),B=o(w,!0);r(w),M(()=>A(B,e(U))),l(p,w)};T(L,p=>{e(U)&&p(K)})}r(x);var R=s(x,2);ye(R,21,()=>e(ie),Pe,(p,w)=>{var B=ne(),V=J(B);me(V,()=>e(w),D=>{var E=Fe();l(D,E)},(D,E)=>{var F=De(),t=se(()=>he(e(E)));F.__click=function(...G){var Q;(Q=e(t))==null||Q.apply(this,G)};var a=o(F),i=s(a,2),y=o(i),f=o(y,!0);r(y);var d=s(y,2),v=o(d,!0);r(d),r(i),r(F),M(G=>{W(a,"alt",`${e(E).title??""} cover`),W(a,"src",e(E).cover),A(f,e(E).title),A(v,G)},[()=>e(E).authors.join(",")]),l(D,F)}),l(p,B)}),r(R),M(p=>{A(I,e(P)),S=ce(g,"",S,p)},[()=>({outline:e(U)?"2px solid var(--red)":"none"})]),oe(g,()=>e($),p=>c($,p)),l(m,b)},Y=m=>{var h=Ke();ye(h,21,()=>e(C),P=>P.isbn,(P,b)=>{var k=Je(),I=o(k),x=s(I,2),g=o(x),S=o(g,!0);r(g);var L=s(g,2),K=o(L,!0);r(L),r(x);var R=s(x,2),p=se(()=>be(e(b)));R.__click=function(...B){var V;(V=e(p))==null||V.apply(this,B)};var w=o(R);Ie(w,{stroke:"var(--red)",style:"width: 1.25rem; height: 1.25rem;"}),r(R),r(k),M(B=>{W(I,"alt",`${e(b).title??""} cover`),W(I,"src",e(b).cover),A(S,e(b).title),A(K,B)},[()=>e(b).authors.join(",")]),l(P,k)}),r(h),l(m,h)};let{type:n}=N.data,_e={general:"Post Body",rating:"Review (Optional)",update:"Comments (Optional)",reply:null}[n],O=j(""),z=j(null),Z=j("start"),C=j(le([])),ie=j(le([])),$=j("");async function ue(){c(ie,await Ae(e($)),!0)}let ee=j("");function pe(){n==="general"&&e(O).trim().length===0?c(ee,"Body cannot be empty"):c(ee,"")}function fe(){if(n==="rating"&&ve(),(n==="rating"||n==="update")&&te(),n==="general"&&pe(),e(H)||e(U)||e(ee))return;let m={type:n,body:e(O),books:e(C).map(h=>h.isbn)};e(z)!==null&&(m=Object.assign(m,{rating:Number(e(z))})),n==="update"&&(m=Object.assign(m,{updateType:e(Z)})),Le(m),Se("/profile")}function he(m){return function(){e(C).push(m),te()}}function be(m){return function(){c(C,e(C).filter(h=>h.isbn!==m.isbn),!0),te()}}let H=j(""),U=j("");function ve(){if(n==="rating"){if(e(z)===null){c(H,"Add a rating value.");return}if(!/^\d(\.\d)?$/.test(e(z))){c(H,"Value must be between 0 and 10, to at most one decimal place.");return}}c(H,"")}function te(){n==="rating"&&e(C).length===0?c(U,"Choose a book to rate."):c(U,"")}let ae=j(!1);Ce(q,{children:(m,h)=>{var P=at(),b=o(P);Me(b,{get title(){return`New ${n??""} Post`}});var k=s(b,2);{var I=t=>{var a=We(),i=J(a);{var y=_=>{X(_,()=>"Choose a book")},f=_=>{Y(_)};T(i,_=>{e(C).length===0?_(y):_(f,!1)})}var d=s(i,4),v=o(d);de(v),v.__input=ve;let G;var Q=s(v,2);{var ge=_=>{var re=Qe(),ke=o(re,!0);r(re),M(()=>A(ke,e(H))),l(_,re)};T(Q,_=>{e(H)&&_(ge)})}r(d),M(_=>G=ce(v,"",G,_),[()=>({outline:e(H)?"2px solid #f38ba8":"none"})]),oe(v,()=>e(z),_=>c(z,_)),l(t,a)};T(k,t=>{n==="rating"&&t(I)})}var x=s(k,2);{var g=t=>{var a=Xe(),i=s(J(a),2);Ne(i,{options:["start","finish","abandon"],style:"margin-bottom: 1rem;",get value(){return e(Z)},set value(v){c(Z,v,!0)}});var y=s(i,2);{var f=v=>{X(v,()=>"Choose a book")},d=v=>{Y(v)};T(y,v=>{e(C).length===0?v(f):v(d,!1)})}l(t,a)};T(x,t=>{n==="update"&&t(g)})}var S=s(x,2),L=o(S),K=o(L,!0);r(L);var R=s(L,2);{var p=t=>{var a=Ze();a.__click=[Ye,ae];var i=o(a);{let y=se(()=>e(ae)?"var(--lavender)":"var(--overlay-1)");He(i,{get stroke(){return e(y)},style:"width: 1rem; height: 1rem;"})}r(a),l(t,a)};T(R,t=>{e(O)&&t(p)})}r(S);var w=s(S,2);{var B=t=>{var a=ne(),i=J(a);me(i,()=>Re(e(O)),null,(y,f)=>{var d=$e(),v=o(d);Ee(v,()=>e(f)),r(d),l(y,d)}),l(t,a)},V=t=>{var a=et(),i=o(a);Be(i);var y=s(i,2);qe(y,{limit:144,get text(){return e(O)},set text(f){c(O,f,!0)}}),r(a),oe(i,()=>e(O),f=>c(O,f)),l(t,a)};T(w,t=>{e(ae)?t(B):t(V,!1)})}var D=s(w,2);{var E=t=>{var a=tt(),i=J(a);{var y=d=>{Y(d)};T(i,d=>{e(C).length!==0&&d(y)})}var f=s(i,2);X(f,()=>"Add a book"),l(t,a)};T(D,t=>{n!=="rating"&&n!=="update"&&t(E)})}var F=s(D,2);F.__click=fe,r(P),M(()=>A(K,_e)),l(m,P)},$$slots:{default:!0}}),we()}Oe(["keyup","click","input"]);export{gt as component,bt as universal};
